<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rshawshank.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="纵浪大化中，不喜亦不惧">
<meta property="og:type" content="website">
<meta property="og:title" content="rhb_blog">
<meta property="og:url" content="http://rshawshank.github.io/page/4/index.html">
<meta property="og:site_name" content="rhb_blog">
<meta property="og:description" content="纵浪大化中，不喜亦不惧">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="rhb">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rshawshank.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>rhb_blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">rhb_blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">rao的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">59</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">24</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">144</span></a>

  </li>
        <li class="menu-item menu-item-photos">

    <a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>相册</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-readnote">

    <a href="/readnote" rel="section"><i class="fa fa-book fa-fw"></i>阅读笔记</a>

  </li>
        <li class="menu-item menu-item-somethink">

    <a href="/somethink/" rel="section"><i class="fa fa-sticky-note fa-fw"></i>随笔闲谈</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/RShawshank" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/11/16/java-maven%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/16/java-maven%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">java-maven学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-16 14:10:53 / 修改时间：06:49:04" itemprop="dateCreated datePublished" datetime="2021-11-16T14:10:53Z">2021-11-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><ul>
<li>构建工具：自动化构建，抽象构建过程</li>
<li>可跨平台——对外提供了一致的操作接口</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/11/16/java-maven%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/16/java-maven%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">java-maven学习（一）——介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-16 14:10:53" itemprop="dateCreated datePublished" datetime="2021-11-16T14:10:53Z">2021-11-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-15 07:15:52" itemprop="dateModified" datetime="2022-11-15T07:15:52Z">2022-11-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><ul>
<li><p>构建工具：自动化构建，抽象构建过程</p>
<ul>
<li>可跨平台——对外提供了一致的操作接口</li>
</ul>
</li>
<li><p>依赖管理工具和项目管理工具</p>
<ul>
<li>提供中央仓库，自动下载构件</li>
</ul>
</li>
</ul>
<p>最新最全的maven依赖项版本查询网站：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://mvnrepository.com/">http://mvnrepository.com</a></p>
</blockquote>
<h2 id="一、为什么使用Maven这样的构建工具【why】"><a href="#一、为什么使用Maven这样的构建工具【why】" class="headerlink" title="一、为什么使用Maven这样的构建工具【why】"></a>一、为什么使用Maven这样的构建工具【why】</h2><ol>
<li>一个项目就是一个工程</li>
</ol>
<p>如果项目非常庞大，就不适合使用package来划分模块，最好是每一个模块对应一个工程，利于分工协作。借助于maven就可以将一个项目拆分成多个工程</p>
<ol start="2">
<li>项目中使用jar包，需要“复制”、“粘贴”项目的lib中</li>
</ol>
<p>同样的jar包重复的出现在不同的项目工程中，你需要做不停的复制粘贴的重复工作。借助于maven，可以将jar包保存在“仓库”中，不管在哪个项目只要使用引用即可就行。</p>
<ol start="3">
<li>jar包需要的时候每次都要自己准备好或到官网下载</li>
</ol>
<p>借助于maven我们可以使用统一的规范方式下载jar包，规范</p>
<ol start="4">
<li>jar包版本不一致的风险</li>
</ol>
<p>不同的项目在使用jar包的时候，有可能会导致各个项目的jar包版本不一致，导致未执行错误。借助于maven，所有的jar包都放在“仓库”中，所有的项目都使用仓库的一份jar包。</p>
<ol start="5">
<li>一个jar包依赖其他的jar包需要自己手动的加入到项目中</li>
</ol>
<p>FileUpload组件-&gt;IO组件，commons-fileupload-1.3.jar依赖于commons-io-2.0.1.jar</p>
<p>极大的浪费了我们导入包的时间成本，也极大的增加了学习成本。借助于maven，它会自动的将依赖的jar包导入进来。</p>
<h2 id="二、maven是什么【what】"><a href="#二、maven是什么【what】" class="headerlink" title="二、maven是什么【what】"></a>二、maven是什么【what】</h2><p>① maven是一款服务于java平台的自动化构建工具</p>
<p>make-&gt;Ant-&gt;Maven-&gt;Gradle</p>
<p>② 构建</p>
<p>构建定义：把动态的Web工程经过编译得到的编译结果部署到服务器上的整个过程。</p>
<p>编译：java源文件[.java]-&gt;编译-&gt;Classz字节码文件[.class]</p>
<p>部署：最终在sevlet容器中部署的不是动态web工程，而是编译后的文件</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401053.jpeg"></p>
<p>③ 构建的各个环节</p>
<ul>
<li>清理clean：将以前编译得到的旧文件class字节码文件删除</li>
<li>编译compile：将java源程序编译成class字节码文件</li>
<li>测试test：自动测试，自动调用junit程序</li>
<li>报告report：测试程序执行的结果</li>
<li>打包package：动态Web工程打War包，java工程打jar包</li>
<li>安装install：Maven特定的概念—–将打包得到的文件复制到“仓库”中的指定位置</li>
<li>部署deploy：将动态Web工程生成的war包复制到Servlet容器下，使其可以运行</li>
</ul>
<h2 id="三、安装maven"><a href="#三、安装maven" class="headerlink" title="三、安装maven"></a>三、安装maven</h2><p>① 当前系统是否配置JAVA_HOME的环境变量</p>
<p>② 下载maven，解压maven放在一个非中文无空格的路径下</p>
<p>③ 配置maven的相关环境变量</p>
<ul>
<li>在环境变量增加M2_HOME，路径是maven解压后的根目录</li>
<li>在环境变量里的path中增加maven&#x2F;bin的目录</li>
</ul>
<p>④ 验证：maven -v 查看maven版本</p>
<p>看到版本信息，恭喜你已经OK了。</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401651.png"></p>
<h3 id="maven目录"><a href="#maven目录" class="headerlink" title="maven目录"></a>maven目录</h3><ul>
<li><strong>bin目录</strong>：</li>
</ul>
<p>该目录包含了mvn运行的脚本，这些脚本用来配置java命令，准备好classpath和相关的Java系统属性，然后执行Java命令。</p>
<ul>
<li><strong>boot目录</strong>:</li>
</ul>
<p>该目录只包含一个文件，该文件为<code>plexus-classworlds-2.5.2.jar</code>。<code>plexus-classworlds</code>是一个类加载器框架，相对于默认的java类加载器，它提供了更加丰富的语法以方便配置，Maven使用该框架加载自己的类库。</p>
<ul>
<li><strong>conf目录</strong>:</li>
</ul>
<p>该目录包含了一个非常重要的文件settings.xml。直接修改该文件，就能在机器上全局地定制Maven的行为，一般情况下，我们更偏向于复制该文件至<del>&#x2F;.m2&#x2F;目录下（</del>表示用户目录），然后修改该文件，在用户范围定制Maven的行为。</p>
<ul>
<li><strong>lib目录</strong>:</li>
</ul>
<p>该目录包含了所有Maven运行时需要的Java类库，Maven本身是分模块开发的，因此用户能看到诸如maven-core-3.0.jar、maven-model-3.0.jar之类的文件，此外这里还包含一些Maven用到的第三方依赖如commons-cli-1.2.jar、commons-lang-2.6.jar等等。</p>
<h2 id="四、第一个maven"><a href="#四、第一个maven" class="headerlink" title="四、第一个maven"></a>四、第一个maven</h2><p>① 创建约定的目录结构（maven工程必须按照约定的目录结构创建）</p>
<blockquote>
<p>根目录：工程名<br>|—src：源码|—|—main:存放主程序|—|—|—java：java源码文件|—|—|—resource：存放框架的配置文件|—|—test：存放测试程序|—pop.xml：maven的核心配置文件</p>
</blockquote>
<p>我们按照上面的文件夹目录结构手动创建一下，不用任何IDE环境（手动的其实最有助于我们理解maven）</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401657.jpeg"></p>
<h3 id="文件内容如下"><a href="#文件内容如下" class="headerlink" title="文件内容如下"></a>文件内容如下</h3><p>在src&#x2F;main&#x2F;java&#x2F;com&#x2F;hzg&#x2F;maven目录下新建文件Hello.java，内容如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzg.maven;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String name)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span>+name+<span class="string">&quot;!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>POM文件内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.hzg.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="常用maven命令"><a href="#常用maven命令" class="headerlink" title="常用maven命令"></a>常用maven命令</h3><ul>
<li>mvn clean：表示运行清理操作（会默认把target文件夹中的数据清理）。</li>
<li>mvn compile：编译主程序，会将代码编译到target文件夹中。</li>
<li>mvn test-compile：编译测试程序</li>
<li>mvn test：执行测试</li>
<li>mvn package：打包</li>
<li>mvn install：安装</li>
</ul>
<p><strong>执行maven命令必须进入到pom.xml的目录中进行执行</strong></p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401897.png"></p>
<p>进入到项目的pom.xml目录之后，就可以执行啦。</p>
<p><strong>1、运行 mvn compile</strong></p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401896.jpeg"></p>
<p>OK，运行完毕，你在pom.xml配置的依赖的包已经导入到仓库了，问题来了，<strong>仓库默认的位置在哪？</strong></p>
<p><strong>仓库的默认位置：</strong>c:\Usrs[登录当前系统的用户名].m2\repository</p>
<p>刚才执行完compile之后，之前的文件夹发生了变化</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401705.png"></p>
<p>我们发现Hello项目里里多了一个target文件夹。文件夹的内容为：</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401005.png"></p>
<p>发现target里主要存放的就是编译后的字节码文件</p>
<p><strong>2、运行mvn test-compile</strong>，target文件夹下面除了classes之外多了test-classes文件夹</p>
<p><strong>3、运行mvn package</strong>，target文件夹下面又多了一个打好的jar包</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401922.png"></p>
<p>4、运行mvn clean，发现整个target文件夹都没了。又回到了编译之前我们手动创建的文件夹</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051401090.png"></p>
<h2 id="五、Maven插件安装，基于IDEA"><a href="#五、Maven插件安装，基于IDEA" class="headerlink" title="五、Maven插件安装，基于IDEA"></a>五、Maven插件安装，基于IDEA</h2><ol>
<li>引入下载好的maven。网上教程很多</li>
</ol>
<h3 id="Maven使用"><a href="#Maven使用" class="headerlink" title="Maven使用"></a>Maven使用</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.tengj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springBootDemo1<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>springBootDemo1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码的第一行是XML头，指定了该xml文档的版本和编码方式。 </p>
<ul>
<li><p>project是所有pom.xml的根元素，它还声明了一些POM相关的命名空间及xsd元素。 </p>
</li>
<li><p>根元素下的第一个子元素modelVersion指定了当前的POM模型的版本，对于Maven3来说，它只能是4.0.0 代码中最重要是包含了groupId,artifactId和version了。这三个元素定义了一个项目基本的坐标，在Maven的世界，任何的jar、pom或者jar都是以基于这些基本的坐标进行区分的。</p>
</li>
<li><p>groupId定义了项目属于哪个组，随意命名，比如谷歌公司的myapp项目，就取名为 com.google.myapp</p>
</li>
<li><p>artifactId定义了当前Maven项目在组中唯一的ID,比如定义hello-world。</p>
</li>
<li><p>version指定了项目当前的版本0.0.1-SNAPSHOT,SNAPSHOT意为快照，说明该项目还处于开发中，是不稳定的。</p>
</li>
<li><p>name元素生命了一个对于用户更为友好的项目名称，虽然这不是必须的，但还是推荐为每个POM声明name,以方便信息交流</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>实际项目<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>模块<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">version</span>&gt;</span>版本<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">type</span>&gt;</span>依赖类型<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">scope</span>&gt;</span>依赖范围<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">optional</span>&gt;</span>依赖是否可选<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">　　　　 &lt;!—主要用于排除传递性依赖--&gt;</span><br><span class="line">　　　　 <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">　　　　     <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">　　　　　　　    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>…<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">　　　　　　　　　 <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>…<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">　　　　　　　<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">　　　　 <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>dependencies 可以包含一个或者多个dependency元素，以声明一个或者多个项目依赖。</li>
<li>grounpId、artifactId和version 组成了依赖的基本坐标。</li>
<li>type 指定了依赖的类型，默认为 jar。</li>
<li>scope 指定了依赖的范围（详情见下面<strong>依赖范围</strong>部分）。</li>
<li>optional 标记了依赖是否是可选的（详情见下面<strong>依赖可选</strong>部分）。</li>
<li>exclusions 用来排除传递性依赖（详情见下面<strong>依赖排除</strong>部分）。</li>
</ul>
<h2 id="六、仓库"><a href="#六、仓库" class="headerlink" title="六、仓库"></a>六、仓库</h2><p><strong>仓库的分类：</strong></p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205051632351.webp"></p>
<h3 id="本地仓库"><a href="#本地仓库" class="headerlink" title="本地仓库"></a>本地仓库</h3><p>一般来说，在Maven项目目录下，没有诸如lib&#x2F;这样用来存放依赖文件的目录。当Maven在执行编译或测试时，如果需要使用依赖文件，它总是基于坐标使用本地仓库的依赖文件。</p>
<p>默认情况下，不管是Window还是macOS，或者是 Linux，每个用户都会在自己的用户目录下有一个路径名为 <code>.m2/repository/</code> 的仓库目录。</p>
<p>如果你想自定义本地仓库目录地址，可以编辑文件<code>~/.m2/settings.xml</code>，设置localRepository元素的值为你想要的仓库地址，例如:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:\java\repository\<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样，该用户的本地仓库地址就被设置成了<code> D:\java\repository\</code>。 需要注意的是，默认情况下，<code>~/.m2/settings.xml</code>文件不存在，用户需要从Maven安装目录复制<code>$M2_HOME/conf/settings.xml</code>文件再进行编辑。</p>
<h3 id="远程仓库-中央仓库"><a href="#远程仓库-中央仓库" class="headerlink" title="远程仓库-中央仓库"></a>远程仓库-中央仓库</h3><p>默认情况下，本地仓库是被注释掉的，也就是空的，那么就必须得给 Maven 配置一个可用的远程仓库，否则 Maven 在 build（构建）的时候就无法去下载依赖。</p>
<p><strong>中央仓库</strong>就是这样一个可用的远程仓库，里面包含了这个世界上绝大多数流行的开源 Java 类库，以及源码、作者信息、许可证信息等等。</p>
<h3 id="远程仓库-aliyun仓库"><a href="#远程仓库-aliyun仓库" class="headerlink" title="远程仓库-aliyun仓库"></a>远程仓库-aliyun仓库</h3><p>不过，默认的中央仓库访问速度比较慢，通常我们会选择使用阿里的 Maven 远程仓库。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>ali-maven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>always<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>fail<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ul>
<li>repositories 可以包含一个或者多个repository元素，以声明一个或者多个仓库。</li>
<li>id，仓库声明的唯一id，需要注意的是，Maven自带的中央仓库使用的id为central，如果其他仓库也使用了该id，就会覆盖中央仓库的配置。</li>
<li>url，指向了仓库的地址。</li>
<li>releases和snapshots，用来控制Maven对于发布版构件和快照版构件的下载权限。</li>
<li>enabled子元素为 true 时表示可以从仓库下载发布版构件和快照版构件。</li>
<li>updatePolicy 子元素用来配置Maven从远处仓库检查更新的频率。<ul>
<li>默认值是daily，表示每天检查一次；</li>
<li>可选值 never 表示从不检查；</li>
<li>可选值always表示每次构建时检查更新；</li>
<li>可选值interval表示每隔X分钟检查一次更新（X为任意整数）。</li>
</ul>
</li>
<li>checksumPolicy 子元素用来配置Maven检查校验的策略。在下载构件的时候，Maven会去校验，如果校验失败，<ul>
<li>当checksumPolicy的值为默认的warn时，Maven会在执行构建时输出警告信息；</li>
<li>值为fail 时，Maven遇到校验错误就让构建失败；</li>
<li>值为ignore时，Maven将完全忽略校验。</li>
</ul>
</li>
</ul>
<h3 id="远程仓库-私服"><a href="#远程仓库-私服" class="headerlink" title="远程仓库-私服"></a>远程仓库-私服</h3><p>私服是一种特殊的远程仓库，它是架设在局域网内的仓库服务，私服代理广域网上的远程仓库，供局域网内的Maven用户使用。当Maven需要下载构件的时候，它从私服请求，如果私服上不存在该构件，则从外部的远程仓库下载，缓存在私服上之后，再为Maven的下载请求提供服务。因此，一些无法从外部仓库下载到的构件也能从本地上传到私服上供大家使用。 私服的好处：</p>
<ul>
<li>节省自己的外网速度</li>
<li>加速Maven构建</li>
<li>部署第三方构建</li>
<li>提高稳定性，增强控制</li>
<li>降低中央仓库的负荷</li>
</ul>
<h3 id="远程仓库的配置"><a href="#远程仓库的配置" class="headerlink" title="远程仓库的配置"></a>远程仓库的配置</h3><p>在平时的开发中，我们往往不会使用默认的中央仓库，默认的中央仓库访问的速度比较慢，访问的人或许很多，有时候也无法满足我们项目的需求，可能项目需要的某些构件中央仓库中是没有的，而在其他远程仓库中有，如JBoss Maven仓库。这时，可以在pom.xml中配置该仓库，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置远程仓库 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>jboss<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>JBoss Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repository.jboss.com/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>daily<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>**repository:**在repositories元素下，可以使用repository子元素声明一个或者多个远程仓库。</li>
<li><strong>id：</strong>仓库声明的唯一id，尤其需要注意的是，Maven自带的中央仓库使用的id为central，如果其他仓库声明也使用该id，就会覆盖中央仓库的配置。</li>
<li><strong>name：</strong>仓库的名称，让我们直观方便的知道仓库是哪个，暂时没发现其他太大的含义。</li>
<li><strong>url：</strong>指向了仓库的地址，一般来说，该地址都基于http协议，Maven用户都可以在浏览器中打开仓库地址浏览构件。</li>
<li>**releases和snapshots：**用来控制Maven对于发布版构件和快照版构件的下载权限。需要注意的是**enabled**子元素，该例中releases的enabled值为true，表示开启JBoss仓库的发布版本下载支持，而snapshots的enabled值为false，表示关闭JBoss仓库的快照版本的下载支持。根据该配置，Maven只会从JBoss仓库下载发布版的构件，而不会下载快照版的构件。</li>
<li><strong>layout：</strong>元素值default表示仓库的布局是Maven2及Maven3的默认布局，而不是Maven1的布局。基本不会用到Maven1的布局。</li>
<li><strong>其他：</strong>对于releases和snapshots来说，除了enabled，它们还包含另外两个子元素updatePolicy和checksumPolicy。</li>
</ul>
<p>1：元素<strong>updatePolicy</strong>用来配置Maven从远处仓库检查更新的频率，默认值是daily，表示Maven每天检查一次。其他可用的值包括：never-从不检查更新；always-每次构建都检查更新；interval：X-每隔X分钟检查一次更新（X为任意整数）。<br> 2：元素<strong>checksumPolicy</strong>用来配置Maven检查校验和文件的策略。当构建被部署到Maven仓库中时，会同时部署对应的检验和文件。在下载构件的时候，Maven会验证校验和文件，如果校验和验证失败，当checksumPolicy的值为默认的warn时，Maven会在执行构建时输出警告信息，其他可用的值包括：fail-Maven遇到校验和错误就让构建失败；ignore-使Maven完全忽略校验和错误。</p>
<h3 id="远程仓库的认证"><a href="#远程仓库的认证" class="headerlink" title="远程仓库的认证"></a>远程仓库的认证</h3><p>大部分的远程仓库不需要认证，但是如果是自己内部使用，为了安全起见，还是要配置认证信息的。 配置认证信息和配置远程仓库不同，远程仓库可以直接在pom.xml中配置，但是认证信息必须配置在settings.xml文件中。这是因为pom往往是被提交到代码仓库中供所有成员访问的，而settings.xml一般只存在于本机。因此，在settings.xml中配置认证信息更为安全。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">     <span class="comment">&lt;!--配置远程仓库认证信息--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">servers</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">id</span>&gt;</span>releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">servers</span>&gt;</span></span><br><span class="line">     ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里除了配置账号密码之外，值关键的就是id了，这个id要跟你在pom.xml里面配置的远程仓库repository的id一致，正是这个id将认证信息与仓库配置联系在了一起。</p>
<h3 id="部署构件至远程仓库"><a href="#部署构件至远程仓库" class="headerlink" title="部署构件至远程仓库"></a>部署构件至远程仓库</h3><p>我们自己搭建远程仓库的目的就是为了可以<strong>方便部署我们自己项目的构件以及一些无法从外部仓库直接获取的构件</strong>,供其他团队成员使用。 Maven除了能对项目进行编译、测试、打包之外，还能将项目生成的构件部署到远程仓库中。首先，需要编辑项目的pom.xml文件。配置distributionManagement元素，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>public<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://59.50.95.66:8081/nexus/content/repositories/releases<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://59.50.95.66:8081/nexus/content/repositories/snapshots<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>repository表示表示发布版本（稳定版本）构件的仓库</li>
<li>snapshotRepository表示快照版本（开发测试版本）的仓库。</li>
<li>这两个元素都需要配置id、name和url.<ul>
<li>id为远程仓库的唯一标识</li>
<li>name是为了方便人阅读</li>
<li>url表示该仓库的地址。</li>
</ul>
</li>
</ul>
<p>配置好了就运行命令<code>mvn clean deploy</code>，Maven就会将项目构建输出的构件部署到配置对应的远程仓库，如果项目当前的版本是快照版本，则部署到快照版本的仓库地址，否则就部署到发布版本的仓库地址。 当前项目是快照还是发布版本是通过 true 这个来区分的。</p>
<h3 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h3><p>如果仓库X可以提供仓库Y存储的所有内容，那么就可以认为X是Y的一个镜像。用过Maven的都知道，国外的中央仓库用起来太慢了，所以选择一个国内的镜像就很有必要，我推荐国内的阿里云镜像。 阿里云镜像：配置很简单，修改conf文件夹下的settings.xml文件，添加如下镜像配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上例子中，的值为central,表示该配置为中央库的镜像，任何对于中央仓库的请求都会转至该镜像，用户也可以用同样的方法配置其他仓库的镜像</p>
<p>这里介绍下<code>&lt;mirrorOf&gt;</code>配置的各种选项</p>
<ul>
<li><code>&lt;mirrorOf&gt;*&lt;mirrorOf&gt;</code>:匹配所有远程仓库。</li>
<li><code>&lt;mirrorOf&gt;external:*&lt;mirrorOf&gt;</code>:匹配所有远程仓库，使用localhost的除外，使用file:&#x2F;&#x2F;协议的除外。也就是说，匹配所有不在本机上的远程仓库。</li>
<li><code>&lt;mirrorOf&gt;repo1,repo2&lt;mirrorOf&gt;</code>:匹配仓库repo1h和repo2，使用逗号分隔多个远程仓库。</li>
<li><code>&lt;mirrorOf&gt;*,!repo1&lt;mirrorOf&gt;</code>:匹配所有远程仓库，repo1除外，使用感叹号将仓库从匹配中排除。</li>
</ul>
<p>需要注意的是，由于镜像仓库完全屏蔽了被镜像仓库，当镜像仓库不稳定或者停止服务的时候，Maven仍将无法访问被镜像仓库，因而将无法下载构件。</p>
<h3 id="maven-坐标"><a href="#maven-坐标" class="headerlink" title="maven 坐标"></a>maven 坐标</h3><p><strong>在 maven 中，根据 <code>groupId</code>、<code>artifactId</code>、<code>version</code> 组合成 <code>groupId:artifactId:version</code> 来唯一识别一个 jar 包。</strong></p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205060953017.png"></p>
<ul>
<li><p><strong>groupId</strong> - 团体、组织的标识符。团体标识的约定是，它以创建这个项目的组织名称的逆向域名(reverse domain name)开头。一般对应着 java 的包结构。</p>
</li>
<li><p><strong>artifactId</strong> - 单独项目的唯一标识符。比如我们的 tomcat、commons 等。不要在 artifactId 中包含点号(.)。</p>
</li>
<li><p>version</p>
<p>- 一个项目的特定版本。</p>
<ul>
<li><p>maven 有自己的版本规范，一般是如下定义 major version、minor version、incremental version-qualifier ，比如 1.2.3-beta-01。要说明的是，maven 自己判断版本的算法是 major、minor、incremental 部分用数字比较，qualifier 部分用字符串比较，所以要小心 alpha-2 和 alpha-15 的比较关系，最好用 alpha-02 的格式。</p>
</li>
<li><p>maven 在版本管理时候可以使用几个特殊的字符串 SNAPSHOT、LATEST、RELEASE。比如 </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">1</span>.<span class="number">0</span>-SNAPSHOT</span><br></pre></td></tr></table></figure>

<p>。各个部分的含义和处理逻辑如下说明：</p>
<ul>
<li><strong>SNAPSHOT</strong> - 这个版本一般用于开发过程中，表示不稳定的版本。</li>
<li><strong>LATEST</strong> - 指某个特定构件的最新发布，这个发布可能是一个发布版，也可能是一个 snapshot 版，具体看哪个时间最后。</li>
<li><strong>RELEASE</strong> ：指最后一个发布版。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>packaging</strong> - 项目的类型，描述了项目打包后的输出，默认是 jar。常见的输出类型为：pom, jar, maven-plugin, ejb, war, ear, rar, par。</p>
</li>
</ul>
<p>maven工程的坐标与仓库中路径的关系：</p>
<p><img src="https://picture11111111.oss-cn-hangzhou.aliyuncs.com/img/202205060953011.jpeg"></p>
<p>maven坐标和仓库对应的映射关系：[groupId][artifactId][version][artifactId]-[version].jar</p>
<p>去本地仓库看一下此目录：org\springframework\spring-core\4.3.4.RELEASE\spring-core-4.3.4.RELEASE.jar</p>
<p>在Maven世界中，任何一个依赖、插件或者项目构建的输出，都可以称为构件。得益于坐标机制，任何Maven项目使用任何一个构件的方式都是完全相同的。在此基础上，Maven可以在某个位置统一存储所有Maven项目共享的构件，这个统一的位置就是仓库。</p>
<p>实际的Maven项目将不再各自存储其依赖文件，它们只需要声明这些依赖的坐标，在需要的时候（例如，编译项目的时候需要将依赖加入到classpath中），Maven会自动根据坐标找到仓库中的构件，并使用它们。</p>
<p>为了实现重用，项目构建完毕后可生成的构件也可以安装或者部署到仓库中，供其他项目使用。</p>
<h2 id="七、配置文件说明"><a href="#七、配置文件说明" class="headerlink" title="七、配置文件说明"></a>七、配置文件说明</h2><p>参看链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq877507054/article/details/79138294">https://blog.csdn.net/qq877507054/article/details/79138294</a></p>
<h3 id="1、pom-xml文件"><a href="#1、pom-xml文件" class="headerlink" title="1、pom.xml文件"></a>1、pom.xml文件</h3><h3 id="2、settings-xml文件"><a href="#2、settings-xml文件" class="headerlink" title="2、settings.xml文件"></a>2、settings.xml文件</h3><ul>
<li>用来设置Maven参数的配置文件。</li>
<li>是Maven的全局配置文件。</li>
<li>包含类似本地仓库、远程仓库和联网使用的代理信息等配置。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">localRepository</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interactiveMode</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">offline</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginGroups</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servers</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrors</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">proxies</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profiles</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activeProfiles</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在Maven安装目录的conf子目录下面的settings.xml才是真正的全局的配置。</p>
<p>用户目录的.m2子目录下面的settings.xml的配置只是针对当前用户的。</p>
<p>当这两个文件同时存在的时候，那么对于相同的配置信息用户目录下面的settings.xml中定义的会覆盖Maven安装目录下面的settings.xml中的定义。用户目录下的settings.xml文件一般是不存在的，但是Maven允许我们在这里定义我们自己的settings.xml，如果需要在这里定义我们自己的settings.xml的时候就可以把Maven安装目录下面的settings.xml文件拷贝到用户目录的.m2目录下，然后改成自己想要的样子。</p>
<p>通过配置文件中的注释，我们可以看到，有两种配置此文件的方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.用户级别</span><br><span class="line">$&#123;user.home&#125;/.m2/settings.xml</span><br><span class="line">可以通过指令 -s /path/to/user/settings.xml</span><br><span class="line"></span><br><span class="line">2.全局级别</span><br><span class="line">$&#123;maven.home&#125;/conf/settings.xml.</span><br><span class="line">可以通过指令 -gs /path/to/global/settings.xml</span><br></pre></td></tr></table></figure>

<p>一般情况下，只需要如下两个就够了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>E:\config\maven\repository-spring<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是在实际开发中，一般都配有自己的私服，所以会加上私服的用户名称及密码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">offline</span>&gt;</span>true<span class="tag">&lt;/<span class="name">offline</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">password</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">password</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">server</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h4 id="2-1-localRepository"><a href="#2-1-localRepository" class="headerlink" title="2.1 localRepository"></a>2.1 localRepository</h4><p>localRepository用于构建系统的本地仓库的路径。<br>默认的值是${user.home}&#x2F;.m2&#x2F;repository。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Default: $&#123;user.home&#125;/.m2/repository</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/path/to/local/repo<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-interactiveMode"><a href="#2-2-interactiveMode" class="headerlink" title="2.2 interactiveMode"></a>2.2 interactiveMode</h4><p>interactiveMode 用于决定<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=maven&spm=1001.2101.3001.7020">maven</a>是否在需要输出的时候提示你，默认true。如果是false，它将使用合理的默认值，或者基于一些设置。</p>
<h4 id="2-3-offline"><a href="#2-3-offline" class="headerlink" title="2.3 offline"></a>2.3 offline</h4><p>决定maven是否在构建的时候进行网络传输。<br>默认false，表示联网状态，true为取消联网。<br>在某些情况下设置为true是很有用的，比如jar无法从网上下载等</p>
<h4 id="2-4-pluginGroups"><a href="#2-4-pluginGroups" class="headerlink" title="2.4 pluginGroups"></a>2.4 pluginGroups</h4><p>pluginGroups 插件组</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pluginGroups</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginGroup</span>&gt;</span>org.mortbay.jetty<span class="tag">&lt;/<span class="name">pluginGroup</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">pluginGroups</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>这样Maven可以使用简单的命令执行org.morbay.jetty:jetty-maven-plugin:run</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn jetty run</span><br></pre></td></tr></table></figure>

<h4 id="2-5-proxies"><a href="#2-5-proxies" class="headerlink" title="2.5 proxies"></a>2.5 proxies</h4><p>此项用于设置http代理<br>有时候由于安全问题，需要配置http代理，通过代理服务才能正常访问外部仓库下载资源可以ping repo1.maven.org来访问中央仓库<br>telnet 218.14.227.197 3128 来查看代理地址以及端口是否畅通</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">proxies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">proxy</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>optional<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">active</span>&gt;</span>true<span class="tag">&lt;/<span class="name">active</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">protocol</span>&gt;</span>http<span class="tag">&lt;/<span class="name">protocol</span>&gt;</span><span class="comment">&lt;!--代理协议--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">username</span>&gt;</span>proxyuser<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">password</span>&gt;</span>proxypass<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">host</span>&gt;</span>proxy.host.net<span class="tag">&lt;/<span class="name">host</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">port</span>&gt;</span>80<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">nonProxyHosts</span>&gt;</span>local.net|some.host.com<span class="tag">&lt;/<span class="name">nonProxyHosts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">proxy</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">proxies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>id：proxy的唯一标识，用来区别proxy元素。</li>
<li>active：表示是否激活代理，如果配置多个，默认是第一个生效</li>
<li>username，password：提供连接代理服务器时的认证。</li>
<li>host，port：主机地址，端口号</li>
<li>nonProxyHosts：用来表示哪些主机名不需要代理，可以用|来分割多个，此外也支持通配符，如：*.goole.com表示所有以goole.com结尾的都不需要通过代理</li>
</ul>
<h6 id="设置http代理"><a href="#设置http代理" class="headerlink" title="设置http代理"></a>设置http代理</h6><p>编辑setting.xml文件 有时候你所在的公司基于安全因素考虑，要求你使用通过安全认证的代理访问因特网。这种情况下，就需要为Maven配置HTTP代理，才能让它正常访问外部仓库，以下载所需要的资源。首先确认自己无法直接访问公共的maven中央仓库，直接运行命令ping repo1.maven.org可以检查网络。如果真的需要代理，先检查一下代理服务器是否畅通。比如现在有一个IP地址为218.14.227.197，端口为3128的代理服务，我们可以运行telnet 218.14.227.197 3128来检测该地址的该端口是否畅通。如果得到出错信息，需要先获取正确的代理服务信息，如果telnet连接正确，则输入ctrl+]，然后q，回车，退出即可。</p>
<p>检查完毕之后，编辑~&#x2F;.m2&#x2F;settings.xml文件(如果没有该文件，则复制$M2_HOME&#x2F;conf&#x2F;settings.xml)。添加代理配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span>  </span><br><span class="line">  ...  </span><br><span class="line">  <span class="tag">&lt;<span class="name">proxies</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">proxy</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>my-proxy<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">active</span>&gt;</span>true<span class="tag">&lt;/<span class="name">active</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">protocol</span>&gt;</span>http<span class="tag">&lt;/<span class="name">protocol</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">host</span>&gt;</span>218.14.227.197<span class="tag">&lt;/<span class="name">host</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">port</span>&gt;</span>3128<span class="tag">&lt;/<span class="name">port</span>&gt;</span>  </span><br><span class="line">      <span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">        &lt;username&gt;***&lt;/username&gt;  </span></span><br><span class="line"><span class="comment">        &lt;password&gt;***&lt;/password&gt;  </span></span><br><span class="line"><span class="comment">        &lt;nonProxyHosts&gt;  </span></span><br><span class="line"><span class="comment">          repository.mycom.com|*.google.com  </span></span><br><span class="line"><span class="comment">        &lt;/nonProxyHosts&gt;  </span></span><br><span class="line"><span class="comment">      --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">proxy</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">proxies</span>&gt;</span>  </span><br><span class="line">  ...  </span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>这段配置十分简单，proxies下可以有多个proxy元素，如果声明了多个proxy元素，则默认情况下第一个被激活的proxy会生效。这里声明了一个id为my-proxy的代理，active的值为true表示激活该代理，protocol表示使用的代理协议，这里是http。当然，最重要的是指定正确的主机名(host元素)和端口(port元素)。上述xml配置中注释掉了username,password,nonProxyHosts几个元素。当代理服务需要认证时，就需要配置username和password。nonProxyHost元素用来指定哪些主机不需要代理，可以使用”|”符号来分隔多个主机名。此外，该配置也支持通配符，如:*.google.com表示所有以google.com结尾的域名访问都不要通过代理。</p>
<h4 id="2-6-servers"><a href="#2-6-servers" class="headerlink" title="2.6 servers"></a>2.6 servers</h4><p>这是一个认证配置的列表,根据系统中使用的server-id控制。认证配置在maven连接到远程服务时使用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--使用登录方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>deploymentRepo<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">username</span>&gt;</span>repouser<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">password</span>&gt;</span>repopwd<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 使用秘钥认证 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>siteServer<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">privateKey</span>&gt;</span>/path/to/private/key<span class="tag">&lt;/<span class="name">privateKey</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">passphrase</span>&gt;</span>可空<span class="tag">&lt;/<span class="name">passphrase</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-7-mirrors"><a href="#2-7-mirrors" class="headerlink" title="2.7 mirrors"></a>2.7 mirrors</h4><p>指定镜像仓库位置用于从远程仓库下载资源</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>mirrorId<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>repositoryId<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://my.repository.com/repo/path<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>id：用于继承和直接查找，唯一</li>
<li>mirrorOf：镜像所包含的仓库的Id</li>
<li>name：唯一标识，用于区分镜像站</li>
<li>url：镜像路径</li>
</ul>
<h4 id="2-8-profiles"><a href="#2-8-profiles" class="headerlink" title="2.8 profiles"></a>2.8 profiles</h4><ul>
<li>settings.xml中时意味着该profile是全局的，所以只能配置范围宽泛一点配置信息，比如远程仓库等。而一些比较细致一点的需要定义在项目的pom.xml中。</li>
<li>profile可以让我们定义一系列的配置信息，然后指定其激活条件。<br>根据每个profile对应不同的激活条件和配置信息，从而达到不同环境使用不同配置。</li>
<li>例子：通过profile定义jdk1.5以上使用一套配置，jdk1.5以下使用另外一套配置；或者通过操作系统来使用不同的配置信息。</li>
<li>settings.xml中的信息有repositories、pluginRepositories和properties。定义在properties的值可以在pom.xml中使用。</li>
</ul>
<h5 id="activation"><a href="#activation" class="headerlink" title="activation"></a>activation</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">//可定义多个profile,使用activeProfiles激活</span><br><span class="line">	<span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>test<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>false<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.5<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">os</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">name</span>&gt;</span>Windows XP<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">family</span>&gt;</span>Windows<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">arch</span>&gt;</span>x86<span class="tag">&lt;/<span class="name">arch</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.2600<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">os</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">name</span>&gt;</span>mavenVersion<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>2.0.3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">file</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exists</span>&gt;</span>$&#123;basedir&#125;/file2.properties<span class="tag">&lt;/<span class="name">exists</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">missing</span>&gt;</span>$&#123;basedir&#125;/file1.properties<span class="tag">&lt;/<span class="name">missing</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>jdk：检测到对应jdk版本就激活</p>
</li>
<li><p>os：针对不同操作系统</p>
</li>
<li><p>property：当maven检测到property（pom中如${name}这样的）profile将被激活</p>
</li>
<li><p>file：如果存在文件，激活，不存在文件激活</p>
</li>
</ul>
<p>通过以下命令查看哪些profile将生效</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn help:active-profiles</span><br></pre></td></tr></table></figure>

<h5 id="properites"><a href="#properites" class="headerlink" title="properites"></a>properites</h5><p>Maven的属性是值占位符，如果X是一个属性的话，在POM中可以使用${X}来进行任意地方的访问。他们来自于五种不同的风格，所有都可以从settings.xml文件中访问到。</p>
<p>1.env.x：“env.”前缀会返回当前的环境变量。如${env.PATH}就是使用了$path环境变量（windosws中的%PATH%）。</p>
<p>2.project.x：一个点“.”分割的路径，在POM中就是相关的元素的值。例如：<project><version>1.0</version></project>就可以通过${project.version}来访问。</p>
<p>3.settings.x：一个点“.”分割的路径，在settings.xml中就是相对应的元素的值，例如：<settings><offline>false</offline></settings>就可以通过${settings.offline}来访问。</p>
<p>4.Java系统属性：通过java.lang.System.getProperties()来访问的属性都可以像POM中的属性一样访问，例如：${java.home}</p>
<p>5.x：被<properties/>或者外部文件定义的属性，值可以这样访问${someVar}</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">user.install</span>&gt;</span>$&#123;user.home&#125;/our-project<span class="tag">&lt;/<span class="name">user.install</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面这个profile如果被激活，那么在pom中${user.install}就可以被访问了。</p>
<p>实战:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.url</span>&gt;</span>172.11.2.112:3306/yh2_qr<span class="tag">&lt;/<span class="name">p.jdbc.url</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.username</span>&gt;</span>root<span class="tag">&lt;/<span class="name">p.jdbc.username</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.password</span>&gt;</span>root<span class="tag">&lt;/<span class="name">p.jdbc.password</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>uat<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.url</span>&gt;</span>172.11.2.131:3306/yh2_qr<span class="tag">&lt;/<span class="name">p.jdbc.url</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.username</span>&gt;</span>root<span class="tag">&lt;/<span class="name">p.jdbc.username</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">p.jdbc.password</span>&gt;</span>Cheryfs5t6y89kL<span class="tag">&lt;/<span class="name">p.jdbc.password</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br><span class="line"></span><br><span class="line">jdbc.url=jdbc:mysql://$&#123;p.jdbc.url&#125;?characterEncoding=utf-8&amp;allowMultiQueries=true</span><br><span class="line">jdbc.username=$&#123;p.jdbc.username&#125;</span><br><span class="line">jdbc.password=$&#123;p.jdbc.password&#125;</span><br></pre></td></tr></table></figure>

<h5 id="repositories"><a href="#repositories" class="headerlink" title="repositories"></a>repositories</h5><p>repositories是远程项目集合maven用来移植到本地仓库用于构建系统。如果来自本地仓库，Maven调用它的插件和依赖关系。不同的远程仓库可能包含不同的项目，当profile被激活，他们就会需找匹配的release或者snapshot构件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>codehausSnapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>Codehaus Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//发行版</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>always<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//快照版</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>never<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>fail<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://snapshots.maven.codehaus.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.releases，snapshots：这是各种构件的策略，release或者snapshot。这两个集合，POM就可以根据独立仓库任意类型的依赖改变策略。如：一个人可能只激活下载snapshot用来开发。</p>
<p>2.enable：true或者false，决定仓库是否对于各自的类型激活(release或者snapshot)。</p>
<p>3.updatePolicy:这个元素决定更新频率。maven将比较本地pom的时间戳（存储在仓库的maven数据文件中）和远程的.有以下选择: always, daily (默认), interval:X (x是代表分钟的整型)，never.</p>
<p>4.checksumPolicy：当Maven向仓库部署文件的时候，它也部署了相应的校验和文件。可选的为：ignore，fail，warn，或者不正确的校验和。</p>
<p>5.layout：在上面描述仓库的时候，提到他们有统一的布局。Maven 2有它仓库默认布局。然而，Maven 1.x有不同布局。使用这个元素来表明它是default还是legacy。</p>
<h4 id="2-9-activeProfiles"><a href="#2-9-activeProfiles" class="headerlink" title="2.9 activeProfiles"></a>2.9 activeProfiles</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activeProfiles</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">activeProfile</span>&gt;</span>alwaysActiveProfile<span class="tag">&lt;/<span class="name">activeProfile</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">activeProfile</span>&gt;</span>anotherAlwaysActiveProfile<span class="tag">&lt;/<span class="name">activeProfile</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">activeProfiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>每个activeProfile元素对应一个profile id的值，任何profile id被定义到activeProfile的profile将被激活。</p>
<p>参看链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hongmoshui/p/10762272.html">https://www.cnblogs.com/hongmoshui/p/10762272.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/szrs/p/15251037.html">https://www.cnblogs.com/szrs/p/15251037.html</a></p>
<h3 id="4-3、两者的关系"><a href="#4-3、两者的关系" class="headerlink" title="4.3、两者的关系"></a>4.3、两者的关系</h3><p>pom.xml文件针对于具体的项目，settings.xml文件作为maven的全局配置文件；满足条件时，会采用settings.xml文件中的配置，如settingsxml文件中的Profiles标签。还有一些比较私密的配置可以写在settings.xml文件中。</p>
<ol>
<li>Setting.xml中repository的配置与pom.xml中repository的配置有什么不同?</li>
</ol>
<p>Setting.xml中配置repository与pom.xml中配置repository的作用是相同的，都是为了指定多个存储库的使用(you can specify the use of multiple repositories)。但在pom.xml中配置只对当前项目与子项目有用，而在setting.xml中配置为全局性配置，用于所用的项目。</p>
<p>参看链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xrq730/p/5530069.html">https://www.cnblogs.com/xrq730/p/5530069.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq877507054/article/details/79138294">https://blog.csdn.net/qq877507054/article/details/79138294</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/11/05/%E9%94%80%E5%94%AE%E6%A8%A1%E5%9D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/05/%E9%94%80%E5%94%AE%E6%A8%A1%E5%9D%97/" class="post-title-link" itemprop="url">销售模块</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-05 13:13:18" itemprop="dateCreated datePublished" datetime="2021-11-05T13:13:18Z">2021-11-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">工作笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="销售模块"><a href="#销售模块" class="headerlink" title="销售模块"></a>销售模块</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/10/10/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E7%9B%91%E5%90%AC%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/10/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E7%9B%91%E5%90%AC%E5%99%A8/" class="post-title-link" itemprop="url">JavaWeb学习（十一）——监听器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-09 16:06:08" itemprop="dateCreated datePublished" datetime="2021-10-09T16:06:08Z">2021-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h1><blockquote>
<p>监听器就是一个<strong>实现特定接口的普通java程序</strong>，这个程序专门用于<strong>监听另一个java对象的方法调用或属性改变</strong>，当被监听对象发生上述事件后，监听器某个方法将立即被执行。</p>
</blockquote>
<h2 id="监听器组件"><a href="#监听器组件" class="headerlink" title="监听器组件"></a>监听器组件</h2><p>监听器涉及三个组件：<strong>事件源，事件对象，事件监听器</strong></p>
<p><strong>当事件源发生某个动作的时候，它会调用事件监听器的方法，并在调用事件监听器方法的时候把事件对象传递进去。</strong></p>
<p><strong>我们在监听器中就可以通过事件对象获取得到事件源，从而对事件源进行操作！</strong></p>
<p><img src="https://i.loli.net/2021/10/09/I2Dv43FfOJePCcK.png"></p>
<h2 id="简单的监听器"><a href="#简单的监听器" class="headerlink" title="简单的监听器"></a>简单的监听器</h2><p>监听器定义为接口，<strong>监听的方法需要事件对象传递进来，从而在监听器上通过事件对象获取得到事件源，对事件源进行修改</strong>！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 事件监听器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 监听Person事件源的eat和sleep方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PersonListener</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doEat</span><span class="params">(Event event)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doSleep</span><span class="params">(Event event)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="事件源"><a href="#事件源" class="headerlink" title="事件源"></a>事件源</h3><p>事件源是一个Person类，它有eat和sleep()方法。</p>
<p><strong>事件源需要注册监听器(即在事件源上关联监听器对象)</strong></p>
<p>如果<strong>触发了eat或sleep()方法的时候，会调用监听器的方法，并将事件对象传递进去</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * 事件源Person</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * 事件源要提供方法注册监听器(即在事件源上关联监听器对象)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">   </span><br><span class="line">       <span class="comment">//在成员变量定义一个监听器对象</span></span><br><span class="line">       <span class="keyword">private</span> PersonListener personListener ;</span><br><span class="line">       </span><br><span class="line">       <span class="comment">//在事件源中定义两个方法</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Eat</span><span class="params">()</span> &#123;</span><br><span class="line">           </span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">            * 调用监听器的doeat方法监听Person类对象eat(吃)这个动作，将事件对象Event传递给doeat方法，</span></span><br><span class="line"><span class="comment">           * 事件对象封装了事件源，new Event(this)中的this代表的就是事件源</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">           <span class="keyword">if</span>(personListener!=<span class="literal">null</span>)</span><br><span class="line">           personListener.doEat(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="built_in">this</span>));</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span> &#123;</span><br><span class="line">   </span><br><span class="line">      </span><br><span class="line">           <span class="keyword">if</span>(personListener!=<span class="literal">null</span>)</span><br><span class="line">           personListener.doSleep(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="built_in">this</span>));</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="comment">//注册监听器，该类没有监听器对象啊，那么就传递进来吧。</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerLister</span><span class="params">(PersonListener personListener)</span> &#123;</span><br><span class="line">           <span class="built_in">this</span>.personListener = personListener;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p><strong>事件对象封装了事件源。</strong></p>
<p><strong>监听器可以从事件对象上获取得到事件源的对象(信息)</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 事件对象Even</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 事件对象封装了事件源</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 在监听器上能够通过事件对象获取得到事件源</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Event</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Event</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Event</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.person = person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Person <span class="title function_">getResource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Servle监听器"><a href="#Servle监听器" class="headerlink" title="Servle监听器"></a>Servle监听器</h1><p>在Servlet规范中定义了多种类型的监听器，它们<strong>用于监听的事件源分别 ServletContext, HttpSession和ServletRequest这三个域对象</strong></p>
<p>Servlet规范针对这三个对象上的操作，又把多种类型的监听器划分为三种类型：</p>
<ol>
<li>监听域对象自身的创建和销毁的事件监听器。</li>
<li>监听域对象中的属性的增加和删除的事件监听器。</li>
<li>监听绑定到HttpSession域中的某个对象的状态的事件监听器。</li>
</ol>
<p>和其它事件监听器略有不同的是，<strong>servlet监听器的注册不是直接注册在事件源上，而是由WEB容器负责注册</strong>，开发人员<strong>只需在web.xml文件中使用<code>&lt;listener&gt;</code>标签配置好监听器</strong>.</p>
<h2 id="监听对象的创建和销毁"><a href="#监听对象的创建和销毁" class="headerlink" title="监听对象的创建和销毁"></a>监听对象的创建和销毁</h2><p><strong>HttpSessionListener、ServletContextListener、ServletRequestListener分别监控着Session、Context、Request对象的创建和销毁</strong></p>
<ul>
<li><strong>HttpSessionListener(可以用来收集在线者信息)</strong></li>
<li><strong>ServletContextListener(可以获取web.xml里面的参数配置)</strong></li>
<li><strong>ServletRequestListener</strong></li>
</ul>
<h2 id="监听对象属性变化"><a href="#监听对象属性变化" class="headerlink" title="监听对象属性变化"></a>监听对象属性变化</h2><p><strong>ServletContextAttributeListener、HttpSessionAttributeListener、ServletRequestAttributeListener分别监听着Context、Session、Request对象属性的变化</strong></p>
<p>这三个接口中都定义了<strong>三个方法来处理被监听对象中的属性的增加，删除和替换的事件</strong>，同一个事件在这三个接口中对应的方法<strong>名称完全相同，只是接受的参数类型不同</strong>。</p>
<ul>
<li><p><strong>attributeAdded()</strong></p>
<p>当向被监听对象中增加一个属性时，web容器就调用事件监听器的attributeAdded方法进行响应，这个方法接收一个事件类型的参数，监听器可以通过这个参数来获得正在增加属性的域对象和被保存到域中的属性对象</p>
</li>
<li><p><strong>attributeRemoved()</strong></p>
<p>当删除被监听对象中的一个属性时，web容器调用事件监听器的attributeRemoved方法进行响应</p>
</li>
<li><p><strong>attributeReplaced()</strong></p>
<p>当监听器的域对象中的某个属性被替换时，web容器调用事件监听器的attributeReplaced方法进行响应</p>
</li>
</ul>
<h2 id="监听Session内的对象"><a href="#监听Session内的对象" class="headerlink" title="监听Session内的对象"></a>监听Session内的对象</h2><p><strong>除了上面的6种Listener，还有两种Linstener监听Session内的对象，分别是HttpSessionBindingListener和HttpSessionActivationListener，实现这两个接口并不需要在web.xml文件中注册</strong></p>
<ul>
<li><p>实现HttpSessionBindingListener接口，<strong>JavaBean 对象可以感知自己被绑定到 Session 中和从 Session 中删除的事件【和HttpSessionAttributeListener的作用是差不多的】</strong></p>
</li>
<li><p>实现HttpSessionActivationListener接口，<strong>JavaBean 对象可以感知自己被活化和钝化的事件（当服务器关闭时，会将Session的内容保存在硬盘上【钝化】，当服务器开启时，会将Session的内容在硬盘式重新加载【活化】）</strong> 。</p>
<blockquote>
<p>活化:javabean对象和Session一起被反序列化(活化)到内存中。<br>钝化:javabean对象存在Session中，当服务器把session序列化到硬盘上时，如果Session中的javabean对象实现了Serializable接口<br>那么服务器会把session中的javabean对象一起序列化到硬盘上，javabean对象和Session一起被序列化到硬盘中的这个操作称之为钝化<br>如果Session中的javabean对象没有实现Serializable接口，那么服务器会先把Session中没有实现Serializable接口的javabean对象移除<br>然后再把Session序列化(钝化)到硬盘中<br>当绑定到 HttpSession对象中的javabean对象将要随 HttpSession对象被钝化之前，<br>web服务器调用该javabean对象对象的 void sessionWillPassivate(HttpSessionEvent event)方法<br>这样javabean对象就可以知道自己将要和 HttpSession对象一起被序列化(钝化)到硬盘中<br>当绑定到HttpSession对象中的javabean对象将要随 HttpSession对象被活化之后，<br>web服务器调用该javabean对象的 void sessionDidActive(HttpSessionEvent event)方法<br>这样javabean对象就可以知道自己将要和 HttpSession对象一起被反序列化(活化)回到内存中</p>
</blockquote>
</li>
</ul>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="统计网站在线人数"><a href="#统计网站在线人数" class="headerlink" title="统计网站在线人数"></a>统计网站在线人数</h3><ol>
<li><strong>监听Session是否被创建了</strong>：在网站中一般使用Session来标识某用户是否登陆了，如果登陆了，就在Session域中保存相对应的属性。如果没有登陆，那么Session的属性就应该为空。</li>
<li><strong>如果Session被创建了，那么在Context的域对象的值就应该+1</strong>：在线人数用context对象保存</li>
<li><strong>如果Session从内存中移除了，那么在Context的域对象的值就应该-1</strong></li>
</ol>
<ul>
<li>监听器代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountOnline</span> <span class="keyword">implements</span> <span class="title class_">HttpSessionListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取得到Context对象，使用Context域对象保存用户在线的个数</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> se.getSession().getServletContext();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//直接判断Context对象是否存在这个域，如果存在就人数+1,如果不存在，那么就将属性设置到Context域中</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> (Integer) context.getAttribute(<span class="string">&quot;num&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (num == <span class="literal">null</span>) &#123;</span><br><span class="line">            context.setAttribute(<span class="string">&quot;num&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            num++;</span><br><span class="line">            context.setAttribute(<span class="string">&quot;num&quot;</span>, num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> se.getSession().getServletContext();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> (Integer) se.getSession().getAttribute(<span class="string">&quot;num&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (num == <span class="literal">null</span>) &#123;</span><br><span class="line">            context.setAttribute(<span class="string">&quot;num&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            num--;</span><br><span class="line">            context.setAttribute(<span class="string">&quot;num&quot;</span>, num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>显示页面代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在线人数：$&#123;num&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义Session扫描器"><a href="#自定义Session扫描器" class="headerlink" title="自定义Session扫描器"></a>自定义Session扫描器</h3><p>移除长时间没有人使用的session。</p>
<ol>
<li>创建一个容器装在站点的所有session。</li>
<li>隔一段时间去扫描一下全部的session，当长时间没有使用的话就将其从内存中移除。</li>
<li>并发访问的问题：<strong>监听Session创建的方法就会被并发访问了</strong>。<strong>定时器扫描容器的时候，可能是获取不到所有的Session的</strong>。</li>
</ol>
<ul>
<li>监听器代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Listener1</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span>,</span><br><span class="line">        HttpSessionListener &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//服务器一启动，就应该创建容器。我们使用的是LinkList(涉及到增删)。容器也应该是线程安全的。</span></span><br><span class="line">    List&lt;HttpSession&gt; list = Collections.synchronizedList(<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;HttpSession&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义一把锁（Session添加到容器和扫描容器这两个操作应该同步起来）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Object</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">Timer</span> <span class="variable">timer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Timer</span>();</span><br><span class="line">        <span class="comment">//执行我想要的任务，0秒延时，每10秒执行一次</span></span><br><span class="line">        timer.schedule(<span class="keyword">new</span> <span class="title class_">MyTask</span>(list, lock), <span class="number">0</span>, <span class="number">10</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//只要Session一创建了，就应该添加到容器中</span></span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            list.add(se.getSession());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Session被创建啦&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Session被销毁啦。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>任务代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 在任务中应该扫描容器，容器在监听器上，只能传递进来了。</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 要想得到在监听器上的锁，也只能是传递进来</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTask</span> <span class="keyword">extends</span> <span class="title class_">TimerTask</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;HttpSession&gt; sessions;</span><br><span class="line">    <span class="keyword">private</span> Object lock;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyTask</span><span class="params">(List&lt;HttpSession&gt; sessions, Object lock)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sessions = sessions;</span><br><span class="line">        <span class="built_in">this</span>.lock = lock;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            <span class="comment">//遍历容器</span></span><br><span class="line">            <span class="keyword">for</span> (HttpSession session : sessions) &#123;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013263161">过滤器监听器面试题都在这里 - SegmentFault 思否</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/10/09/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%EF%BC%89%E2%80%94%E2%80%94%E8%BF%87%E6%BB%A4%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/09/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%EF%BC%89%E2%80%94%E2%80%94%E8%BF%87%E6%BB%A4%E5%99%A8/" class="post-title-link" itemprop="url">JavaWeb学习（十）——过滤器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-09 10:36:50" itemprop="dateCreated datePublished" datetime="2021-10-09T10:36:50Z">2021-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h1><p><img src="https://i.loli.net/2021/09/13/YLerEdUj1x3uip2.png"></p>
<p><strong>当浏览器发送请求给服务器的时候，先执行过滤器，然后才访问Web的资源。服务器响应Response，从Web资源抵达浏览器之前，也会途径过滤器。</strong></p>
<p><strong>过滤一些敏感的字符串【规定不能出现敏感字符串】、避免中文乱码【规定Web资源都使用UTF-8编码】、权限验证【规定只有带Session或Cookie的浏览器，才能访问web资源】等等等</strong></p>
<p><strong>也就是说：当需要限制用户访问某些资源时、在处理请求时提前处理某些资源、服务器响应的内容对其进行处理再返回、我们就是用过滤器来完成的！</strong></p>
<h2 id="filter是如何实习拦截的？"><a href="#filter是如何实习拦截的？" class="headerlink" title="filter是如何实习拦截的？"></a>filter是如何实习拦截的？</h2><p>Filter接口中有一个doFilter方法，当我们编写好Filter，并配置对哪个web资源进行拦截后，WEB服务器每次在调用web资源的service方法之前，都会先调用一下filter的doFilter方法，因此，在该方法内编写代码可达到如下目的：</p>
<ol>
<li>调用目标资源之前，让一段代码执行。</li>
<li>是否调用目标资源（即是否让用户访问web资源）。</li>
<li>调用目标资源之后，让一段代码执行。</li>
</ol>
<p>　　web服务器在调用doFilter方法时，会传递一个filterChain对象进来，filterChain对象是filter接口中最重要的一个对 象，它也提供了一个doFilter方法，开发人员可以根据需求决定是否调用此方法，调用该方法，则web服务器就会调用web资源的service方 法，即web资源就会被访问，否则web资源不会被访问。</p>
<h2 id="api"><a href="#api" class="headerlink" title="api"></a>api</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Filter</span>&#123;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig varl)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest val1,ServletResponse val2,FilterChain val3)</span>;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建：</p>
<p>filter的创建和销毁是由web服务器负责的。web程序启动时，web服务器将<strong>创建Filter 的实例对象</strong>，并调用其init方法，完成对象的初始化功能，从而为后续的用户请求作好拦截的准备工作，filter对象只会创建一次，init方法也只会执行一次。通过init方法的参数，可获得代表当前filter配置信息的FilterConfig对象。</p>
<p>销毁：</p>
<p>Web容器调用destroy方法销毁Filter。destroy方法在Filter的生命周期中仅执行一次。在destroy方法中，可以释放过滤器使用的资源。</p>
<h1 id="filter开发和部署"><a href="#filter开发和部署" class="headerlink" title="filter开发和部署"></a>filter开发和部署</h1><p>Filter开发分为二个步骤：</p>
<ol>
<li>编写java类实现Filter接口，并实现其doFilter方法。</li>
<li>在 web.xml 文件中使用&lt;filter&gt;和&lt;filter-mapping&gt;元素对编写的filter类进行注册，并设置它所能拦截的资源。</li>
</ol>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Description</span>:filter的三种典型应用：</span></span><br><span class="line"><span class="comment">*                     1、可以在filter中根据条件决定是否调用chain.doFilter(request, response)方法，</span></span><br><span class="line"><span class="comment">*                        即是否让目标资源执行</span></span><br><span class="line"><span class="comment">*                     2、在让目标资源执行之前，可以对request\response作预处理，再让目标资源执行</span></span><br><span class="line"><span class="comment">*                     3、在目标资源执行之后，可以捕获目标资源的执行结果，从而实现一些特殊的功能</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterDemo01</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----过滤器初始化----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response,</span></span><br><span class="line"><span class="params">            FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对request和response进行一些预处理</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo01执行前！！！&quot;</span>);</span><br><span class="line">        chain.doFilter(request, response);  <span class="comment">//让目标资源执行，放行</span></span><br><span class="line">        System.out.println(<span class="string">&quot;FilterDemo01执行后！！！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----过滤器销毁----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="filter的部署"><a href="#filter的部署" class="headerlink" title="filter的部署"></a>filter的部署</h2><h3 id="注册filter"><a href="#注册filter" class="headerlink" title="注册filter"></a>注册filter</h3><p><strong><code>&lt;filter&gt;</code>用于注册过滤器</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">description</span>&gt;</span>FilterDemo02过滤器<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo02<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>me.gacl.web.filter.FilterDemo02<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--配置FilterDemo02过滤器的初始化参数--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">description</span>&gt;</span>配置FilterDemo02过滤器的初始化参数<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>gacl<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">description</span>&gt;</span>配置FilterDemo02过滤器的初始化参数<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>like<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>java<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>&lt;filter-name&gt;</code>用于<strong>为过滤器指定一个名字</strong>，该元素的内容不能为空。</li>
<li><code>&lt;filter-class&gt;</code>元素用于指定过滤器的<strong>完整的限定类名</strong>。</li>
<li><code>&lt;init-param&gt;</code>元素用于为过滤器指定初始化参数，它的子元素、&lt;param-name&gt;指定参数的名字，<code>&lt;param-value&gt;</code>指定参数的值。在过滤器中，可以<strong>使用FilterConfig接口对象来访问初始化参数</strong>。</li>
<li><code>&lt;description&gt;</code>用于添加描述信息，该元素的内容可为空，&lt;description&gt;可以不配置。</li>
</ul>
<h3 id="filter-mapping（映射过滤器）"><a href="#filter-mapping（映射过滤器）" class="headerlink" title="filter-mapping（映射过滤器）"></a>filter-mapping（映射过滤器）</h3><p><code>&lt;filter-mapping&gt;</code>元素用于<strong>设置一个Filter 所负责拦截的资源</strong>。</p>
<p>一个Filter拦截的资源可<strong>通过两种方式来指定：Servlet 名称和资源访问的请求路径</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>FilterDemo1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>&lt;filter-name&gt;</code>子元素用于设置filter的注册名称。<strong>该值必须是在<filter>元素中声明过的过滤器的名字</strong></li>
<li><strong><code>&lt;url-pattern&gt;</code>设置 filter 所拦截的请求路径(过滤器关联的URL样式)</strong></li>
<li><strong><code>&lt;servlet-name&gt;</code>指定过滤器所拦截的Servlet名称</strong>。</li>
<li><code>&lt;dispatcher&gt;</code>指定过滤器所拦截的资源被 Servlet 容器调用的方式，可以是<strong>REQUEST,INCLUDE,FORWARD和ERROR之一，默认REQUEST</strong>。用户可以设置多个<code>&lt;dispatcher&gt;</code> 子元素<strong>用来指定 Filter 对资源的多种调用方式进行拦截。</strong></li>
</ul>
<h4 id="dispatcher"><a href="#dispatcher" class="headerlink" title="dispatcher"></a>dispatcher</h4><p><dispatcher> 子元素可以设置的值及其意义：</p>
<ul>
<li>REQUEST：<strong>当用户直接访问页面时，Web容器将会调用过滤器</strong>。如果目标资源是通过RequestDispatcher的include()或forward()方法访问时，那么该过滤器就不会被调用。</li>
<li>INCLUDE：如果目标资源<strong>是通过RequestDispatcher的include()方法访问时，那么该过滤器将被调用</strong>。除此之外，该过滤器不会被调用。</li>
<li>FORWARD：如果目标资源是通过<strong>RequestDispatcher的forward()方法访问时，那么该过滤器将被调用</strong>，除此之外，该过滤器不会被调用。</li>
<li>ERROR：如果目标资源是<strong>通过声明式异常处理机制调用时，那么该过滤器将被调用</strong>。除此之外，过滤器不会被调用。</li>
</ul>
<h2 id="通过注解配置"><a href="#通过注解配置" class="headerlink" title="通过注解配置"></a>通过注解配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@WebFilter(filterName = &quot;FilterDemo1&quot;,urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="comment">//：“/*”的含义是所有的Web资源都需要途径过滤器</span></span><br></pre></td></tr></table></figure>

<h2 id="Filter链"><a href="#Filter链" class="headerlink" title="Filter链"></a>Filter链</h2><p>​	在一个web应用中，可以开发编写多个Filter，这些Filter组合起来称之为一个Filter链。<br>　　web服务器根据Filter在web.xml文件中的注册顺序，决定先调用哪个Filter，当第一个Filter的doFilter方法被调用时，web服务器会创建一个代表Filter链的FilterChain对象传递给该方法。在doFilter方法中，开发人员如果调用了FilterChain对象的doFilter方法，则web服务器会检查FilterChain对象中是否还有filter，如果有，则调用第2个filter，如果没有，则调用目标资源。</p>
<h1 id="简单应用"><a href="#简单应用" class="headerlink" title="简单应用"></a>简单应用</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3952405.html">javaweb学习总结(四十三)——Filter高级开发 - 孤傲苍狼 - 博客园 (cnblogs.com)</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3948422.html">javaweb学习总结(四十六)——Filter(过滤器)常见应用 - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>
<p>filter的三种典型应用：</p>
<ul>
<li><strong>1、可以在filter中根据条件决定是否调用chain.doFilter(request, response)方法，即是否让目标资源执行</strong></li>
<li><strong>2、在让目标资源执行之前，可以对requestresponse作预处理，再让目标资源执行</strong></li>
<li><strong>3、在目标资源执行之后，可以捕获目标资源的执行结果，从而实现一些特殊的功能</strong></li>
</ul>
<h2 id="禁止浏览器缓存所有动态页面"><a href="#禁止浏览器缓存所有动态页面" class="headerlink" title="禁止浏览器缓存所有动态页面"></a>禁止浏览器缓存所有动态页面</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//让Web资源不缓存，很简单，设置http中response的请求头即可了！</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//我们使用的是http协议，ServletResponse并没有能够设置请求头的方法，所以要强转成HttpServletRequest</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//一般我们写Filter都会把他俩强转成Http类型的</span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) req;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) resp;</span><br><span class="line"></span><br><span class="line">    response.setDateHeader(<span class="string">&quot;Expires&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//放行目标资源的response已经设置成不缓存的了</span></span><br><span class="line">    chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>没有过滤之前，响应头是这样的：</li>
</ul>
<p><img src="https://i.loli.net/2021/09/13/6ExmyzugtfK8RAT.png"></p>
<ul>
<li>过滤之后，响应头是这样的：</li>
</ul>
<p><img src="https://i.loli.net/2021/09/13/6ExmyzugtfK8RAT.png"></p>
<hr>
<h2 id="实现自动登陆"><a href="#实现自动登陆" class="headerlink" title="实现自动登陆"></a>实现自动登陆</h2><h4 id="开发实体、集合模拟数据库、Dao"><a href="#开发实体、集合模拟数据库、Dao" class="headerlink" title="开发实体、集合模拟数据库、Dao"></a>开发实体、集合模拟数据库、Dao</h4><ul>
<li>实体：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String username ;</span><br><span class="line"><span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.username = username;</span><br><span class="line">    <span class="built_in">this</span>.password = password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//各种setter和getter</span></span><br></pre></td></tr></table></figure>

<ul>
<li>集合模拟数据库</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDB</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;123&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;123&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;123&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;User&gt; <span class="title function_">getUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setUsers</span><span class="params">(List&lt;User&gt; users)</span> &#123;</span><br><span class="line">        UserDB.users = users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>开发dao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> User <span class="title function_">find</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; userList = UserDB.getUsers();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//遍历List集合，看看有没有对应的username和password</span></span><br><span class="line">        <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (user.getUsername().equals(username) &amp;&amp; user.getPassword().equals(password)) &#123;</span><br><span class="line">                <span class="keyword">return</span> user;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//根据用户名可以找到用户</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">find</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        List&lt;User&gt; userList = UserDB.getUsers();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//遍历List集合，看看有没有对应的username和password</span></span><br><span class="line">        <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (user.getUsername().equals(username)) &#123;</span><br><span class="line">                <span class="keyword">return</span> user;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="登陆界面"><a href="#登陆界面" class="headerlink" title="登陆界面"></a>登陆界面</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/LoginServlet&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    用户名<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;time&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>&gt;</span>10分钟</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;time&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>&gt;</span>30分钟</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;time&quot;</span> <span class="attr">value</span>=<span class="string">&quot;60&quot;</span>&gt;</span>1小时</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登陆&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="处理登陆的Servlet"><a href="#处理登陆的Servlet" class="headerlink" title="处理登陆的Servlet"></a>处理登陆的Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//得到客户端发送过来的数据</span></span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDao</span>();</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.find(username, password);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">    request.setAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;用户名或密码是错的！&quot;</span>);</span><br><span class="line">    request.getRequestDispatcher(<span class="string">&quot;/message.jsp&quot;</span>).forward(request, response);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果不是为空，那么在session中保存一个属性</span></span><br><span class="line">request.getSession().setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">request.setAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;恭喜你，已经登陆了！&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果想要用户关闭了浏览器，还能登陆，就必须要用到Cookie技术了</span></span><br><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;autoLogin&quot;</span>, user.getUsername() + <span class="string">&quot;.&quot;</span> + user.getPassword());</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置Cookie的最大声明周期为用户指定的</span></span><br><span class="line">cookie.setMaxAge(Integer.parseInt(request.getParameter(<span class="string">&quot;time&quot;</span>)) * <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//把Cookie返回给浏览器</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line"><span class="comment">//跳转到提示页面</span></span><br><span class="line">request.getRequestDispatcher(<span class="string">&quot;/message.jsp&quot;</span>).forward(request, response);</span><br></pre></td></tr></table></figure>

<h3 id="过滤器-1"><a href="#过滤器-1" class="headerlink" title="过滤器"></a>过滤器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) resp;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) req;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果用户没有关闭浏览器，就不需要Cookie做拼接登陆了</span></span><br><span class="line">        <span class="keyword">if</span> (request.getSession().getAttribute(<span class="string">&quot;user&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//用户关闭了浏览器，session的值就获取不到了。所以要通过Cookie来自动登陆</span></span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cookies[i].getName().equals(<span class="string">&quot;autoLogin&quot;</span>)) &#123;</span><br><span class="line">                value = cookies[i].getValue();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//得到Cookie的用户名和密码</span></span><br><span class="line">        <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> value.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> value.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="comment">//在Cookie拿到的密码是md5加密过的，不能直接与数据库中的密码比较</span></span><br><span class="line">            <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDao</span>();</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.find(username);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//通过用户名获得用户信息，得到用户的密码，用户的密码也md5一把</span></span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">dbPassword</span> <span class="operator">=</span> md5.md5(user.getPassword());</span><br><span class="line">            <span class="comment">//如果两个密码匹配了，就是正确的密码了</span></span><br><span class="line">            <span class="keyword">if</span> (password.equals(dbPassword)) &#123;</span><br><span class="line">                request.getSession().setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="过滤敏感词"><a href="#过滤敏感词" class="headerlink" title="过滤敏感词"></a>过滤敏感词</h2><p><strong>要实现这样的功能也很简单，用户输入的敏感词肯定是在getParameter()获取的，我们在getParameter()得到这些数据的时候，判断有没有敏感词汇，如果有就替换掉就好了！简单来说：也是要增强request对象</strong></p>
<h4 id="增强request对象"><a href="#增强request对象" class="headerlink" title="增强request对象"></a>增强request对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyDirtyRequest</span> <span class="keyword">extends</span> <span class="title class_">HttpServletRequestWrapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    HttpServletRequest request;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义一堆敏感词汇</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;傻b&quot;</span>, <span class="string">&quot;尼玛&quot;</span>, <span class="string">&quot;操蛋&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDirtyRequest</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(request);</span><br><span class="line">        <span class="built_in">this</span>.request = request;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getParameter</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">this</span>.request.getParameter(name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//遍历list集合，看看获取得到的数据有没有敏感词汇</span></span><br><span class="line">        <span class="keyword">for</span> (String s : list) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (s.equals(value)) &#123;</span><br><span class="line">                value = <span class="string">&quot;*****&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> value ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="开发过滤器"><a href="#开发过滤器" class="headerlink" title="开发过滤器"></a>开发过滤器</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将request和response强转成http协议的</span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> (HttpServletRequest) req;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">httpServletResponse</span> <span class="operator">=</span> (HttpServletResponse) resp;</span><br><span class="line"></span><br><span class="line">    <span class="type">MyDirtyRequest</span> <span class="variable">dirtyRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDirtyRequest</span>(httpServletRequest);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传送给目标资源的是被增强后的request对象</span></span><br><span class="line">    chain.doFilter(dirtyRequest, httpServletResponse);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/30/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B9%9D%EF%BC%89%E2%80%94%E2%80%94JDBC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/30/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B9%9D%EF%BC%89%E2%80%94%E2%80%94JDBC/" class="post-title-link" itemprop="url">JavaWeb学习（九）——JDBC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-30 10:14:06" itemprop="dateCreated datePublished" datetime="2021-09-30T10:14:06Z">2021-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><p>——执行SQL语句的java api</p>
<p><strong>操作数据库都是在JDBC API【接口】上</strong>，使用不同的数据库，只要用数据库厂商提供的数据库驱动程序即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 加载驱动有两种方式</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * 1：会导致驱动会注册两次，过度依赖于mysql的api，脱离的mysql的开发包，程序则无法编译</span></span><br><span class="line"><span class="comment">    * 2：驱动只会加载一次，不需要依赖具体的驱动，灵活性高</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * 我们一般都是使用第二种方式</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.</span></span><br><span class="line">    <span class="comment">//DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.</span></span><br><span class="line">    Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取与数据库连接的对象-Connetcion</span></span><br><span class="line">    connection = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/zhongfucheng&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取执行sql语句的statement对象</span></span><br><span class="line">    statement = connection.createStatement();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行sql语句,拿到结果集</span></span><br><span class="line">    resultSet = statement.executeQuery(<span class="string">&quot;SELECT * FROM users&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//遍历结果集，得到数据</span></span><br><span class="line">    <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(resultSet.getString(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(resultSet.getString(<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 关闭资源，后调用的先关闭</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * 关闭之前，要判断对象是否存在</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (resultSet != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            resultSet.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (statement != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (connection != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="DriverManager类"><a href="#DriverManager类" class="headerlink" title="DriverManager类"></a>DriverManager类</h2><p>Jdbc程序中的DriverManager用于加载驱动，并创建与数据库的链接，这个API的常用方法：</p>
<ol>
<li>DriverManager.registerDriver(new Driver())</li>
<li>DriverManager.getConnection(url, user, password)，</li>
</ol>
<p>　　注意：<strong>在实际开发中并不推荐采用registerDriver方法注册驱动</strong>。原因有二：<br>　　　　1、查看Driver的源代码可以看到，如果采用此种方式，会导致驱动程序注册两次，也就是在内存中会有两个Driver对象。<br>　　　　2、程序依赖mysql的api，脱离mysql的jar包，程序将无法编译，将来程序切换底层数据库将会非常麻烦。</p>
<p>　　推荐方式：<strong>Class.forName(“com.mysql.jdbc.Driver”);</strong><br>　　采用此种方式不会导致驱动对象在内存中重复出现，并且采用此种方式，程序仅仅只需要一个字符串，不需要依赖具体的驱动，使程序的灵活性更高。</p>
<h2 id="connection类"><a href="#connection类" class="headerlink" title="connection类"></a>connection类</h2><p><strong>客户端与数据库所有的交互都是通过Connection来完成的。</strong></p>
<p>常用的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建向数据库发送sql的statement对象。</span></span><br><span class="line"></span><br><span class="line">createcreateStatement()</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建向数据库发送预编译sql的PrepareSatement对象。</span></span><br><span class="line"></span><br><span class="line">prepareStatement(sql) </span><br><span class="line"></span><br><span class="line"><span class="comment">//创建执行存储过程的callableStatement对象</span></span><br><span class="line"></span><br><span class="line">prepareCall(sql)</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置事务自动提交</span></span><br><span class="line"></span><br><span class="line">setAutoCommit(<span class="type">boolean</span> autoCommit)</span><br><span class="line"></span><br><span class="line"><span class="comment">//提交事务</span></span><br><span class="line"></span><br><span class="line">commit()</span><br><span class="line"></span><br><span class="line"><span class="comment">//回滚事务</span></span><br><span class="line"></span><br><span class="line">rollback()</span><br></pre></td></tr></table></figure>

<h2 id="Statement类"><a href="#Statement类" class="headerlink" title="Statement类"></a>Statement类</h2><p><strong>Statement对象用于向数据库发送Sql语句</strong>，对数据库的增删改查都可以通过此对象发送sql语句完成。</p>
<p>Statement对象的常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询</span></span><br><span class="line"></span><br><span class="line">executeQuery(String sql)</span><br><span class="line"></span><br><span class="line"><span class="comment">//增删改</span></span><br><span class="line"></span><br><span class="line">executeUpdate(String sql)</span><br><span class="line"></span><br><span class="line"><span class="comment">//任意sql语句都可以，但是目标不明确，很少用</span></span><br><span class="line"></span><br><span class="line">execute(String sql)</span><br><span class="line"></span><br><span class="line"><span class="comment">//把多条的sql语句放进同一个批处理中</span></span><br><span class="line"></span><br><span class="line">addBatch(String sql)</span><br><span class="line"></span><br><span class="line"><span class="comment">//向数据库发送一批sql语句执行</span></span><br><span class="line"></span><br><span class="line">executeBatch()</span><br></pre></td></tr></table></figure>

<h2 id="ResultSet类"><a href="#ResultSet类" class="headerlink" title="ResultSet类"></a>ResultSet类</h2><p><strong>ResultSet对象代表Sql语句的执行结果</strong>，当Statement对象执行executeQuery()时，会返回一个ResultSet对象</p>
<p>ResultSet对象维护了一个数据行的游标【简单理解成指针】，调用ResultSet.next()方法，可以让游标指向具体的数据行，进行获取该行的数据</p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取任意类型的数据</span></span><br><span class="line"></span><br><span class="line">getObject(String columnName)</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取指定类型的数据【各种类型，查看API】</span></span><br><span class="line"></span><br><span class="line">getString(String columnName)</span><br><span class="line"></span><br><span class="line"><span class="comment">//对结果集进行滚动查看的方法</span></span><br><span class="line"></span><br><span class="line">next()</span><br><span class="line"></span><br><span class="line">Previous()</span><br><span class="line"></span><br><span class="line">absolute(<span class="type">int</span> row)</span><br><span class="line"></span><br><span class="line">beforeFirst()</span><br><span class="line"></span><br><span class="line">afterLast()</span><br></pre></td></tr></table></figure>

<h2 id="PreparedStatement类"><a href="#PreparedStatement类" class="headerlink" title="PreparedStatement类"></a>PreparedStatement类</h2><p><strong>PreparedStatement对象继承Statement对象，它比Statement对象更强大，使用起来更简单</strong></p>
<ol>
<li>Statement对象编译SQL语句时，如果SQL语句有变量，就需要使用分隔符来隔开，如果变量非常多，就会使SQL变得非常复杂。<strong>PreparedStatement可以使用占位符，简化sql的编写</strong></li>
<li>Statement会频繁编译SQL。<strong>PreparedStatement可对SQL进行预编译，提高效率，预编译的SQL存储在PreparedStatement对象中</strong></li>
<li><strong>PreparedStatement防止SQL注入</strong>。【Statement通过分隔符’++’,编写永等式，可以不需要密码就进入数据库】</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模拟查询id为2的信息</span></span><br><span class="line"><span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> <span class="string">&quot;2&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> UtilsDemo.getConnection();</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users WHERE id = ?&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.preparedStatement(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个参数表示第几个占位符【也就是?号】，第二个参数表示值是多少</span></span><br><span class="line">preparedStatement.setString(<span class="number">1</span>,id);</span><br><span class="line"></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">    System.out.println(resultSet.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//释放资源</span></span><br><span class="line">UtilsDemo.release(connection, preparedStatement, resultSet);</span><br></pre></td></tr></table></figure>

<h2 id="批处理"><a href="#批处理" class="headerlink" title="批处理"></a>批处理</h2><p>当需要向数据库发送一批SQL语句执行时，应避免向数据库一条条发送执行，<strong>采用批处理以提升执行效率</strong></p>
<p>批处理有两种方式：</p>
<ol>
<li>Statement</li>
<li>PreparedStatement</li>
</ol>
<p><strong>通过executeBath()方法批量处理执行SQL语句，返回一个int[]数组，该数组代表各句SQL的返回值</strong></p>
<p>以下代码是以Statement方式实现批处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Statement执行批处理</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 优点：</span></span><br><span class="line"><span class="comment">*       可以向数据库发送不同的SQL语句</span></span><br><span class="line"><span class="comment">* 缺点：</span></span><br><span class="line"><span class="comment">*       SQL没有预编译</span></span><br><span class="line"><span class="comment">*       仅参数不同的SQL，需要重复写多条SQL</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> UtilsDemo.getConnection();</span><br><span class="line"></span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;UPDATE users SET name=&#x27;zhongfucheng&#x27; WHERE id=&#x27;3&#x27;&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO users (id, name, password, email, birthday)&quot;</span> +</span><br><span class="line">        <span class="string">&quot; VALUES(&#x27;5&#x27;,&#x27;nihao&#x27;,&#x27;123&#x27;,&#x27;ss@qq.com&#x27;,&#x27;1995-12-1&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将sql添加到批处理</span></span><br><span class="line">statement.addBatch(sql1);</span><br><span class="line">statement.addBatch(sql2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//执行批处理</span></span><br><span class="line">statement.executeBatch();</span><br><span class="line"></span><br><span class="line"><span class="comment">//清空批处理的sql</span></span><br><span class="line">statement.clearBatch();</span><br><span class="line"></span><br><span class="line">UtilsDemo.release(connection, statement, <span class="literal">null</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>以下方式以PreparedStatement方式实现批处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* PreparedStatement批处理</span></span><br><span class="line"><span class="comment">*   优点：</span></span><br><span class="line"><span class="comment">*       SQL语句预编译了</span></span><br><span class="line"><span class="comment">*       对于同一种类型的SQL语句，不用编写很多条</span></span><br><span class="line"><span class="comment">*   缺点：</span></span><br><span class="line"><span class="comment">*       不能发送不同类型的SQL语句</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> UtilsDemo.getConnection();</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO test(id,name) VALUES (?,?)&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">205</span>; i++) &#123;</span><br><span class="line">    preparedStatement.setInt(<span class="number">1</span>, i);</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>, (i + <span class="string">&quot;zhongfucheng&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加到批处理中</span></span><br><span class="line">    preparedStatement.addBatch();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i %<span class="number">2</span> ==<span class="number">100</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行批处理</span></span><br><span class="line">        preparedStatement.executeBatch();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//清空批处理【如果数据量太大，所有数据存入批处理，内存肯定溢出】</span></span><br><span class="line">        preparedStatement.clearBatch();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不是所有的%2==100，剩下的再执行一次批处理</span></span><br><span class="line">preparedStatement.executeBatch();</span><br><span class="line"></span><br><span class="line"><span class="comment">//再清空</span></span><br><span class="line">preparedStatement.clearBatch();</span><br><span class="line"></span><br><span class="line">UtilsDemo.release(connection, preparedStatement, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h2><p>下面用JDBC连接Oracle数据库去操作大文本数据和二进制数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用JDBC连接Oracle数据库操作二进制数据</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 对于Oracle数据库和Mysql数据库是有所不同的。</span></span><br><span class="line"><span class="comment">* 1.Oracle定义了BLOB字段，但是这个字段不是真正地存储二进制数据</span></span><br><span class="line"><span class="comment">* 2.向这个字段存一个BLOB指针，获取到Oracle的BLOB对象,把二进制数据放到这个指针里面,指针指向BLOB字段</span></span><br><span class="line"><span class="comment">* 3.需要事务支持</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = UtilsDemo.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//开启事务</span></span><br><span class="line">            connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//插入一个BLOB指针</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into test4(id,image) values(?,empty_blob())&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//把BLOB指针查询出来,得到BLOB对象</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;select image from test4 where id= ? for update&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql2);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="comment">//得到Blob对象--当成是Oracle的Blob,不是JDBC的,所以要强转[导的是oracle.sql.BLOB包]</span></span><br><span class="line">                <span class="type">BLOB</span>  <span class="variable">blob</span> <span class="operator">=</span> (BLOB) resultSet.getBlob(<span class="string">&quot;image&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//写入二进制数据</span></span><br><span class="line">                <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> blob.getBinaryOutputStream();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//获取到读取文件读入流</span></span><br><span class="line">                <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Demo7.class.getClassLoader().getResourceAsStream(<span class="string">&quot;01.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                <span class="keyword">while</span> ((len = inputStream.read(bytes)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    outputStream.write(bytes, <span class="number">0</span>, len);</span><br><span class="line">                &#125;</span><br><span class="line">                outputStream.close();</span><br><span class="line">                inputStream.close();</span><br><span class="line">                connection.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            UtilsDemo.release(connection, preparedStatement, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">find</span><span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = UtilsDemo.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM test4 WHERE id=1&quot;</span>;</span><br><span class="line"></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//获取到BLOB对象</span></span><br><span class="line">                <span class="type">BLOB</span> <span class="variable">blob</span> <span class="operator">=</span> (BLOB) resultSet.getBlob(<span class="string">&quot;image&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//将数据读取到磁盘上</span></span><br><span class="line">                <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> blob.getBinaryStream();</span><br><span class="line">                <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;d:\\zhongfucheng.jpg&quot;</span>);</span><br><span class="line">                <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> ((len = inputStream.read(bytes)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    fileOutputStream.write(bytes, <span class="number">0</span>, len);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                inputStream.close();</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            UtilsDemo.release(connection, preparedStatement, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于JDBC连接Oracle数据库操作CLOB数据,我就不再重复了,操作跟BLOB几乎相同</p>
<h2 id="获取数据库的自动主键"><a href="#获取数据库的自动主键" class="headerlink" title="获取数据库的自动主键"></a>获取数据库的自动主键</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JdbcUtils.getConnection();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO test(name) VALUES(?)&quot;</span>;</span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>, <span class="string">&quot;ouzicheng&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (preparedStatement.executeUpdate() &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取到自动主键列的值</span></span><br><span class="line">            resultSet = preparedStatement.getGeneratedKeys();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> resultSet.getInt(<span class="number">1</span>);</span><br><span class="line">                System.out.println(id);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        JdbcUtils.release(connection, preparedStatement, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="调用数据库的存储过程"><a href="#调用数据库的存储过程" class="headerlink" title="调用数据库的存储过程"></a>调用数据库的存储过程</h2><p><strong>调用存储过程的语法：</strong></p>
<figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;</span><br></pre></td></tr></table></figure>

<p><strong>调用函数的语法：</strong></p>
<figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;?= call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;</span><br></pre></td></tr></table></figure>

<p><strong>如果是Output类型的，那么在JDBC调用的时候是要注册的</strong>。如下代码所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    jdbc调用存储过程</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    delimiter $$</span></span><br><span class="line"><span class="comment">        CREATE PROCEDURE demoSp(IN inputParam VARCHAR(255), INOUT inOutParam varchar(255))</span></span><br><span class="line"><span class="comment">        BEGIN</span></span><br><span class="line"><span class="comment">            SELECT CONCAT(&#x27;zyxw---&#x27;, inputParam) into inOutParam;</span></span><br><span class="line"><span class="comment">        END $$</span></span><br><span class="line"><span class="comment">    delimiter ;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//我们在JDBC调用存储过程,就像在调用方法一样</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo9</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">CallableStatement</span> <span class="variable">callableStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JdbcUtils.getConnection();</span><br><span class="line">            </span><br><span class="line">            callableStatement = connection.prepareCall(<span class="string">&quot;&#123;call demoSp(?,?)&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">            callableStatement.setString(<span class="number">1</span>, <span class="string">&quot;nihaoa&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//注册第2个参数,类型是VARCHAR</span></span><br><span class="line">            callableStatement.registerOutParameter(<span class="number">2</span>, Types.VARCHAR);</span><br><span class="line">            callableStatement.execute();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//获取传出参数[获取存储过程里的值]</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> callableStatement.getString(<span class="number">2</span>);</span><br><span class="line">            System.out.println(result);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">                callableStatement.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>参考资料：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">----------------------------------------------------------------------------------过程</span><br><span class="line"></span><br><span class="line">#修改mysql语句的结果符为<span class="comment">//</span></span><br><span class="line">mysql &gt; delimiter <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">#定义一个过程，获取users表总记录数，将<span class="number">10</span>设置到变量count中</span><br><span class="line">create procedure <span class="title function_">simpleproc</span><span class="params">(out count <span class="type">int</span>)</span></span><br><span class="line">begin</span><br><span class="line">    select <span class="title function_">count</span><span class="params">(id)</span> into count from users;</span><br><span class="line">end</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">#修改mysql语句的结果符为;</span><br><span class="line">mysql &gt; delimiter ;</span><br><span class="line"></span><br><span class="line">#调用过程，将结果覆给变量a，@是定义变量的符号</span><br><span class="line">call <span class="title function_">simpleproc</span><span class="params">(<span class="meta">@a</span>)</span>;</span><br><span class="line"></span><br><span class="line">#显示变量a的值</span><br><span class="line">select <span class="meta">@a</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//以下是Java调用Mysql的过程</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;&#123;call simpleproc(?)&#125;&quot;</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtil.getConnection();</span><br><span class="line">    <span class="type">CallableStatement</span> <span class="variable">cstmt</span> <span class="operator">=</span> conn.prepareCall(sql);</span><br><span class="line">    cstmt.registerOutParameter(<span class="number">1</span>,Types.INTEGER);</span><br><span class="line">    cstmt.execute();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> cstmt.getInt(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;共有&quot;</span> + count + <span class="string">&quot;人&quot;</span>);</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------函数</span><br><span class="line"></span><br><span class="line">#修改mysql语句的结果符为<span class="comment">//</span></span><br><span class="line">mysql &gt; delimiter <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">#定义一个函数，完成字符串拼接</span><br><span class="line">create function <span class="title function_">hello</span><span class="params">( s <span class="type">char</span>(<span class="number">20</span>)</span> ) returns <span class="title function_">char</span><span class="params">(<span class="number">50</span>)</span> </span><br><span class="line"><span class="keyword">return</span> concat(<span class="string">&#x27;hello，&#x27;</span>,s,<span class="string">&#x27;!&#x27;</span>);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">#修改mysql语句的结果符为;</span><br><span class="line">mysql &gt; delimiter ;</span><br><span class="line"></span><br><span class="line">#调用函数</span><br><span class="line">select <span class="title function_">hello</span><span class="params">(<span class="string">&#x27;world&#x27;</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//以下是Java调用Mysql的函数</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;&#123;? = call hello(?)&#125;&quot;</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtil.getConnection();</span><br><span class="line">    <span class="type">CallableStatement</span> <span class="variable">cstmt</span> <span class="operator">=</span> conn.prepareCall(sql);</span><br><span class="line">    cstmt.registerOutParameter(<span class="number">1</span>,Types.VARCHAR);</span><br><span class="line">    cstmt.setString(<span class="number">2</span>,<span class="string">&quot;zhaojun&quot;</span>);</span><br><span class="line">    cstmt.execute();</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cstmt.getString(<span class="number">1</span>);</span><br><span class="line">    System.out.println(value);</span><br><span class="line">    JdbcUtil.close(cstmt);</span><br><span class="line">    JdbcUtil.close(conn);</span><br></pre></td></tr></table></figure>



<h1 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h1><p><strong>数据库连接池负责分配,管理和释放数据库连接,它允许应用程序重复使用一个现有的数据库连接,而不是重新建立一个</strong>。</p>
<h2 id="编写连接池"><a href="#编写连接池" class="headerlink" title="编写连接池"></a>编写连接池</h2><ol>
<li>编写连接池需<strong>实现java.sql.DataSource接口</strong></li>
<li><strong>创建批量的Connection用LinkedList保存</strong>【既然是个池，当然用集合保存、、LinkedList底层是链表，对增删性能较好】</li>
<li><strong>实现getConnetion()<strong>，让getConnection()每次调用，都是</strong>在LinkedList中取一个Connection返回给用户</strong></li>
<li><strong>调用Connection.close()方法，Connction返回给LinkedList</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> LinkedList&lt;Connection&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取连接只需要一次就够了，所以用static代码块</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">//读取文件配置</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Demo1.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        properties.load(inputStream);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//加载驱动</span></span><br><span class="line">        Class.forName(driver);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取多个连接，保存在LinkedList集合中</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line">            list.add(connection);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//重写Connection方法，用户获取连接应该从LinkedList中给他</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    System.out.println(list.size());</span><br><span class="line">    System.out.println(list);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//先判断LinkedList是否存在连接</span></span><br><span class="line">   <span class="keyword">return</span> list.size() &gt; <span class="number">0</span> ? list.removeFirst() : <span class="literal">null</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们已经完成前三步了，现在问题来了<strong>。我们调用Conncetion.close()方法，是把数据库的物理连接关掉，而不是返回给LinkedList的</strong></p>
<p>解决思路：</p>
<ol>
<li>写一个Connection子类，覆盖close()方法</li>
<li>写一个Connection包装类，增强close()方法</li>
<li>用动态代理，返回一个代理对象出去，拦截close()方法的调用，对close()增强</li>
</ol>
<p>分析第一个思路：</p>
<ul>
<li><strong>Connection是通过数据库驱动加载的，保存了数据的信息</strong>。写一个子类Connection，new出对象，<strong>子类的Connction无法直接继承父类的数据信息，也就是说子类的Connection是无法连接数据库的</strong>，更别谈覆盖close()方法了。</li>
</ul>
<p>分析第二个思路：</p>
<ul>
<li>写一个Connection包装类。<ol>
<li>写一个类，实现与被增强对象的相同接口【Connection接口】</li>
<li>定义一个变量，指向被增强的对象</li>
<li>定义构造方法，接收被增强对象</li>
<li>覆盖想增强的方法</li>
<li>对于不想增强的方法，直接调用被增强对象的方法</li>
</ol>
</li>
<li>这个思路本身是没什么毛病的，就是<strong>实现接口时，方法太多了！</strong>，所以我们也不使用此方法</li>
</ul>
<p>分析第三个思路代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> list.removeFirst();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//看看池的大小</span></span><br><span class="line">        System.out.println(list.size());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//返回一个动态代理对象</span></span><br><span class="line">        <span class="keyword">return</span> (Connection) Proxy.newProxyInstance(Demo1.class.getClassLoader(), connection.getClass().getInterfaces(), <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果不是调用close方法，就按照正常的来调用</span></span><br><span class="line">                <span class="keyword">if</span> (!method.getName().equals(<span class="string">&quot;close&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> method.invoke(connection, args);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//进到这里来，说明调用的是close方法</span></span><br><span class="line">                    list.add(connection);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//再看看池的大小</span></span><br><span class="line">                    System.out.println(list.size());</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> me.gacl.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcPool</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Field</span>: listConnections</span></span><br><span class="line"><span class="comment">    *         使用LinkedList集合来存放数据库链接，</span></span><br><span class="line"><span class="comment">    *        由于要频繁读写List集合，所以这里使用LinkedList存储数据库连接比较合适</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LinkedList&lt;Connection&gt; listConnections = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Connection&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">//在静态代码块中加载db.properties数据库配置文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> JdbcPool.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            prop.load(in);</span><br><span class="line">            <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">            <span class="comment">//数据库连接池的初始化连接数大小</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">jdbcPoolInitSize</span> <span class="operator">=</span>Integer.parseInt(prop.getProperty(<span class="string">&quot;jdbcPoolInitSize&quot;</span>));</span><br><span class="line">            <span class="comment">//加载数据库驱动</span></span><br><span class="line">            Class.forName(driver);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; jdbcPoolInitSize; i++) &#123;</span><br><span class="line">                <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line">                System.out.println(<span class="string">&quot;获取到了链接&quot;</span> + conn);</span><br><span class="line">                <span class="comment">//将获取到的数据库连接加入到listConnections集合中，listConnections集合此时就是一个存放了数据库连接的连接池</span></span><br><span class="line">                listConnections.add(conn);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExceptionInInitializerError</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="title function_">getLogWriter</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLogWriter</span><span class="params">(PrintWriter out)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLoginTimeout</span><span class="params">(<span class="type">int</span> seconds)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getLoginTimeout</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">unwrap</span><span class="params">(Class&lt;T&gt; iface)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isWrapperFor</span><span class="params">(Class&lt;?&gt; iface)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 获取数据库连接</span></span><br><span class="line"><span class="comment">     * @see javax.sql.DataSource#getConnection()</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//如果数据库连接池中的连接对象的个数大于0</span></span><br><span class="line">        <span class="keyword">if</span> (listConnections.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//从listConnections集合中获取一个数据库连接</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> listConnections.removeFirst();</span><br><span class="line">            System.out.println(<span class="string">&quot;listConnections数据库连接池大小是&quot;</span> + listConnections.size());</span><br><span class="line">            <span class="comment">//返回Connection对象的代理对象</span></span><br><span class="line">            <span class="keyword">return</span> (Connection) Proxy.newProxyInstance(JdbcPool.class.getClassLoader(), conn.getClass().getInterfaces(), <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span><br><span class="line">                        <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                    <span class="keyword">if</span>(!method.getName().equals(<span class="string">&quot;close&quot;</span>))&#123;</span><br><span class="line">                        <span class="keyword">return</span> method.invoke(conn, args);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="comment">//如果调用的是Connection对象的close方法，就把conn还给数据库连接池</span></span><br><span class="line">                        listConnections.add(conn);</span><br><span class="line">                        System.out.println(conn + <span class="string">&quot;被还给listConnections数据库连接池了！！&quot;</span>);</span><br><span class="line">                        System.out.println(<span class="string">&quot;listConnections数据库连接池大小为&quot;</span> + listConnections.size());</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;对不起，数据库忙&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">(String username, String password)</span></span><br><span class="line">            <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="开源数据库连接池"><a href="#开源数据库连接池" class="headerlink" title="开源数据库连接池"></a>开源数据库连接池</h1><p>开源组织提供了数据源的独立实现：</p>
<ul>
<li>DBCP 数据库连接池</li>
<li>C3P0 数据库连接池</li>
</ul>
<h2 id="DBCP"><a href="#DBCP" class="headerlink" title="DBCP"></a>DBCP</h2><p>Tomcat 的连接池正是采用该连接池来实现的。该数据库连接池既可以与应用服务器整合使用，也可由应用程序独立使用。</p>
<p>使用DBCP数据源的步骤：</p>
<ol>
<li><p>导入两个jar包【Commons-dbcp.jar和Commons-pool.jar】</p>
</li>
<li><p>读取配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#连接设置</span><br><span class="line">driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/jdbcstudy</span><br><span class="line">username=root</span><br><span class="line">password=XDP</span><br><span class="line"></span><br><span class="line">#&lt;!-- 初始化连接 --&gt;</span><br><span class="line">initialSize=10</span><br><span class="line"></span><br><span class="line">#最大连接数量</span><br><span class="line">maxActive=50</span><br><span class="line"></span><br><span class="line">#&lt;!-- 最大空闲连接 --&gt;</span><br><span class="line">maxIdle=20</span><br><span class="line"></span><br><span class="line">#&lt;!-- 最小空闲连接 --&gt;</span><br><span class="line">minIdle=5</span><br><span class="line"></span><br><span class="line">#&lt;!-- 超时等待时间以毫秒为单位 6000毫秒/1000等于60秒 --&gt;</span><br><span class="line">maxWait=60000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#JDBC驱动建立连接时附带的连接属性属性的格式必须为这样：[属性名=property;]</span><br><span class="line">#注意：&quot;user&quot; 与 &quot;password&quot; 两个属性会被明确地传递，因此这里不需要包含他们。</span><br><span class="line">connectionProperties=useUnicode=true;characterEncoding=UTF8</span><br><span class="line"></span><br><span class="line">#指定由连接池所创建的连接的自动提交（auto-commit）状态。</span><br><span class="line">defaultAutoCommit=true</span><br><span class="line"></span><br><span class="line">#driver default 指定由连接池所创建的连接的只读（read-only）状态。</span><br><span class="line">#如果没有设置该值，则“setReadOnly”方法将不被调用。（某些驱动并不支持只读模式，如：Informix）</span><br><span class="line">defaultReadOnly=</span><br><span class="line"></span><br><span class="line">#driver default 指定由连接池所创建的连接的事务级别（TransactionIsolation）。</span><br><span class="line">#可用值为下列之一：（详情可见javadoc。）NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE</span><br><span class="line">defaultTransactionIsolation=READ_UNCOMMITTED</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取BasicDataSourceFactory对象</p>
</li>
<li><p>创建DataSource对象</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils_DBCP</span> &#123;    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * 在java中，编写数据库连接池需实现java.sql.DataSource接口，每一种数据库连接池都是DataSource接口的实现</span></span><br><span class="line"><span class="comment">      * DBCP连接池就是java.sql.DataSource接口的一个具体实现</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="comment">//在静态代码块中创建数据库连接池</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//加载dbcpconfig.properties配置文件</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Demo3.class.getClassLoader().getResourceAsStream(<span class="string">&quot;dbcpconfig.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取工厂对象</span></span><br><span class="line">            <span class="type">BasicDataSourceFactory</span> <span class="variable">basicDataSourceFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSourceFactory</span>();</span><br><span class="line">            <span class="comment">//创建数据源</span></span><br><span class="line">            dataSource = basicDataSourceFactory.createDataSource(properties);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//从数据源中获取数据库连接</span></span><br><span class="line">        <span class="keyword">return</span> dataSource.getConnection();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里释放资源不是把数据库的物理连接释放了，是把连接归还给连接池【连接池的Connection内部自己做好了】</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection conn, Statement st, ResultSet rs)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//关闭存储查询结果的ResultSet对象</span></span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            rs = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//关闭负责执行SQL命令的Statement对象</span></span><br><span class="line">                st.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//将Connection连接对象还给数据库连接池</span></span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="C3P0"><a href="#C3P0" class="headerlink" title="C3P0"></a>C3P0</h2><p>C3P0是一个开源的JDBC连接池，它实现了数据源和JNDI绑定，支持JDBC3规范和JDBC2的标准扩展。目前使用它的开源项目有<em><strong>Hibernate，Spring</strong></em>等。C3P0数据源在项目开发中使用得比较多。</p>
<p>　　c3p0与dbcp区别</p>
<ol>
<li>dbcp没有自动回收空闲连接的功能</li>
<li>c3p0有自动回收空闲连接功能</li>
</ol>
<p>步骤：</p>
<ol>
<li>导入开发包【c3p0-0.9.2-pre1.jar】和【mchange-commons-0.2.jar】</li>
<li>导入XML配置文件【可以在程序中自己一个一个配，C3P0的doc中的Configuration有XML文件的事例】</li>
<li>new出ComboPooledDataSource对象</li>
</ol>
<p>　<strong>c3p0-config.xml</strong>的配置信息如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">c3p0-config.xml必须位于类路径下面</span></span><br><span class="line"><span class="comment">private static ComboPooledDataSource ds;</span></span><br><span class="line"><span class="comment">static&#123;</span></span><br><span class="line"><span class="comment">    try &#123;</span></span><br><span class="line"><span class="comment">        ds = new ComboPooledDataSource(&quot;MySQL&quot;);</span></span><br><span class="line"><span class="comment">    &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">        throw new ExceptionInInitializerError(e);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    C3P0的缺省(默认)配置，</span></span><br><span class="line"><span class="comment">    如果在代码中“ComboPooledDataSource ds = new ComboPooledDataSource();”这样写就表示使用的是C3P0的缺省(默认)配置信息来创建数据源</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">default-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcstudy<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>XDP<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">default-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    C3P0的命名配置，</span></span><br><span class="line"><span class="comment">    如果在代码中“ComboPooledDataSource ds = new ComboPooledDataSource(&quot;MySQL&quot;);”这样写就表示使用的是name是MySQL的配置信息来创建数据源</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;MySQL&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcstudy<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>XDP<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在获取数据库连接的工具类(如jdbcUtils)的静态代码块中创建池</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils_C3P0</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//在静态代码块中创建数据库连接池</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//通过代码创建C3P0数据库连接池</span></span><br><span class="line">            <span class="comment">/*ds = new ComboPooledDataSource();</span></span><br><span class="line"><span class="comment">            ds.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;);</span></span><br><span class="line"><span class="comment">            ds.setJdbcUrl(&quot;jdbc:mysql://localhost:3306/jdbcstudy&quot;);</span></span><br><span class="line"><span class="comment">            ds.setUser(&quot;root&quot;);</span></span><br><span class="line"><span class="comment">            ds.setPassword(&quot;XDP&quot;);</span></span><br><span class="line"><span class="comment">            ds.setInitialPoolSize(10);</span></span><br><span class="line"><span class="comment">            ds.setMinPoolSize(5);</span></span><br><span class="line"><span class="comment">            ds.setMaxPoolSize(20);*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//通过读取C3P0的xml配置文件创建数据源，C3P0的xml配置文件c3p0-config.xml必须放在src目录下</span></span><br><span class="line">            <span class="comment">//ds = new ComboPooledDataSource();//使用C3P0的默认配置来创建数据源</span></span><br><span class="line">            ds = <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;MySQL&quot;</span>);<span class="comment">//使用C3P0的命名配置来创建数据源</span></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExceptionInInitializerError</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="comment">//从数据源中获取数据库连接</span></span><br><span class="line">        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 释放的资源包括Connection数据库连接对象，负责执行SQL命令</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection conn,Statement st,ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//关闭存储查询结果的ResultSet对象</span></span><br><span class="line">                rs.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            rs = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(st!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//关闭负责执行SQL命令的Statement对象</span></span><br><span class="line">                st.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(conn!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//将Connection连接对象还给数据库连接池</span></span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="配置Tomcat数据源"><a href="#配置Tomcat数据源" class="headerlink" title="配置Tomcat数据源"></a>配置Tomcat数据源</h2><p>Tomcat服务器也给我们提供了连接池，内部其实就是DBCP</p>
<p>步骤：</p>
<ol>
<li>在META-INF目录下配置context.xml文件【文件内容可以在tomcat默认页面的 JNDI Resources下Configure Tomcat’s Resource Factory找到】</li>
<li>导入Mysql或oracle开发包导入到tomcat的lib目录下</li>
<li>初始化JNDI-&gt;获取JNDI容器-&gt;检索以XXX为名字在JNDI容器存放的连接池</li>
</ol>
<p>context.xml文件的配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context&gt;</span><br><span class="line"></span><br><span class="line">  &lt;Resource name=<span class="string">&quot;jdbc/EmployeeDB&quot;</span></span><br><span class="line">            auth=<span class="string">&quot;Container&quot;</span></span><br><span class="line">            type=<span class="string">&quot;javax.sql.DataSource&quot;</span></span><br><span class="line">            </span><br><span class="line">            username=<span class="string">&quot;root&quot;</span></span><br><span class="line">            password=<span class="string">&quot;root&quot;</span></span><br><span class="line">            driverClassName=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span></span><br><span class="line">            url=<span class="string">&quot;jdbc:mysql://localhost:3306/zhongfucheng&quot;</span></span><br><span class="line">            maxActive=<span class="string">&quot;8&quot;</span></span><br><span class="line">            maxIdle=<span class="string">&quot;4&quot;</span>/&gt;</span><br><span class="line">&lt;/Context&gt;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//初始化JNDI容器</span></span><br><span class="line">            <span class="type">Context</span> <span class="variable">initCtx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取到JNDI容器</span></span><br><span class="line">            <span class="type">Context</span> <span class="variable">envCtx</span> <span class="operator">=</span> (Context) initCtx.lookup(<span class="string">&quot;java:comp/env&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//扫描以jdbc/EmployeeDB名字绑定在JNDI容器下的连接池</span></span><br><span class="line">            <span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> (DataSource)</span><br><span class="line">                    envCtx.lookup(<span class="string">&quot;jdbc/EmployeeDB&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">            System.out.println(conn);</span><br><span class="line"></span><br><span class="line">        &#125; </span><br></pre></td></tr></table></figure>

<p>在获取数据库连接的工具类(如jdbcUtils)的静态代码块中获取JNDI容器中的数据源：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils_JNDI</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//在静态代码块中创建数据库连接池</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">             <span class="comment">//初始化JNDI</span></span><br><span class="line">            <span class="type">Context</span> <span class="variable">initCtx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">             <span class="comment">//得到JNDI容器</span></span><br><span class="line">            <span class="type">Context</span> <span class="variable">envCtx</span> <span class="operator">=</span> (Context) initCtx.lookup(<span class="string">&quot;java:comp/env&quot;</span>);</span><br><span class="line">             <span class="comment">//从JNDI容器中检索name为jdbc/datasource的数据源</span></span><br><span class="line">            ds = (DataSource)envCtx.lookup(<span class="string">&quot;jdbc/datasource&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExceptionInInitializerError</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="comment">//从数据源中获取数据库连接</span></span><br><span class="line">        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection conn,Statement st,ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//关闭存储查询结果的ResultSet对象</span></span><br><span class="line">                rs.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            rs = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(st!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//关闭负责执行SQL命令的Statement对象</span></span><br><span class="line">                st.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(conn!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//将Connection连接对象还给数据库连接池</span></span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="使用dbutils框架"><a href="#使用dbutils框架" class="headerlink" title="使用dbutils框架"></a>使用dbutils框架</h1><p><strong>dbutils它是对JDBC的简单封装，极大简化jdbc编码的工作量</strong></p>
<p>commons-dbutilsAPI介绍：</p>
<ul>
<li>org.apache.commons.dbutils.QueryRunner</li>
<li>org.apache.commons.dbutils.ResultSetHandler</li>
</ul>
<p>工具类：</p>
<ul>
<li>org.apache.commons.dbutils.DbUtils</li>
</ul>
<h2 id="DbUtils类"><a href="#DbUtils类" class="headerlink" title="DbUtils类"></a>DbUtils类</h2><p>提供了<strong>关闭连接，装载JDBC驱动，回滚提交事务等方法</strong>的工具类【比较少使用，因为我们学了连接池，就应该使用连接池连接数据库】</p>
<h2 id="QueryRunner类"><a href="#QueryRunner类" class="headerlink" title="QueryRunner类"></a>QueryRunner类</h2><p>该类<strong>简化了SQL查询，配合ResultSetHandler使用，可以完成大部分的数据库操作</strong>，重载了许多的查询，更新，批处理方法。大大减少了代码量</p>
<h2 id="ResultSetHandler接口"><a href="#ResultSetHandler接口" class="headerlink" title="ResultSetHandler接口"></a>ResultSetHandler接口</h2><p>该接口<strong>规范了对ResultSet的操作</strong>，要对结果集进行什么操作，传入ResultSetHandler接口的实现类即可。</p>
<ul>
<li>ArrayHandler：把结果集中的<strong>第一行</strong>数据转成对象数组。</li>
<li>ArrayListHandler：把结果集中的每一行数据都转成一个数组，再存放到List中。</li>
<li>BeanHandler：将结果集中的<strong>第一行</strong>数据封装到一个对应的JavaBean实例中。</li>
<li>BeanListHandler：将结果集中的每一行数据都封装到一个对应的JavaBean实例中，存放到List里。</li>
<li>ColumnListHandler：将结果集中某一列的数据存放到List中。</li>
<li>KeyedHandler(name)：将结果集中的每一行数据都封装到一个Map里，再把这些map再存到一个map里，其key为指定的key。</li>
<li>MapHandler：将结果集中的第一行数据封装到一个Map里，key是列名，value就是对应的值。</li>
<li>MapListHandler：将结果集中的每一行数据都封装到一个Map里，然后再存放到List</li>
<li>ScalarHandler 将ResultSet的一个列到一个对象中。</li>
</ul>
<hr>
<p>使用DbUtils框架对数据库的CRUD</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 使用DbUtils框架对数据库的CRUD</span></span><br><span class="line"><span class="comment">* 批处理</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@org</span>.junit.Test</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建出QueryRunner对象</span></span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(JdbcUtils.getDataSource());</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO student (id,name) VALUES(?,?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//我们发现query()方法有的需要传入Connection对象，有的不需要传入</span></span><br><span class="line">        <span class="comment">//区别：你传入Connection对象是需要你来销毁该Connection，你不传入，由程序帮你把Connection放回到连接池中</span></span><br><span class="line">        queryRunner.update(sql, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;100&quot;</span>, <span class="string">&quot;zhongfucheng&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@org</span>.junit.Test</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span><span class="keyword">throws</span> SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建出QueryRunner对象</span></span><br></pre></td></tr></table></figure>

<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><blockquote>
<p>一个SESSION所进行的所有更新操作要么一起成功，要么一起失败</p>
</blockquote>
<p>注意：当Connection遇到一个未处理的SQLException时，系统会非正常退出，事务也会自动回滚，但<strong>如果程序捕获到了异常，是需要在catch中显式回滚事务的。</strong></p>
<h2 id="savapoint"><a href="#savapoint" class="headerlink" title="savapoint"></a>savapoint</h2><p>可以设置中间点。</p>
<p>注意：<strong>savepoint不会结束当前事务，普通提交和回滚都会结束当前事务的</strong></p>
<h2 id="注事务的隔离级别"><a href="#注事务的隔离级别" class="headerlink" title="注事务的隔离级别"></a>注事务的隔离级别</h2><p>数据库定义了4个隔离级别：</p>
<ol>
<li>Serializable【可避免脏读，不可重复读，虚读】</li>
<li>Repeatable read【可避免脏读，不可重复读】</li>
<li>Read committed【可避免脏读】</li>
<li>Read uncommitted【级别最低，什么都避免不了】</li>
</ol>
<p>分别对应Connection类中的4个常量</p>
<ol>
<li><strong>TRANSACTION_READ_UNCOMMITTED</strong></li>
<li><strong>TRANSACTION_READ_COMMITTED</strong></li>
<li><strong>TRANSACTION_REPEATABLE_READ</strong></li>
<li><strong>TRANSACTION_SERIALIZABLE</strong></li>
</ol>
<hr>
<p>脏读：<strong>一个事务读取到另外一个事务未提交的数据</strong></p>
<p>不可重复读：<strong>一个事务读取到另外一个事务已经提交的数据，也就是说一个事务可以看到其他事务所做的修改</strong></p>
<p>虚读(幻读)：<strong>是指在一个事务内读取到了别的事务插入的数据，导致前后读取不一致。</strong></p>
<p>注：<strong>和不可重复读类似，但虚读(幻读)会读到其他事务的插入的数据，导致前后读取不一致</strong></p>
<hr>
<p>简单总结：<strong>脏读是不可容忍的，不可重复读和虚读在一定的情况下是可以的【做统计的肯定就不行】</strong>。</p>
<h2 id="事务处理"><a href="#事务处理" class="headerlink" title="事务处理"></a>事务处理</h2><ul>
<li><p>在数据访问层（Dao）处理事务</p>
<p> Dao层只涉及到最基本的CRUD，不涉及具体的业务操作，所以在开发中DAO层出现这样的业务处理方法是一种不好的设计。</p>
</li>
<li><p>在业务层(BusinessService)处理事务</p>
</li>
<li><p>使用ThreadLocal进行事务处理</p>
</li>
</ul>
<h1 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h1><h2 id="Oracle实现分页"><a href="#Oracle实现分页" class="headerlink" title="Oracle实现分页"></a>Oracle实现分页</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Oracle分页：</span></span><br><span class="line"><span class="comment">    Oracle的分页依赖于ROWNUM这个伪列，ROWNUM主要作用就是产生行号。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  分页原理：</span></span><br><span class="line"><span class="comment">    1：子查询查出前n行数据，ROWNUM产生前N行的行号</span></span><br><span class="line"><span class="comment">    2：使用子查询产生ROWNUM的行号，通过外部的筛选出想要的数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  例子：</span></span><br><span class="line"><span class="comment">    我现在规定每页显示5行数据【lineSize=5】，我要查询第2页的数据【currentPage=2】</span></span><br><span class="line"><span class="comment">    注：【对照着语法来看】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  实现：</span></span><br><span class="line"><span class="comment">    1：子查询查出前10条数据【ROWNUM&lt;=10】</span></span><br><span class="line"><span class="comment">    2：外部筛选出后面5条数据【ROWNUM&gt;5】</span></span><br><span class="line"><span class="comment">    3：这样我们就取到了后面5条的数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Oracle分页语法：</span></span><br><span class="line"><span class="comment">    @lineSize---每页显示数据行数</span></span><br><span class="line"><span class="comment">    /*</span></span><br><span class="line"><span class="comment">  Oracle分页：</span></span><br><span class="line"><span class="comment">    Oracle的分页依赖于ROWNUM这个伪列，ROWNUM主要作用就是产生行号。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  分页原理：</span></span><br><span class="line"><span class="comment">    1：子查询查出前n行数据，ROWNUM产生前N行的行号</span></span><br><span class="line"><span class="comment">    2：使用子查询产生ROWNUM的行号，通过外部的筛选出想要的数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  例子：</span></span><br><span class="line"><span class="comment">    我现在规定每页显示5行数据【lineSize=5】，我要查询第2页的数据【currentPage=2】</span></span><br><span class="line"><span class="comment">    注：【对照着语法来看】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  实现：</span></span><br><span class="line"><span class="comment">    1：子查询查出前10条数据【ROWNUM&lt;=10】</span></span><br><span class="line"><span class="comment">    2：外部筛选出后面5条数据【ROWNUM&gt;5】</span></span><br><span class="line"><span class="comment">    3：这样我们就取到了后面5条的数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Oracle分页语法：</span></span><br><span class="line"><span class="comment">        @lineSize---每页显示数据行数</span></span><br><span class="line"><span class="comment">        @currentPage----当前所在页</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">SELECT *FROM (</span><br><span class="line">    SELECT 列名,列名,ROWNUM rn</span><br><span class="line">    FROM 表名</span><br><span class="line">    WHERE ROWNUM&lt;=(currentPage*lineSize)) temp</span><br><span class="line"></span><br><span class="line">WHERE temp.rn&gt;(currentPage-<span class="number">1</span>)*lineSize;</span><br></pre></td></tr></table></figure>

<h2 id="Mysql实现分页"><a href="#Mysql实现分页" class="headerlink" title="Mysql实现分页"></a>Mysql实现分页</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Mysql分页语法：</span></span><br><span class="line"><span class="comment">      @start---偏移量，不设置就是从0开始【也就是(currentPage-1)*lineSize】</span></span><br><span class="line"><span class="comment">      @length---长度，取多少行数据</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> 表名</span><br><span class="line">    LIMIT [<span class="keyword">START</span>], length;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      例子：</span></span><br><span class="line"><span class="comment">        我现在规定每页显示5行数据，我要查询第2页的数据</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">      分析：</span></span><br><span class="line"><span class="comment">        1：第2页的数据其实就是从第6条数据开始，取5条</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">      实现：</span></span><br><span class="line"><span class="comment">        1：start为5【偏移量从0开始】</span></span><br><span class="line"><span class="comment">        2：length为5</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<ul>
<li>Mysql从(currentPage-1)*lineSize开始取数据，取lineSize条数据</li>
<li>Oracle先获取currentPage*lineSize条数据，从(currentPage-1)*lineSize开始取数据</li>
</ul>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013312766">参考文章</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/29/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89%E2%80%94%E2%80%94JSTL%E6%A0%87%E7%AD%BE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/29/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89%E2%80%94%E2%80%94JSTL%E6%A0%87%E7%AD%BE%E5%BA%93/" class="post-title-link" itemprop="url">JavaWeb学习（八）——JSTL标签库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-29 09:44:36" itemprop="dateCreated datePublished" datetime="2021-09-29T09:44:36Z">2021-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JSTL标签库"><a href="#JSTL标签库" class="headerlink" title="JSTL标签库"></a>JSTL标签库</h1><p>为了弥补html标签的不足，规范自定义标签的使用而诞生的。使用JSLT标签的目的就是不希望在jsp页面中出现java逻辑代码。</p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul>
<li>核心标签(用得最多)</li>
<li>国际化标签(I18N格式化标签)</li>
<li>数据库标签(SQL标签，很少使用)</li>
<li>XML标签(几乎不用)</li>
<li>JSTL函数(EL函数)</li>
</ul>
<h1 id="核心标签库"><a href="#核心标签库" class="headerlink" title="核心标签库"></a>核心标签库</h1><p>JSTL的核心标签库标签共13个，使用这些标签能够完成JSP页面的基本功能，减少编码工作。</p>
<p>　　从功能上可以分为4类：表达式控制标签、流程控制标签、循环标签、URL操作标签。<br>　　　　（1）<strong>表达式控制标签</strong>：<strong>out标签、set标签、remove标签、catch标签。</strong><br>　　　　（2）<strong>流程控制标签</strong>：<strong>if标签、choose标签、when标签、otherwise标签</strong>。<br>　　　　（3）<strong>循环标签</strong>：<strong>forEach标签、forTokens标签</strong>。<br>　　　　（4）<strong>URL操作标签</strong>：<strong>import标签、url标签、redirect标签、param标签</strong>。</p>
<p>　　在JSP页面引入核心标签库的代码为：**&lt;%@ taglib prefix&#x3D;”c” uri&#x3D;”<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/core&quot;">http://java.sun.com/jsp/jstl/core&quot;</a> %&gt;**</p>
<h2 id="out标签"><a href="#out标签" class="headerlink" title="out标签"></a>out标签</h2><p>&lt;c:out&gt;标签主要是<strong>用来输出数据对象（字符串、表达式）的内容或结果</strong>。<br>　　在使用Java脚本输出时常使用的方式为： &lt;% out.println(“字符串”)%&gt; 或者 &lt;%&#x3D;表达式%&gt; ，在web开发中，为了避免暴露逻辑代码会尽量减少页面中的Java脚本，使用&lt;c:out&gt;标签就可以实现以上功能。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">”字符串”</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">”EL表达式”</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　JSTL的使用是和EL表达式分不开的，EL表达式虽然可以直接将结果返回给页面，但有时得到的结果为空，&lt;c:out&gt;有特定的结果处理功能，EL的单独使用会降低程序的易读性，建议把EL的结果输入放入&lt;c:out&gt;标签中。</p>
<p>&lt;c:out&gt;标签的语法：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:out value=”要显示的数据对象” [escapeXml=”<span class="literal">true</span>|<span class="literal">false</span>”] [<span class="keyword">default</span>=”默认值”]/&gt;</span><br><span class="line">&lt;c:out value=”要显示的数据对象” [escapeXml=”<span class="literal">true</span>|<span class="literal">false</span>”]&gt;默认值&lt;/c:out&gt;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">属性名</th>
<th align="center">是否支持EL</th>
<th align="center">属性类型</th>
<th align="center">属性描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">value</td>
<td align="center">true</td>
<td align="center">Object</td>
<td align="center">指定要输出的内容</td>
</tr>
<tr>
<td align="center">escapeXml</td>
<td align="center">true</td>
<td align="center">Boolean</td>
<td align="center">指定是否将&gt;、&lt;、&amp;等特殊字符进行HTML编码转换后再进行输出。默认true</td>
</tr>
<tr>
<td align="center">default</td>
<td align="center">true</td>
<td align="center">Object</td>
<td align="center">指定如果value属性值为null时所输出的默认值</td>
</tr>
</tbody></table>
<p>使用范例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%--引入JSTL核心标签库 --%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JSTL: --表达式控制标签“out”标签的使用<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;下面的代码演示了c:out的使用，以及在不同属性值状态下的结果。&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        &lt;%--（1）直接输出了一个字符串。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（1）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;JSTL的out标签的使用&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（2）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;&lt;a href=&#x27;http://www.cnblogs.com/&#x27;&gt;点击链接到博客园&lt;/a&gt;&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--escapeXml=&quot;false&quot;表示value值中的html标签不进行转义，而是直接输出 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（3）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;&lt;a href=&#x27;http://www.cnblogs.com/&#x27;&gt;点击链接到博客园&lt;/a&gt;&quot;</span> <span class="attr">escapeXml</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--(4）字符串中有转义字符，但在默认情况下没有转换。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（4）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;&amp;lt未使用字符转义&amp;gt&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--（5）使用了转义字符&amp;lt和&amp;gt分别转换成<span class="tag">&lt;<span class="name">和</span>&gt;</span>符号。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（5）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;&amp;lt使用字符转义&amp;gt&quot;</span> <span class="attr">escapeXml</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--（6）设定了默认值，从EL表达式$&#123;null&#125;得到空值，所以直接输出设定的默认值。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（6）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;null&#125;&quot;</span>&gt;</span>使用了默认值<span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--（7）未设定默认值，输出结果为空。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（7）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;null&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--（8）设定了默认值，从EL表达式$&#123;null&#125;得到空值，所以直接输出设定的默认值。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（8）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;null&#125;&quot;</span> <span class="attr">default</span>=<span class="string">&quot;默认值&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--（9）未设定默认值，输出结果为空。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>（9）<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;null&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="set标签"><a href="#set标签" class="headerlink" title="set标签"></a>set标签</h2><p>&lt;c:set&gt;标签用于把某一个对象存在指定的域范围内，或者将某一个对象存储到Map或者JavaBean对象中。</p>
<p>语法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1：存值，把一个值放在指定的域范围内。</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">value</span>=<span class="string">”值1”</span> <span class="attr">var</span>=<span class="string">”name1”</span> [<span class="attr">scope</span>=<span class="string">”page|request|session|application”]/</span>&gt;</span></span><br><span class="line">　　　　含义：把一个变量名为name1值为“值1”的变量存储在指定的scope范围内。</span><br><span class="line">2：</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">”name2”</span> [<span class="attr">scope</span>=<span class="string">”page|request|session|application”]</span>&gt;</span></span><br><span class="line">　　　　　　值2</span><br><span class="line">　　　　<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">　　　　含义：把一个变量名为name2，值为值2的变量存储在指定的scope范围内。</span><br><span class="line">3：</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">value</span>=<span class="string">”值3”</span> <span class="attr">target</span>=<span class="string">”JavaBean对象”</span> <span class="attr">property</span>=<span class="string">”属性名”/</span>&gt;</span></span><br><span class="line">　　　　含义：把一个值为“值3”赋值给指定的JavaBean的属性名。相当与setter()方法。</span><br><span class="line">4：</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">”JavaBean对象”</span> <span class="attr">property</span>=<span class="string">”属性名”</span>&gt;</span></span><br><span class="line">　　　　　　值4</span><br><span class="line">　　　　<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">　　　　含义：把一个值4赋值给指定的JavaBean的属性名。</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">属性名</th>
<th align="center">是否支持EL</th>
<th align="center">属性类型</th>
<th align="center">属性描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">value</td>
<td align="center">true</td>
<td align="center">Object</td>
<td align="center">指定要输出的内容</td>
</tr>
<tr>
<td align="center">var</td>
<td align="center">false</td>
<td align="center">String</td>
<td align="center">指定要设置的web域属性的名称</td>
</tr>
<tr>
<td align="center">scope</td>
<td align="center">false</td>
<td align="center">String</td>
<td align="center">指定属性所在的web域</td>
</tr>
<tr>
<td align="center">target</td>
<td align="center">true</td>
<td align="center">Object</td>
<td align="center">指定要设置属性的对象（javabean或是map）</td>
</tr>
<tr>
<td align="center">property</td>
<td align="center">true</td>
<td align="center">String</td>
<td align="center">指定当前为对象设置的属性名称</td>
</tr>
</tbody></table>
<p>使用范例</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%--引入JSTL核心标签库 --%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line">&lt;%--使用JSP的指令元素指定要使用的JavaBean --%&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">jsp:useBean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;javabean.Person&quot;</span>/&gt;</span></span><br><span class="line">&lt;%--负责实例化Bean，id指定实例化后的对象名，可以通过$&#123;person&#125;得到person在内存中的值</span><br><span class="line">（或者使用person.toString()方法）。 --%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>JSTL: --表达式控制标签“set”标签的使用<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>代码给出了给指定scope范围赋值的示例。<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        &lt;%--通过<span class="tag">&lt;<span class="name">c:set</span>&gt;</span>标签将data1的值放入page范围中。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入page域中:<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">&quot;data1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xdp&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;page&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--使用EL表达式从pageScope得到data1的值。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从page域中得到值：$&#123;pageScope.data1&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--通过<span class="tag">&lt;<span class="name">c:set</span>&gt;</span>标签将data2的值放入request范围中。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入request域中:<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">&quot;data2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;gacl&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--使用EL表达式从requestScope得到data2的值。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从request域中得到值：$&#123;requestScope.data2&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--通过<span class="tag">&lt;<span class="name">c:set</span>&gt;</span>标签将值name1的值放入session范围中。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入session域中。<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">value</span>=<span class="string">&quot;孤傲苍狼&quot;</span> <span class="attr">var</span>=<span class="string">&quot;name1&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;session&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:set</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--使用EL表达式从sessionScope得到name1的值。--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从session域中得到值:$&#123;sessionScope.name1&#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--把name2放入application范围中。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入application域中。<span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">&quot;name2&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;application&quot;</span>&gt;</span>白虎神皇<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--使用EL表达式从application范围中取值，用<span class="tag">&lt;<span class="name">c:out</span>&gt;</span>标签输出使得页面规范化。 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>使用out标签和EL表达式嵌套从application域中得到值：</span><br><span class="line">             <span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;applicationScope.name2&#125;&quot;</span>&gt;</span>未得到name的值<span class="tag">&lt;/<span class="name">c:out</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        &lt;%--不指定范围使用EL自动查找得到值 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>未指定scope的范围，会从不同的范围内查找得到相应的值：$&#123;data1&#125;、$&#123;data2&#125;、$&#123;name1&#125;、$&#123;name2&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>使用Java脚本实现以上功能<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入page域中。&lt;%pageContext.setAttribute(&quot;data1&quot;,&quot;xdp&quot;);%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从page域中得到值:&lt;%out.println(pageContext.getAttribute(&quot;data1&quot;));%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入request域中。&lt;%request.setAttribute(&quot;data2&quot;,&quot;gacl&quot;);%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从request域中得到值:&lt;%out.println(request.getAttribute(&quot;data2&quot;));%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把一个值放入session域中。&lt;%session.setAttribute(&quot;name1&quot;,&quot;孤傲苍狼&quot;);%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从session中域得到值:&lt;%out.println(session.getAttribute(&quot;name1&quot;));%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--out.println()方法与&lt;%=%&gt;表达式输出功能一样</span><br><span class="line">        但使用表达式输出（&lt;%=%&gt;）明显要比使用out.println()输出更好。</span><br><span class="line">        --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&lt;%=session.getAttribute(&quot;name1&quot;) %&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>把另一个值放入application域中。&lt;%application.setAttribute(&quot;name2&quot;,&quot;白虎神皇&quot;);%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span> 从application域中得到值：&lt;%out.println(application.getAttribute(&quot;name2&quot;));%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&lt;%=application.getAttribute(&quot;name2&quot;)%&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>未指定scope的范围，会从不同的范围内查找得到相应的值：</span><br><span class="line">            &lt;%=pageContext.findAttribute(&quot;data1&quot;)%&gt;、</span><br><span class="line">            &lt;%=pageContext.findAttribute(&quot;data2&quot;)%&gt;、</span><br><span class="line">            &lt;%=pageContext.findAttribute(&quot;name1&quot;)%&gt;、</span><br><span class="line">            &lt;%=pageContext.findAttribute(&quot;name2&quot;)%&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>操作JavaBean，设置JavaBean的属性值<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    &lt;%--设置JavaBean的属性值，等同与setter方法，Target指向实例化后的对象，property指向要插入值的参数名。</span><br><span class="line">    注意：使用target时一定要指向实例化后的JavaBean对象，也就是要跟<span class="tag">&lt;<span class="name">jsp:useBean</span>&gt;</span>配套使用，</span><br><span class="line">    也可以java脚本实例化，但这就失去了是用标签的本质意义。</span><br><span class="line">    使用Java脚本实例化：</span><br><span class="line">    &lt;%@page import=&quot;javabean.Person&quot;%</span><br><span class="line">    &lt;% Person person=new Person(); %&gt;</span><br><span class="line">     --%&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">&quot;$&#123;person&#125;&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>&gt;</span>孤傲苍狼<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">&quot;$&#123;person&#125;&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>&gt;</span>25<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">&quot;$&#123;person&#125;&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">&quot;$&#123;person&#125;&quot;</span> <span class="attr">property</span>=<span class="string">&quot;home&quot;</span>&gt;</span>中国<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>使用的目标对象为：$&#123;person&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从Bean中获得的name值为：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;person.name&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从Bean中获得的age值为：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;person.age&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从Bean中获得的sex值为：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;person.sex&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>从Bean中获得的home值为：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;person.home&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>操作Map<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">     &lt;%</span><br><span class="line">        Map map = new HashMap();</span><br><span class="line">        request.setAttribute(&quot;map&quot;,map);</span><br><span class="line">     %&gt;</span><br><span class="line">     &lt;%--将data对象的值存储到map集合中 --%&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">property</span>=<span class="string">&quot;data&quot;</span> <span class="attr">value</span>=<span class="string">&quot;gacl&quot;</span> <span class="attr">target</span>=<span class="string">&quot;$&#123;map&#125;&quot;</span>/&gt;</span></span><br><span class="line">        $&#123;map.data&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="remove标签"><a href="#remove标签" class="headerlink" title="remove标签"></a>remove标签</h2><p>从指定的JSP范围内移除指定的变量。</p>
<p>语法：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:<span class="built_in">remove</span> <span class="attribute">var</span>=”变量名” [<span class="attribute">scope</span>=”page|request|session|application”]/&gt;</span><br><span class="line">　　其中var属性是必须的，scope可以以省略。</span><br></pre></td></tr></table></figure>

<p>范例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%--引入JSTL核心标签库 --%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>JSTL: --表达式控制标签“remove”标签的使用<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">&quot;name&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;session&quot;</span>&gt;</span>孤傲苍狼<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">var</span>=<span class="string">&quot;age&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;session&quot;</span>&gt;</span>25<span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;sessionScope.name&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;sessionScope.age&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;%--使用remove标签移除age变量 --%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">c:remove</span> <span class="attr">var</span>=<span class="string">&quot;age&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;sessionScope.name&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;sessionScope.age&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:out</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="catch标签"><a href="#catch标签" class="headerlink" title="catch标签"></a>catch标签</h2><p>用于捕获嵌套在标签体中的内容抛出的异常。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%--引入JSTL核心标签库 --%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JSTL: --表达式控制标签“catch”标签实例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>catch标签实例<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    &lt;%--把容易产生异常的代码放在<span class="tag">&lt;<span class="name">c:catch</span>&gt;</span><span class="tag">&lt;/<span class="name">c:catch</span>&gt;</span>中，</span><br><span class="line">    自定义一个变量errorInfo用于存储异常信息 --%&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:catch</span> <span class="attr">var</span>=<span class="string">&quot;errorInfo&quot;</span>&gt;</span></span><br><span class="line">        &lt;%--实现了一段异常代码，向一个不存在的JavaBean中插入一个值--%&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">c:set</span> <span class="attr">target</span>=<span class="string">&quot;person&quot;</span> <span class="attr">property</span>=<span class="string">&quot;hao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">c:set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:catch</span>&gt;</span></span><br><span class="line">    &lt;%--用EL表达式得到errorInfo的值，并使用<span class="tag">&lt;<span class="name">c:out</span>&gt;</span>标签输出 --%&gt;</span><br><span class="line">    异常：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;errorInfo&#125;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    异常 errorInfo.getMessage：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;errorInfo.message&#125;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    异常 errorInfo.getCause：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;errorInfo.cause&#125;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    异常 errorInfo.getStackTrace：<span class="tag">&lt;<span class="name">c:out</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;errorInfo.stackTrace&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其他的标签可见:<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3943390.html">javaweb学习总结(二十八)——JSTL标签库之核心标签 - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/22/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%83%EF%BC%89%E2%80%94%E2%80%94javaweb%E7%9A%84%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%83%EF%BC%89%E2%80%94%E2%80%94javaweb%E7%9A%84%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">JavaWeb学习（七）——javaweb的开发模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 15:51:07" itemprop="dateCreated datePublished" datetime="2021-09-22T15:51:07Z">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JSP-JavaBean开发模式"><a href="#JSP-JavaBean开发模式" class="headerlink" title="JSP+JavaBean开发模式"></a>JSP+JavaBean开发模式</h1><p><img src="https://i.loli.net/2021/09/22/hKmi34gapD9dNIH.png" alt="img"></p>
<p>JSP负责控制逻辑、表现逻辑、业务对象（javabean）的调用。</p>
<p>JSP+JavaBean模式适合开发业务逻辑不太复杂的web应用程序，这种模式下，JavaBean用于封装业务数据，JSP即负责处理用户请求，又显示数据。</p>
<h1 id="Servlet-JSP-JavaBean开发模式"><a href="#Servlet-JSP-JavaBean开发模式" class="headerlink" title="Servlet+JSP+JavaBean开发模式"></a>Servlet+JSP+JavaBean开发模式</h1><p>Servlet+JSP+JavaBean组合开发就是一种MVC开发模式了，控制器(Controller)采用Servlet、模型(Model)采用JavaBean、视图(View)采用JSP。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3908610.html">javaweb学习总结(二十一)——JavaWeb的两种开发模式 - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/19/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AD%EF%BC%89%E2%80%94%E2%80%94JSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/19/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AD%EF%BC%89%E2%80%94%E2%80%94JSP/" class="post-title-link" itemprop="url">JavaWeb学习（六）——JSP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 16:56:26" itemprop="dateCreated datePublished" datetime="2021-09-18T16:56:26Z">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JSP简介"><a href="#JSP简介" class="headerlink" title="JSP简介"></a>JSP简介</h1><p>JSP是为了简化Servlet的工作出现的替代品，Servlet输出HTML非常困难，JSP就是替代Servlet输出HTML的。</p>
<h1 id="JSP的响应"><a href="#JSP的响应" class="headerlink" title="JSP的响应"></a>JSP的响应</h1><ul>
<li><p>浏览器第一次请求1.jsp时，Tomcat会将1.jsp转化成1_jsp.java这么一个类，并将该文件编译成class文件。编译完毕后再运行class文件来响应浏览器的请求。</p>
</li>
<li><p>以后访问1.jsp就不再重新编译jsp文件了，直接调用class文件来响应浏览器。当然了，如果Tomcat检测到JSP页面改动了的话，会重新编译的。</p>
</li>
<li><p>既然JSP是一个Servlet，那JSP页面中的HTML排版标签是怎么样被发送到浏览器的？用write()出去的。说到底，JSP就是封装了Servlet的java程序罢了。</p>
</li>
<li><p><strong>JSP比Servlet更方便更简单的一个重要原因就是：内置了9个对象！</strong>内置对象有：out、session、response、request、config、page、application、pageContext、exception</p>
</li>
</ul>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><p>JSP也是Servlet，运行时只有一个实例，<strong>JSP初始化和销毁时也会调用Servlet的init()和destroy()方法</strong>。另外，JSP还有自己初始化和销毁的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">_jspInit</span><span class="params">()</span> &#123;</span><br><span class="line">  _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();</span><br><span class="line">  _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">_jspDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><p>JSP代码分为两个部分：</p>
<ol>
<li>模板数据：HTML代码<ul>
<li>定义了网页的基本骨架————页面的结构和外观</li>
</ul>
</li>
<li>元素：JSP页面中的java代码、JSP指令和JSP标签</li>
</ol>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><ul>
<li><strong>JSP的脚本就是JSP页面中的java代码</strong>，也叫做scriptlet。<strong>JSP的脚本必须使用&lt;%%&gt;括起来，不然会被当成是模板数据的！</strong></li>
<li>JSP脚本有三种方式：<ul>
<li>&lt;%%&gt;【定义局部变量，编写语句】</li>
<li>&lt;%!%&gt;【定义类或方法，<strong>但是没人这样用！</strong>】</li>
<li>&lt;%&#x3D;%&gt;（也称之为<strong>表达式输出</strong>）【输出各种类型的变量，int、double、String、Object等】</li>
<li>表达式和变量后面不能有分号（;）</li>
<li><strong>在&lt;% %&gt;中可以定义变量、编写语句，不能定义方法。</strong></li>
</ul>
</li>
<li>如果过多地使用&lt;%%&gt;会导致代码混乱，JSP还提供了一种scriptlet标签，<strong>使用此标签和&lt;%%&gt;有相同的功能，只不过它更美观了一些</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> &lt;jsp:scriptlet&gt;</span><br><span class="line">    </span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        out.println(s);</span><br><span class="line">    </span><br><span class="line">    &lt;/jsp:scriptlet&gt;</span><br><span class="line">        </span><br><span class="line">       &lt;%--这是JSP注释--%&gt;</span><br><span class="line">    &lt;%--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;<span class="comment">//声明变量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*编写语句*/</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;i++)&#123;</span><br><span class="line">        sum+=i;</span><br><span class="line">    &#125;</span><br><span class="line">    out.println(<span class="string">&quot;&lt;h1&gt;Sum=&quot;</span>+sum+<span class="string">&quot;&lt;/h1&gt;&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">       </span><br></pre></td></tr></table></figure>

<h1 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h1><p><strong>JSP指令用来声明JSP页面的相关属性，例如编码方式、文档类型等等</strong></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="meta">%</span>@指令  属性名=<span class="string">&quot;值&quot;</span>  <span class="meta">%</span>&gt;</span><br></pre></td></tr></table></figure>

<h2 id="page指令"><a href="#page指令" class="headerlink" title="page指令"></a>page指令</h2><p>page指令可以帮助跳到提示页面或是错误页面上。为了保持程序的可读性和遵循良好的编程习惯，page指令最好是放在整个JSP页面的起始位置。</p>
<ul>
<li>我在idea生成的JSP页面就有page指令了。</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@<span class="built_in"> page </span><span class="attribute">contentType</span>=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> <span class="attribute">language</span>=<span class="string">&quot;java&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>page指令常见属性：</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page</span><br><span class="line">    [ language=<span class="string">&quot;java&quot;</span> ]</span><br><span class="line">    [ extends=<span class="string">&quot;package.class&quot;</span> ]</span><br><span class="line">    [ <span class="keyword">import</span>=<span class="string">&quot;&#123;package.class | package.*&#125;, ...&quot;</span> ]</span><br><span class="line">    [ session=<span class="string">&quot;true | false&quot;</span> ]</span><br><span class="line">    [ buffer=<span class="string">&quot;none | 8kb | sizekb&quot;</span> ]</span><br><span class="line">    [ autoFlush=<span class="string">&quot;true | false&quot;</span> ]</span><br><span class="line">    [ isThreadSafe=<span class="string">&quot;true | false&quot;</span> ]</span><br><span class="line">    [ info=<span class="string">&quot;text&quot;</span> ]</span><br><span class="line">    [ errorPage=<span class="string">&quot;relative_url&quot;</span> ]【通过page指令的errorPage属性跳转到relative_url页面】</span><br><span class="line">    [ isErrorPage=<span class="string">&quot;true | false&quot;</span> ]【设置页面是否是错误页面】</span><br><span class="line">    [ contentType=<span class="string">&quot;mimeType [ ;charset=characterSet ]&quot;</span> | <span class="string">&quot;text/html ; charset=ISO-8859-1&quot;</span> ]</span><br><span class="line">    [ pageEncoding=<span class="string">&quot;characterSet | ISO-8859-1&quot;</span> ]</span><br><span class="line">    [ isELIgnored=<span class="string">&quot;true | false&quot;</span> ]</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>一般地，在eclipse或idea这些高级开发工具上开发，<strong>我们只需要在page指令中指定contentType&#x3D;”text&#x2F;html;charset&#x3D;UTF-8”，就不会出现中文乱码问题！</strong>当然了contentType <strong>不仅仅可以指定以text&#x2F;html的方式显示，还可以使用其他的形式显示出来。在conf&#x2F;web.xml文件中可以查询出来</strong></p>
<h3 id="import属性"><a href="#import属性" class="headerlink" title="import属性"></a>import属性</h3><ul>
<li><p>可以在一条page指令的import属性中引入多个类或包，其中的每个包或类之间使用逗号(,)分隔</p>
</li>
<li><p>&#96;&#96;&#96;jsp<br> &lt;%@ page import&#x3D;”java.util.*,java.io.*,java.sql.*”%&gt;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### errorPage属性</span><br><span class="line"></span><br><span class="line">- rrorPage属性的设置值必须使用相对路径，如果以“/”开头，表示相对于当前Web应用程序的根目录(注意不是站点根目录)，否则，表示相对于当前页面</span><br><span class="line"></span><br><span class="line">- 可以在web.xml文件中使用\&lt;error-page\&gt;元素为整个Web应用程序设置错误处理页面。</span><br><span class="line"></span><br><span class="line">- \&lt;error-page\&gt;元素有3个子元素，\&lt;error-code\&gt;、\&lt;exception-type\&gt;、\&lt;location\&gt;</span><br><span class="line"></span><br><span class="line">  - \&lt;error-code\&gt;子元素指定错误的状态码，例如：\&lt;error-code\&gt;404\&lt;/error-code\&gt;</span><br><span class="line">  - \&lt;exception-type\&gt;子元素指定异常类的完全限定名，例如：\&lt;exception-type\&gt;java.lang.ArithmeticException\&lt;/exception-type\&gt;</span><br><span class="line">  - \<span class="tag">&lt;<span class="name">location</span>&gt;</span>子元素指定以“/”开头的错误处理页面的路径，例如：\&lt;location\&gt;/ErrorPage/404Error.jsp\&lt;/location\&gt;</span><br><span class="line"></span><br><span class="line">- 如果设置了某个JSP页面的errorPage属性，那么在web.xml文件中设置的错误处理将不对该页面起作用。</span><br><span class="line"></span><br><span class="line">  web.xml的代码下：</span><br><span class="line"></span><br><span class="line">  ```xml</span><br><span class="line">  <span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">&lt;!-- 针对404错误的处理页面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">location</span>&gt;</span>/ErrorPage/404Error.jsp<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>404Error.jsp代码如下：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;<span class="number">404</span>错误友好提示页面&lt;/title&gt;</span><br><span class="line">    &lt;!-- <span class="number">3</span>秒钟后自动跳转回首页 --&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;refresh&quot;</span> content=<span class="string">&quot;3;url=$&#123;pageContext.request.contextPath&#125;/index.jsp&quot;</span>&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;img alt=<span class="string">&quot;对不起，你要访问的页面没有找到，请联系管理员处理!&quot;</span></span><br><span class="line">    src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/img/404Error.png&quot;</span>/&gt;&lt;br/&gt;</span><br><span class="line">    <span class="number">3</span>秒钟后自动跳转回首页，如果没有跳转，请点击&lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/index.jsp&quot;</span>&gt;这里&lt;/a&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="include指令"><a href="#include指令" class="headerlink" title="include指令"></a>include指令</h2><p>在JSP中对于包含有两种语句形式：</p>
<ol>
<li>@include指令</li>
<li><a href="jsp:include">jsp:include</a>指令</li>
</ol>
<p><strong>include指令是静态包含</strong>。静态包含的意思就是：<strong>把文件的代码内容都包含进来，再编译！</strong></p>
<p><strong>include指令细节注意问题：</strong></p>
<ol>
<li><strong>被引入的文件必须遵循JSP语法。</strong></li>
<li><strong>被引入的文件可以使用任意的扩展名，即使其扩展名是html，JSP引擎也会按照处理jsp页面的方式处理它里面的内容，为了见明知意，JSP规范建议使用.jspf（JSP fragments(片段)）作为静态引入文件的扩展名。</strong></li>
<li><strong>由于使用include指令将会涉及到2个JSP页面，并会把2个JSP翻译成一个servlet，所以这2个JSP页面的指令不能冲突（除了pageEncoding和导包除外）。</strong></li>
</ol>
<p>在1.jsp中把页头和页尾包含进来：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;包含页头和页尾进来&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">&quot;head.jsp&quot;</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">&quot;foot.jsp&quot;</span> %&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<h2 id="taglib指令"><a href="#taglib指令" class="headerlink" title="taglib指令"></a>taglib指令</h2><p>用来说明JSP页面内使用的标签库</p>
<h1 id="行为（内置标签）"><a href="#行为（内置标签）" class="headerlink" title="行为（内置标签）"></a>行为（内置标签）</h1><blockquote>
<p><strong>JSP行为（JSP Actions）是一组JSP内置的标签</strong>，只书写少量的标记代码就能够使用JSP提供丰富的功能，<strong>JSP行为是对常用的JSP功能的抽象和封装</strong>。</p>
</blockquote>
<p>　jsp的常用标签有以下三个</p>
<ul>
<li><a href="jsp:include">jsp:include</a>标签  </li>
<li><a href="jsp:forward">jsp:forward</a>标签  </li>
<li><a href="jsp:param">jsp:param</a>标签</li>
</ul>
<h2 id="include标签"><a href="#include标签" class="headerlink" title="include标签"></a>include标签</h2><ul>
<li>include标签语法是这个样子的</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=<span class="string">&quot;relativeURL | &lt;%=expression%&gt;&quot;</span> flush=<span class="string">&quot;true|false&quot;</span> /&gt;</span><br><span class="line">　　page属性用于指定被引入资源的相对路径，它也可以通过执行一个表达式来获得。</span><br><span class="line">　　flush属性指定在插入其他资源的输出内容时，是否先将当前JSP页面的已输出的内容刷新到客户端。</span><br></pre></td></tr></table></figure>

<ul>
<li>jsp标签包含文件就是<strong>先编译被包含的页面，再将页面的结果写入到包含的页面中</strong>————属于动态包含</li>
</ul>
<h3 id="include标签和include指令的区别"><a href="#include标签和include指令的区别" class="headerlink" title="include标签和include指令的区别"></a>include标签和include指令的区别</h3><p>&lt;jsp:include&gt;标签是动态引入， &lt;jsp:include&gt;标签涉及到的2个JSP页面会被翻译成2个servlet，这2个servlet的内容在执行时进行合并。<br>　　而include指令是静态引入，涉及到的2个JSP页面会被翻译成一个servlet，其内容是在源文件级别进行合并。</p>
<h2 id="param标签"><a href="#param标签" class="headerlink" title="param标签"></a>param标签</h2><ul>
<li>当使用&lt;jsp:include&gt;和&lt;jsp:forward&gt;标签引入或将请求转发给其它资源时，可以使用&lt;jsp:param&gt;标签向这个资源传递参数。</li>
</ul>
<h2 id="forward标签"><a href="#forward标签" class="headerlink" title="forward标签"></a>forward标签</h2><p>&lt;jsp:forward&gt;标签用于把请求转发给另外一个资源。</p>
<ul>
<li><p>forward标签就是对request.getRequestDispatcher(String url).forward(request,response)的封装</p>
</li>
<li><p>语法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  　&lt;jsp:forward page=<span class="string">&quot;relativeURL | &lt;%=expression%&gt;&quot;</span> /&gt;</span><br><span class="line">  　　page属性用于指定请求转发到的资源的相对路径，它也可以通过执行一个表达式来获得。</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="directive标签"><a href="#directive标签" class="headerlink" title="directive标签"></a>directive标签</h2><ul>
<li><strong>directive的中文意思就是指令</strong>。<strong>该行为就是替代指令&lt;%@%&gt;的语法的</strong><ul>
<li>&lt;jsp:directive.include file&#x3D;””&#x2F;&gt; 相当于&lt;%@include file&#x3D;”” %&gt;</li>
<li>&lt;jsp:directive.page&#x2F;&gt; 相当于&lt;%@page %&gt;</li>
<li>&lt;jsp:directive.taglib&#x2F;&gt; 相当于&lt;%@taglib %&gt;</li>
</ul>
</li>
</ul>
<h1 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h1><p>每个JSP 页面在第一次被访问时，WEB容器都会把请求交给JSP引擎（即一个Java程序）去处理。JSP引擎先将JSP翻译成一个_jspServlet(实质上也是一个servlet) ，然后按照servlet的调用方式进行调用。<br>　　由于JSP第一次访问时会翻译成servlet，所以第一次访问通常会比较慢，但第二次访问，JSP引擎如果发现JSP没有变化，就不再翻译，而是直接调用，所以程序的执行效率不会受到影响。<br>　　JSP引擎在调用JSP对应的_jspServlet时，会传递或创建9个与web开发相关的对象供_jspServlet使用。JSP技术的设计者为便于开发人员在编写JSP页面时获得这些web对象的引用，特意定义了9个相应的变量，开发人员在JSP页面中通过这些变量就可以快速获得这9大对象的引用。</p>
<p>九个内置对象：</p>
<table>
<thead>
<tr>
<th>NO.</th>
<th>内置对象</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><strong>pageContext</strong></td>
<td><strong>javax.servlet.jsp.PageContext</strong></td>
</tr>
<tr>
<td>2</td>
<td><strong>request</strong></td>
<td><strong>javax.servlet.http.HttpServletRequest</strong></td>
</tr>
<tr>
<td>3</td>
<td><strong>response</strong></td>
<td><strong>javax.servlet.http.HttpServletResponse</strong></td>
</tr>
<tr>
<td>4</td>
<td><strong>session</strong></td>
<td><strong>javax.servlet.http.HttpSession</strong></td>
</tr>
<tr>
<td>5</td>
<td><strong>application</strong></td>
<td><strong>javax.servlet.ServletContext</strong></td>
</tr>
<tr>
<td>6</td>
<td><strong>config</strong></td>
<td><strong>javax.servlet.ServletConfig</strong></td>
</tr>
<tr>
<td>7</td>
<td>out</td>
<td>javax.servlet.jsp.JspWriter</td>
</tr>
<tr>
<td>8</td>
<td>page</td>
<td>java.lang.Object</td>
</tr>
<tr>
<td>9</td>
<td>exception</td>
<td>java.lang.Throwable</td>
</tr>
</tbody></table>
<p>————无需定义，即可直接使用</p>
<h2 id="out对象"><a href="#out对象" class="headerlink" title="out对象"></a>out对象</h2><p>out对象的API</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">getBufferSize</span><span class="params">()</span>【得到缓存大小】</span><br><span class="line"><span class="type">int</span> <span class="title function_">getRemaining</span><span class="params">()</span>【得到未使用缓存的大小】</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isAutoFlush</span><span class="params">()</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">println</span><span class="params">()</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">flush</span><span class="params">()</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">clearBuffer</span><span class="params">()</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span></span><br></pre></td></tr></table></figure>

<p>out对象用于向客户端发送文本数据。</p>
<p>out对象是通过调用pageContext对象的getOut方法返回的，其作用和用法与ServletResponse.getWriter方法返回的PrintWriter对象非常相似。</p>
<p>JSP页面中的out对象的类型为JspWriter，JspWriter相当于一种带缓存功能的PrintWriter，设置JSP页面的page指令的buffer属性可以调整它的缓存大小，甚至关闭它的缓存。</p>
<p>只有向out对象中写入了内容，且满足如下任何一个条件时，out对象才去调用ServletResponse.getWriter方法，并通过该方法返回的PrintWriter对象将out对象的缓冲区中的内容真正写入到Servlet引擎提供的缓冲区中：</p>
<ul>
<li>设置page指令的buffer属性关闭了out对象的缓存功能</li>
<li>out对象的缓冲区已满</li>
<li>整个JSP页面结束</li>
</ul>
<p>out对象的原理如下：</p>
<p><img src="https://i.loli.net/2021/09/18/KCdBurWOV2yUlIe.png"></p>
<ul>
<li>只有向out对象中写入了内容，且<strong>满足如下任何一个条件时，out对象才去调用ServletResponse.getWriter方法</strong>，并<strong>通过该方法返回的PrintWriter对象将out对象的缓冲区中的内容真正写入到Servlet引擎提供的缓冲区中</strong>：<ul>
<li><strong>设置page指令的buffer属性关闭了out对象的缓存功能</strong></li>
<li><strong>out对象的缓冲区已满</strong></li>
<li><strong>整个JSP页面结束</strong></li>
</ul>
</li>
<li><strong>一般我们在JSP页面输出都是用表达式（&lt;%&#x3D;%&gt;)，所以out对象用得并不是很多</strong>！</li>
</ul>
<h2 id="page对象"><a href="#page对象" class="headerlink" title="page对象"></a>page对象</h2><p>内置对象page是HttpJasPage对象，<strong>其实page对象代表的就是当前JSP页面，是当前JSP编译后的Servlet类的对象</strong>。也就是说：<strong>page对象相当于普通java类的this</strong></p>
<p>在开发中几乎不用</p>
<h2 id="exception对象"><a href="#exception对象" class="headerlink" title="exception对象"></a>exception对象</h2><ul>
<li><strong>内置对象exception是java.lang.Exception类的对象，exception封装了JSP页面抛出的异常信息。</strong>exception经常被用来处理错误页面</li>
</ul>
<h2 id="pageContext对象"><a href="#pageContext对象" class="headerlink" title="pageContext对象"></a>pageContext对象</h2><p><strong>pageContext是内置对象中最重要的一个对象，它代表着JSP页面编译后的内容（也就是JSP页面的运行环境）！</strong></p>
<h3 id="pageContext获取8个内置对象"><a href="#pageContext获取8个内置对象" class="headerlink" title="pageContext获取8个内置对象"></a>pageContext获取8个内置对象</h3><p>既然它代表了JSP页面编译后的内容，理所当然的：<strong>它封装了对其他8大内置对象的引用！</strong>，也就是说，<strong>通过pageContext可以获取到其他的8个内置对象！</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;获取八大内置对象&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    System.out.println(pageContext.getSession());</span><br><span class="line">    System.out.println(pageContext.getRequest());</span><br><span class="line">    System.out.println(pageContext.getResponse());</span><br><span class="line"></span><br><span class="line">    System.out.println(pageContext.getException());</span><br><span class="line"></span><br><span class="line">    System.out.println(pageContext.getPage());</span><br><span class="line">    System.out.println(pageContext.getServletConfig());</span><br><span class="line">    System.out.println(pageContext.getServletContext());</span><br><span class="line">    System.out.println(pageContext.getOut());</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="pageContext作为域对象"><a href="#pageContext作为域对象" class="headerlink" title="pageContext作为域对象"></a>pageContext作为域对象</h3><p>类似于request，session，ServletContext作为域对象而言<strong>都有以下三个方法</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、setAttribute(String name,Objcet o)</span><br><span class="line"><span class="number">2</span>、getAttribute(String name)</span><br><span class="line"><span class="number">3</span>、removeAttribute(String name)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>当然了，pageContext也不例外，<strong>pageContext也有这三个方法</strong>！</p>
<p>pageContext本质上代表的是当前JSP页面编译后的内容，<strong>作为域对象而言，它就代表着当前JSP页面（也就是page）</strong>！也就是说：<strong>pageContext域对象只在page范围内有效，超出了page范围就无效了</strong>！</p>
<p>findAttribute(String name)方法介绍：</p>
<p>该方法是用于查找各个域中的属性的。当要查找某个属性时，findAttribute方法按照查找顺序”page→request→session→application”在这四个对象中去查找，只要找到了就返回属性值，如果四个对象都没有找到要查找的属性，则返回一个null。</p>
<p>pageContext对象中封装了访问其它域的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">public</span> java.lang.Object <span class="title function_">getAttribute</span><span class="params">(java.lang.String name,<span class="type">int</span> scope)</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAttribute</span><span class="params">(java.lang.String name, java.lang.Object value,<span class="type">int</span> scope)</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeAttribute</span><span class="params">(java.lang.String name,<span class="type">int</span> scope)</span></span><br></pre></td></tr></table></figure>

<p>代表各个域的常量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> PageContext.APPLICATION_SCOPE</span><br><span class="line"><span class="number">2</span> PageContext.SESSION_SCOPE</span><br><span class="line"><span class="number">3</span> PageContext.REQUEST_SCOPE</span><br><span class="line"><span class="number">4</span> PageContext.PAGE_SCOPE </span><br></pre></td></tr></table></figure>

<h3 id="PageContext引入和跳转到其他资源"><a href="#PageContext引入和跳转到其他资源" class="headerlink" title="PageContext引入和跳转到其他资源"></a>PageContext引入和跳转到其他资源</h3><p>PageContext类中定义了一个forward方法(用来跳转页面)和两个include方法(用来引入页面)来分别简化和替代RequestDispatcher.forward方法和include方法。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;使用pageContext的forward方法跳转页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//使用pageContext的forward方法跳转到pageContextDemo05.jsp页面，/代表了当前的web应用</span></span><br><span class="line">    pageContext.forward(<span class="string">&quot;/pageContextDemo05.jsp&quot;</span>);</span><br><span class="line">    <span class="comment">//使用pageContext.forward(relativeUrlPath)替代RequestDispatcher.forward(relativeUrlPath)</span></span><br><span class="line">    <span class="comment">//使用RequestDispatcher的forward方法实现的跳转方式</span></span><br><span class="line">    <span class="comment">//pageContext.getRequest().getRequestDispatcher(&quot;/pageContextDemo05.jsp&quot;).forward(request, response);</span></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>使用include方法引入资源：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;使用pageContext的include方法引入资源&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    pageContext.include(<span class="string">&quot;/jspfragments/head.jsp&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">    使用pageContext的include方法引入资源</span><br><span class="line">&lt;%</span><br><span class="line">    pageContext.include(<span class="string">&quot;/jspfragments/foot.jsp&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;hr/&gt;</span><br><span class="line">&lt;%--</span><br><span class="line">&lt;jsp:include page=<span class="string">&quot;/jspfragments/head.jsp&quot;</span>/&gt;</span><br><span class="line">使用jsp:include标签引入资源</span><br><span class="line">&lt;jsp:include page=<span class="string">&quot;/jspfragments/foot.jsp&quot;</span>/&gt;</span><br><span class="line">--%&gt;</span><br></pre></td></tr></table></figure>

<h2 id="其他对象"><a href="#其他对象" class="headerlink" title="其他对象"></a>其他对象</h2><p>request对象</p>
<ul>
<li><strong>内置对象request其实就是HttpServletRequest</strong></li>
</ul>
<p>response对象</p>
<ul>
<li><strong>内置对象response其实就是HttpServletResponse</strong></li>
</ul>
<p>config对象</p>
<ul>
<li><strong>内置对象config其实就是ServletConfig</strong></li>
</ul>
<p>session对象</p>
<ul>
<li><strong>内置对象session其实就是HttpSession。</strong></li>
</ul>
<p>注意：<strong>在page指令配置如下信息，session将不可使用</strong></p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page session=<span class="string">&quot;false&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>application对象</p>
<ul>
<li><strong>内置对象application其实就是ServletContext对象</strong></li>
</ul>
<h1 id="四种属性范围"><a href="#四种属性范围" class="headerlink" title="四种属性范围"></a>四种属性范围</h1><ol>
<li><strong>page【只在一个页面中保存属性，跳转页面无效】</strong></li>
<li><strong>request【只在一次请求中保存属性，服务器跳转有效，浏览器跳转无效】</strong></li>
<li><strong>session【在一个会话范围中保存属性，无论何种跳转均有效，关闭浏览器后无效】</strong></li>
<li><strong>application【在整个服务器中保存，所有用户都可以使用】</strong></li>
</ol>
<p>4个内置对象都支持以下的方法：</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>public void setAttribute(String name,Object value)</td>
<td>设置属性</td>
</tr>
<tr>
<td>2</td>
<td>public object getAttribute(String name)</td>
<td>取得属性</td>
</tr>
<tr>
<td>3</td>
<td>public void removeAttribute(String name)</td>
<td>删除属性</td>
</tr>
</tbody></table>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p>　1、request：如果客户向服务器发请求，产生的数据，用户看完就没用了，像这样的数据就存在request域,像新闻数据，属于用户看完就没用的。<br>　　2、session：如果客户向服务器发请求，产生的数据，用户用完了等一会儿还有用，像这样的数据就存在session域中，像购物数据，用户需要看到自己购物信息，并且等一会儿，还要用这个购物数据结帐。<br>　　3、application(servletContext)：如果客户向服务器发请求，产生的数据，用户用完了，还要给其它用户用，像这样的数据就存在application(servletContext)域中，像聊天数据。</p>
<h1 id="JavaBean"><a href="#JavaBean" class="headerlink" title="JavaBean"></a>JavaBean</h1><p>JavaBean遵循着特定的写法，通常有以下的规则：</p>
<ul>
<li><strong>有无参的构造函数</strong></li>
<li><strong>成员属性私有化</strong></li>
<li><strong>封装的属性如果需要被外所操作，必须编写public类型的setter、getter方法</strong></li>
</ul>
<p>————就是普通的java类。</p>
<h2 id="在jsp中使用javabean"><a href="#在jsp中使用javabean" class="headerlink" title="在jsp中使用javabean"></a>在jsp中使用javabean</h2><ul>
<li>&lt;jsp:useBean&gt;【在JSP页面中查找javaBean对象或者实例化javaBean对象】</li>
<li>&lt;jsp:setProperty&gt;【设置javaBean的属性】</li>
<li>&lt;jsp:getProperty&gt;【获取javaBean的属性】</li>
</ul>
<h3 id="jsp-useBean"><a href="#jsp-useBean" class="headerlink" title="jsp:useBean"></a>jsp:useBean</h3><ul>
<li><p><code>&lt;jsp:useBean&gt;</code>标签用于<strong>在指定的域范围内查找指定名称的JavaBean对象</strong>：</p>
<ul>
<li><strong>存在则直接返回该JavaBean对象的引用</strong>。</li>
<li><strong>不存在则实例化一个新的JavaBean对象并将它以指定的名称存储到指定的域范围中</strong>。</li>
</ul>
</li>
<li><p>语法：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:useBean id=<span class="string">&quot;beanName&quot;</span> class=<span class="string">&quot;package.class&quot;</span> scope=<span class="string">&quot;page|request|session|application&quot;</span>/&gt;</span><br><span class="line">　　<span class="string">&quot;id&quot;</span>属性用于指定JavaBean实例对象的引用名称和其存储在域范围中的名称。</span><br><span class="line">　　<span class="string">&quot;class&quot;</span>属性用于指定JavaBean的完整类名（即必须带有包名）。</span><br><span class="line">　　<span class="string">&quot;scope&quot;</span>属性用于指定JavaBean实例对象所存储的域范围，其取值只能是page、request、session和application等四个值中的一个，其默认值是page。</span><br></pre></td></tr></table></figure>

<ul>
<li><p>示例：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">如果JSP不支持`&lt;jsp:useBean&gt;`这个行为，我们要使用Person类是这样使用的：</span><br><span class="line">&lt;%--这里需要导入Person类--%&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;domain.Person&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//new出对象</span></span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line">    person.setName(<span class="string">&quot;zhongfucheng&quot;</span>);</span><br><span class="line">    System.out.println(person.getName());</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">    使用&lt;jsp:useBean&gt;：</span><br><span class="line">      &lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">    &lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;jsp:useBean id=<span class="string">&quot;person&quot;</span> class=<span class="string">&quot;domain.Person&quot;</span> scope=<span class="string">&quot;page&quot;</span>/&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        person.setName(<span class="string">&quot;zhongfucheng&quot;</span>);</span><br><span class="line">        System.out.println(person.getName());</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="jsp-setProperty"><a href="#jsp-setProperty" class="headerlink" title="jsp:setProperty"></a>jsp:setProperty</h3><ul>
<li>语法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:setProerty name=<span class="string">&quot;对象名称&quot;</span> property=<span class="string">&quot;属性名&quot;</span> param=<span class="string">&quot;参数名&quot;</span> value=<span class="string">&quot;值&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在语法上可分为4种模式</p>
<ul>
<li>&lt;jsp:setProperty name&#x3D;”对象名称” property&#x3D;”*“&#x2F;&gt;自动匹配</li>
<li>&lt;jsp:setProperty name&#x3D;”对象名称” property&#x3D;”属性名称”&#x2F;&gt;指定属性</li>
<li>&lt;jsp:setProperty name&#x3D;”对象名称” property&#x3D;”属性名称” param&#x3D;”参数名称”&#x2F;&gt;指定参数【很少用】</li>
<li>&lt;jsp:setProperty name&#x3D;”对象名称” property&#x3D;”属性名称” value&#x3D;”内容”&#x2F;&gt;指定内容【很少用】</li>
</ul>
</li>
<li><p>当我们没有学习到<code>&lt;jsp:setProperty&gt;</code>时，我们获取表单的信息，然后导入到javaBean对象中是这样的一种情况：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表单页面代码：</span></span><br><span class="line"></span><br><span class="line">    &lt;form action=<span class="string">&quot;/zhongfucheng/1.jsp&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">        年龄：&lt;input type=<span class="string">&quot;text &quot;</span> name=<span class="string">&quot;age&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//处理表单提交过来数据的jsp的代码：</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;jsp:useBean id=<span class="string">&quot;person&quot;</span> class=<span class="string">&quot;domain.Person&quot;</span> scope=<span class="string">&quot;page&quot;</span>/&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        person.setAge(age);</span><br><span class="line">    </span><br><span class="line">        System.out.println(person.getAge());</span><br><span class="line">        </span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用&lt;jsp:setProperty&gt;：</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;jsp:useBean id=<span class="string">&quot;person&quot;</span> class=<span class="string">&quot;domain.Person&quot;</span> scope=<span class="string">&quot;page&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%--指定属性名称为age--%&gt;</span><br><span class="line">    &lt;jsp:setProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;age&quot;</span>/&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        System.out.println(person.getAge());</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="jsp-getProperty"><a href="#jsp-getProperty" class="headerlink" title="jsp:getProperty"></a>jsp:getProperty</h3><p>&lt;jsp:getProperty&gt;标签用于读取JavaBean对象的属性，也就是调用JavaBean对象的getter方法，然后将读取的属性值转换成字符串后插入进输出的响应正文中。</p>
<ul>
<li><p>语法：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:getProperty name=<span class="string">&quot;对象名&quot;</span> property=<span class="string">&quot;属性名&quot;</span>/&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="EL表法式"><a href="#EL表法式" class="headerlink" title="EL表法式"></a>EL表法式</h1><p>主要用于读取数据，进行内容的显示。</p>
<p>语法：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;标识符&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>EL表达式如果找不到相应的对象属性，返回的的空白字符串“”，而不是null，这是EL表达式最大的特点</strong>。</p>
<h2 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h2><p>EL表达式语句在执行时，会调用pageContext.findAttribute方法，用标识符为关键字，分别从page、request、session、application四个域中查找相应的对象，找到则返回相应对象，找不到则返回”” （注意，不是null，而是空字符串）。</p>
<p>　　EL表达式可以很轻松获取JavaBean的属性，或获取数组、Collection、Map类型集合的数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;</span><br><span class="line">&lt;%@page import=&quot;me.gacl.domain.Person&quot;%&gt;</span><br><span class="line">&lt;%@page import=&quot;me.gacl.domain.Address&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>el表达式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        request.setAttribute(&quot;name&quot;,&quot;孤傲苍狼&quot;);</span><br><span class="line">    %&gt;</span><br><span class="line">        &lt;%--$&#123;name&#125;等同于pageContext.findAttribute(&quot;name&quot;) --%&gt;</span><br><span class="line">        使用EL表达式获取数据：$&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在jsp页面中，使用el表达式可以获取bean的属性 --&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        Person p = new Person();</span><br><span class="line">        p.setAge(12);</span><br><span class="line">        request.setAttribute(&quot;person&quot;,p);</span><br><span class="line">    %&gt;</span><br><span class="line">        使用el表达式可以获取bean的属性：$&#123;person.age&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在jsp页面中，使用el表达式可以获取bean中的。。。。。。。。。的属性 --&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        Person person = new Person();</span><br><span class="line">        Address address = new Address();</span><br><span class="line">        person.setAddress(address);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(&quot;person&quot;,person);</span><br><span class="line">    %&gt;</span><br><span class="line">       $&#123;person.address.name&#125;</span><br><span class="line">     <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在jsp页面中，使用el表达式获取list集合中指定位置的数据 --&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        Person p1 = new Person();</span><br><span class="line">        p1.setName(&quot;孤傲苍狼&quot;);</span><br><span class="line"></span><br><span class="line">        Person p2 = new Person();</span><br><span class="line">        p2.setName(&quot;白虎神皇&quot;);</span><br><span class="line"></span><br><span class="line">        List<span class="tag">&lt;<span class="name">Person</span>&gt;</span> list = new ArrayList<span class="tag">&lt;<span class="name">Person</span>&gt;</span>();</span><br><span class="line">        list.add(p1);</span><br><span class="line">        list.add(p2);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(&quot;list&quot;,list);</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 取list指定位置的数据 --&gt;</span></span><br><span class="line">    $&#123;list[1].name&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 迭代List集合 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">var</span>=<span class="string">&quot;person&quot;</span> <span class="attr">items</span>=<span class="string">&quot;$&#123;list&#125;&quot;</span>&gt;</span></span><br><span class="line">        $&#123;person.name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在jsp页面中，使用el表达式获取map集合的数据 --&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        Map&lt;String,String&gt; map = new LinkedHashMap&lt;String,String&gt;();</span><br><span class="line">        map.put(&quot;a&quot;,&quot;aaaaxxx&quot;);</span><br><span class="line">        map.put(&quot;b&quot;,&quot;bbbb&quot;);</span><br><span class="line">        map.put(&quot;c&quot;,&quot;cccc&quot;);</span><br><span class="line">        map.put(&quot;1&quot;,&quot;aaaa1111&quot;);</span><br><span class="line">        request.setAttribute(&quot;map&quot;,map);</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 根据关键字取map集合的数据 --&gt;</span></span><br><span class="line">      $&#123;map.c&#125;</span><br><span class="line">      $&#123;map[&quot;1&quot;]&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 迭代Map集合 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">var</span>=<span class="string">&quot;me&quot;</span> <span class="attr">items</span>=<span class="string">&quot;$&#123;map&#125;&quot;</span>&gt;</span></span><br><span class="line">          $&#123;me.key&#125;=$&#123;me.value&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="执行运算"><a href="#执行运算" class="headerlink" title="执行运算"></a>执行运算</h2><p>支持关系运算符和逻辑运算符。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"> &lt;%@taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;</span><br><span class="line">  &lt;%@page import=&quot;me.gacl.domain.User&quot;%&gt;</span><br><span class="line"> <span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">title</span>&gt;</span>el表达式运算符<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>el表达式进行四则运算：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        加法运算：$&#123;365+24&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        减法运算：$&#123;365-24&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        乘法运算：$&#123;365*24&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        除法运算：$&#123;365/24&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>el表达式进行关系运算：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    &lt;%--$&#123;user == null&#125;和 $&#123;user eq null&#125;两种写法等价--%&gt;</span><br><span class="line">        $&#123;user == null&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        $&#123;user eq null&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>el表达式使用empty运算符检查对象是否为null(空)<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    &lt;% </span><br><span class="line">        </span><br><span class="line">        List<span class="tag">&lt;<span class="name">String</span>&gt;</span> list = new ArrayList<span class="tag">&lt;<span class="name">String</span>&gt;</span>();</span><br><span class="line">        list.add(&quot;gacl&quot;);</span><br><span class="line">        list.add(&quot;xdp&quot;);</span><br><span class="line">        request.setAttribute(&quot;list&quot;,list);</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;%--使用empty运算符检查对象是否为null(空) --%&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;!empty(list)&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">var</span>=<span class="string">&quot;str&quot;</span> <span class="attr">items</span>=<span class="string">&quot;$&#123;list&#125;&quot;</span>&gt;</span></span><br><span class="line">            $&#123;str&#125;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">        List<span class="tag">&lt;<span class="name">String</span>&gt;</span> emptyList = null;</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;%--使用empty运算符检查对象是否为null(空) --%&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;empty(emptyList)&#125;&quot;</span>&gt;</span></span><br><span class="line">        对不起，没有您想看的数据</span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>EL表达式中使用二元表达式<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    &lt;% </span><br><span class="line">        session.setAttribute(&quot;user&quot;,new User(&quot;孤傲苍狼&quot;));</span><br><span class="line">   %&gt;</span><br><span class="line">    $&#123;user==null? &quot;对不起，您没有登陆 &quot; : user.username&#125;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>EL表达式数据回显<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    &lt;% </span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setGender(&quot;male&quot;);</span><br><span class="line">        //数据回显</span><br><span class="line">        request.setAttribute(&quot;user&quot;,user);</span><br><span class="line">    %&gt;</span><br><span class="line">       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span> $&#123;<span class="attr">user.gender</span>==<span class="string">&#x27;male&#x27;</span>?&#x27;<span class="attr">checked</span>&#x27;<span class="attr">:</span>&#x27;&#x27;&#125;&gt;</span>男</span><br><span class="line">       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;female&quot;</span> $&#123;<span class="attr">user.gender</span>==<span class="string">&#x27;female&#x27;</span>?&#x27;<span class="attr">checked</span>&#x27;<span class="attr">:</span>&#x27;&#x27;&#125;&gt;</span>女</span><br><span class="line">   <span class="tag">&lt;<span class="name">br</span>/&gt;</span>65   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="EL表达式11个内置对象"><a href="#EL表达式11个内置对象" class="headerlink" title="EL表达式11个内置对象"></a>EL表达式11个内置对象</h2><p>EL表达式主要是来对内容的显示，为了显示的方便，EL表达式提供了11个内置对象。</p>
<ol>
<li>pageContext 对应于JSP页面中的pageContext对象（注意：取的是pageContext对象）</li>
<li>pageScope 代表page域中用于保存属性的Map对象</li>
<li>requestScope 代表request域中用于保存属性的Map对象</li>
<li>sessionScope 代表session域中用于保存属性的Map对象</li>
<li>applicationScope 代表application域中用于保存属性的Map对象</li>
<li>param 表示一个保存了所有请求参数的Map对象</li>
<li>paramValues表示一个保存了所有请求参数的Map对象，它对于某个请求参数，返回的是一个string[]</li>
<li>header 表示一个保存了所有http请求头字段的Map对象</li>
<li>headerValues同上，返回string[]数组。</li>
<li>cookie 表示一个保存了所有cookie的Map对象</li>
<li>initParam 表示一个保存了所有web应用初始化参数的map对象</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--pageContext内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;pageContext1&quot;</span>, <span class="string">&quot;pageContext&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">pageContext内置对象：$&#123;pageContext.getAttribute(<span class="string">&quot;pageContext1&quot;</span>)&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--pageScope内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;pageScope1&quot;</span>,<span class="string">&quot;pageScope&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">pageScope内置对象:$&#123;pageScope.pageScope1&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--requestScope内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    request.setAttribute(<span class="string">&quot;request1&quot;</span>,<span class="string">&quot;reqeust&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">requestScope内置对象:$&#123;requestScope.request1&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--sessionScope内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    session.setAttribute(<span class="string">&quot;session1&quot;</span>, <span class="string">&quot;session&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">sessionScope内置对象：$&#123;sessionScope.session1&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--applicationScope内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    application.setAttribute(<span class="string">&quot;application1&quot;</span>,<span class="string">&quot;application&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">applicationScopt内置对象：$&#123;applicationScope.application1&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--header内置对象--%&gt;</span><br><span class="line">header内置对象：$&#123;header.Host&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--headerValues内置对象,取出第一个Cookie--%&gt;</span><br><span class="line">headerValues内置对象：$&#123;headerValues.Cookie[<span class="number">0</span>]&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%--Cookie内置对象--%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;Cookie1&quot;</span>, <span class="string">&quot;cookie&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">Cookie内置对象：$&#123;cookie.JSESSIONID.value&#125;</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--initParam内置对象，需要为该Context配置参数才能看出效果【jsp配置的无效！亲测】--%&gt;</span><br><span class="line"></span><br><span class="line">initParam内置对象:$&#123;initParam.name&#125;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="自定义标签"><a href="#自定义标签" class="headerlink" title="自定义标签"></a>自定义标签</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E2%80%94%E2%80%94%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E2%80%94%E2%80%94%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">JavaWeb学习（（六）——会话技术</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 14:19:13" itemprop="dateCreated datePublished" datetime="2021-09-18T14:19:13Z">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="会话技术"><a href="#会话技术" class="headerlink" title="会话技术"></a>会话技术</h1><blockquote>
<p>基本概念: 指用户开一个浏览器，<strong>访问一个网站,只要不关闭该浏览器，不管该用户点击多少个超链接，访问多少资源，直到用户关闭浏览器，整个这个过程我们称为一次会话</strong>.</p>
</blockquote>
<h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><blockquote>
<p>Cookie是由W3C组织提出，最早由netscape社区发展的一种机制</p>
</blockquote>
<ul>
<li>Cookie的流程：浏览器访问服务器，<strong>如果服务器需要记录该用户的状态，就使用response向浏览器发送一个Cookie，浏览器会把Cookie保存起来。当浏览器再次访问服务器的时候，浏览器会把请求的网址连同Cookie一同交给服务器</strong>。</li>
</ul>
<h3 id="Cookie-API"><a href="#Cookie-API" class="headerlink" title="Cookie API"></a>Cookie API</h3><p>　Java中的javax.servlet.http.Cookie类用于创建一个Cookie</p>
<table>
<thead>
<tr>
<th>Cookie类的主要方法</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>No.</td>
<td>方法</td>
<td>类型</td>
<td>描述</td>
</tr>
<tr>
<td>1</td>
<td>[Cookie](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3803033.html#Cookie">https://www.cnblogs.com/xdp-gacl/p/3803033.html#Cookie</a>(java.lang.String, java.lang.String))(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> name, <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> value)</td>
<td>构造方法</td>
<td>实例化Cookie对象，传入cooke名称和cookie的值</td>
</tr>
<tr>
<td>2</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getName()</td>
<td>普通方法</td>
<td>取得Cookie的名字</td>
</tr>
<tr>
<td>3</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getValue()</td>
<td>普通方法</td>
<td>取得Cookie的值</td>
</tr>
<tr>
<td>4</td>
<td>public void setValue(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> newValue)</td>
<td>普通方法</td>
<td>设置Cookie的值</td>
</tr>
<tr>
<td>5</td>
<td>public void setMaxAge(int expiry)</td>
<td>普通方法</td>
<td>设置Cookie的最大保存时间，即cookie的有效期，当服务器给浏览器回送一个cookie时，如果在服务器端没有调用setMaxAge方法设置cookie的有效期，那么cookie的有效期只在一次会话过程中有效，<strong>用户开一个浏览器，点击多个超链接，访问服务器多个web资源，然后关闭浏览器，整个过程称之为一次会话</strong>，当用户关闭浏览器，会话就结束了，此时cookie就会失效，如果在服务器端使用setMaxAge方法设置了cookie的有效期，比如设置了30分钟，那么当服务器把cookie发送给浏览器时，此时cookie就会在客户端的硬盘上存储30分钟，在30分钟内，即使浏览器关了，cookie依然存在，在30分钟内，打开浏览器访问服务器时，浏览器都会把cookie一起带上，这样就可以在服务器端获取到客户端浏览器传递过来的cookie里面的信息了，这就是cookie设置maxAge和不设置maxAge的区别，不设置maxAge，那么cookie就只在一次会话中有效，一旦用户关闭了浏览器，那么cookie就没有了，那么浏览器是怎么做到这一点的呢，我们启动一个浏览器，就相当于启动一个应用程序，而服务器回送的cookie首先是存在浏览器的缓存中的，当浏览器关闭时，浏览器的缓存自然就没有了，所以存储在缓存中的cookie自然就被清掉了，而如果设置了cookie的有效期，那么浏览器在关闭时，就会把缓存中的cookie写到硬盘上存储起来，这样cookie就能够一直存在了。</td>
</tr>
<tr>
<td>6</td>
<td>public int getMaxAge()</td>
<td>普通方法</td>
<td>获取Cookies的有效期</td>
</tr>
<tr>
<td>7</td>
<td>public void setPath(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> uri)</td>
<td>普通方法</td>
<td>设置cookie的有效路径，比如把cookie的有效路径设置为”&#x2F;xdp”，那么浏览器访问”xdp”目录下的web资源时，都会带上cookie，再比如把cookie的有效路径设置为”&#x2F;xdp&#x2F;gacl”，那么浏览器只有在访问”xdp”目录下的”gacl”这个目录里面的web资源时才会带上cookie一起访问，而当访问”xdp”目录下的web资源时，浏览器是不带cookie的</td>
</tr>
<tr>
<td>8</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getPath()</td>
<td>普通方法</td>
<td>获取cookie的有效路径</td>
</tr>
<tr>
<td>9</td>
<td>public void setDomain(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> pattern)</td>
<td>普通方法</td>
<td>设置cookie的有效域</td>
</tr>
<tr>
<td>10</td>
<td>public String getDomain()</td>
<td>普通方法</td>
<td>获取cookie的有效域</td>
</tr>
</tbody></table>
<p>　　response接口也中定义了一个addCookie方法，它用于在其响应头中增加一个相应的Set-Cookie头字段。 同样，request接口中也定义了一个getCookies方法，它用于获取客户端提交的Cookie。</p>
<ul>
<li>Cookie类用于创建一个Cookie对象</li>
<li>response接口中定义了一个addCookie方法，它用于在其响应头中增加一个相应的Set-Cookie头字段</li>
<li>request接口中定义了一个getCookies方法，它用于获取客户端提交的Cookie</li>
</ul>
<h3 id="简单使用Cookie"><a href="#简单使用Cookie" class="headerlink" title="简单使用Cookie"></a>简单使用Cookie</h3><ul>
<li>创建Cookie对象，发送Cookie给浏览器、</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置response的编码</span></span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建Cookie对象，指定名称和值</span></span><br><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;zhongfucheng&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//向浏览器给一个Cookie</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">response.getWriter().write(<span class="string">&quot;我已经向浏览器发送了一个Cookie&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置Cookie的时间</span></span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>保存中文</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="type">PrintWriter</span> <span class="variable">printWriter</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">  </span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;中国&quot;</span>;</span><br><span class="line">     </span><br><span class="line">  <span class="comment">//对Unicode字符进行编码</span></span><br><span class="line">  <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;country&quot;</span>, URLEncoder.encode(name, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">cookie.setMaxAge(<span class="number">2000</span>);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">  </span><br><span class="line">printWriter.write(<span class="string">&quot;我颁发了一个Cookie，值保存的是中文数据&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>我们发现Cookie保存在硬盘的中文数据是经过编码的，那么我们在<strong>取出Cookie的时候要对中文数据进行解码</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cookies[i].getName();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//经过URLEncoding就要URLDecoding</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> URLDecoder.decode(cookies[i].getValue(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    printWriter.write(name + <span class="string">&quot;------&quot;</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Cookie不可跨域名性"><a href="#Cookie不可跨域名性" class="headerlink" title="Cookie不可跨域名性"></a>Cookie不可跨域名性</h3><p>Cookie具有不可跨域名性。浏览器判断<strong>一个网站是否能操作另一个网站的Cookie的依据是域名</strong>。所以一般来说，<strong>当我访问baidu的时候，浏览器只会把baidu颁发的Cookie带过去，而不会带上google的Cookie。</strong></p>
<h3 id="Cookie的有效期"><a href="#Cookie的有效期" class="headerlink" title="Cookie的有效期"></a>Cookie的有效期</h3><p><strong>Cookie的有效期是通过setMaxAge()来设置的</strong>。</p>
<ul>
<li>如果MaxAge为<strong>正数</strong>，<strong>浏览器会把Cookie写到硬盘中，只要还在MaxAge秒之前，登陆网站时该Cookie就有效</strong>【不论关闭了浏览器还是电脑】</li>
<li>如果MaxAge为<strong>负数</strong>，<strong>Cookie是临时性的，仅在本浏览器内有效</strong>，关闭浏览器Cookie就失效了，Cookie不会写到硬盘中。Cookie默认值就是-1。这也就为什么在我第一个例子中，如果我没设置Cookie的有效期，在硬盘中就找不到对应的文件。</li>
<li>如果MaxAge为<strong>0</strong>，则表示<strong>删除该Cookie</strong>。Cookie机制没有提供删除Cookie对应的方法，把MaxAge设置为0等同于删除Cookie</li>
</ul>
<h3 id="Cookie的修改和删除"><a href="#Cookie的修改和删除" class="headerlink" title="Cookie的修改和删除"></a>Cookie的修改和删除</h3><ul>
<li>上面我们已经知道了Cookie机制没有提供删除Cookie的方法。其实细心点我们可以发现，Cookie机制也没有提供修改Cookie的方法。那么我们<strong>怎么修改Cookie的值呢</strong>？</li>
<li>Cookie存储的方式<strong>类似于Map集合</strong></li>
<li><strong>Cookie的名称相同，通过response添加到浏览器中，会覆盖原来的Cookie</strong>。</li>
<li>注意：删除，修改Cookie时，<strong>新建的Cookie除了value、maxAge之外的所有属性都要与原Cookie相同</strong>。否则浏览器将<strong>视为不同的Cookie，不予覆盖，导致删除修改失败</strong>！</li>
</ul>
<p>删除Cookie示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//创建一个名字为lastAccessTime的cookie</span></span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;lastAccessTime&quot;</span>, System.currentTimeMillis()+<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//将cookie的有效期设置为0，命令浏览器删除该cookie</span></span><br><span class="line">        cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line">        response.addCookie(cookie);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Cookie的域名"><a href="#Cookie的域名" class="headerlink" title="Cookie的域名"></a>Cookie的域名</h3><p>Cookie的<strong>domain属性决定运行访问Cookie的域名。domain的值规定为“.域名”</strong></p>
<ul>
<li>Cookie的隐私安全机制决定Cookie是不可跨域名的。也就是说<a href="http://www.baidu.com和www.google.com之间的Cookie是互不交接的。**即使是同一级域名，不同二级域名也不能交接**，也就是说：www.goole.com和www.image.goole.com的Cookie也不能访问">www.baidu.com和www.google.com之间的Cookie是互不交接的。**即使是同一级域名，不同二级域名也不能交接**，也就是说：www.goole.com和www.image.goole.com的Cookie也不能访问</a></li>
</ul>
<h3 id="Cookie的安全属性"><a href="#Cookie的安全属性" class="headerlink" title="Cookie的安全属性"></a>Cookie的安全属性</h3><ul>
<li>HTTP协议不仅仅是无状态的，而且是不安全的！如果不希望Cookie在非安全协议中传输，可以<strong>设置Cookie的secure属性为true，浏览器只会在HTTPS和SSL等安全协议中传输该Cookie</strong>。</li>
<li>当然了，设置secure属性不会将Cookie的内容加密。如果想要保证安全，最好使用md5算法加密。</li>
</ul>
<h1 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h1><blockquote>
<p>Session 是另一种记录浏览器状态的机制。不同的是Cookie保存在浏览器中，Session保存在服务器中。用户使用浏览器访问服务器的时候，服务器把用户的信息以某种的形式记录在服务器，这就是Session</p>
</blockquote>
<h2 id="Session和Cookie的区别"><a href="#Session和Cookie的区别" class="headerlink" title="Session和Cookie的区别"></a>Session和Cookie的区别</h2><ul>
<li>Cookie是把用户的数据写给用户的浏览器。</li>
<li>Session技术把用户的数据写到用户独占的session中。</li>
<li>Session对象由服务器创建，开发人员可以调用request对象的getSession方法得到session对象。</li>
<li><strong>Session可以存储对象，Cookie只能存储字符串。</strong></li>
</ul>
<h2 id="Session的生命周期和有效期"><a href="#Session的生命周期和有效期" class="headerlink" title="Session的生命周期和有效期"></a>Session的生命周期和有效期</h2><ul>
<li>Session在用户<strong>第一次访问服务器Servlet，jsp等动态资源就会被自动创建，Session对象保存在内存里</strong>。</li>
<li>如果访问HTML,IMAGE等静态资源Session不会被创建。</li>
<li>Session生成后，只要用户继续访问，服务器就会更新Session的最后访问时间，无论<strong>是否对Session进行读写，服务器都会认为Session活跃了一次</strong>。</li>
<li>由于会有越来越多的用户访问服务器，因此Session也会越来越多。<strong>为了防止内存溢出，服务器会把长时间没有活跃的Session从内存中删除，这个时间也就是Session的超时时间</strong>。</li>
</ul>
<h2 id="Session创建和销毁"><a href="#Session创建和销毁" class="headerlink" title="Session创建和销毁"></a>Session创建和销毁</h2><p>服务器创建session出来后，会把session的id号，以cookie的形式回写给客户机，这样，只要客户机的浏览器不关，再去访问服务器时，都会带着session的id号去，服务器发现客户机浏览器带session id过来了，就会使用内存中与之对应的session为之服务。</p>
<p>创建：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用request对象的getSession()获取session，如果session不存在则创建一个</span></span><br><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="comment">//获取session的Id</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sessionId</span> <span class="operator">=</span> session.getId();</span><br><span class="line"><span class="comment">//判断session是不是新创建的</span></span><br><span class="line"><span class="keyword">if</span> (session.isNew()) &#123;</span><br><span class="line">    response.getWriter().print(<span class="string">&quot;session创建成功，session的id是：&quot;</span>+sessionId);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    response.getWriter().print(<span class="string">&quot;服务器已经存在session，session的id是：&quot;</span>+sessionId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>销毁：</p>
<p>　session对象默认30分钟没有使用，则服务器会自动销毁session，在web.xml文件中可以手工配置session的失效时间</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;2.5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 设置Session的有效时间:以分钟为单位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在tomcat&#x2F;conf&#x2F;web.xml文件中设置，时间值为20分钟，<strong>所有的WEB应用都有效</strong></li>
<li>在单个的web.xml文件中设置，对单个web应用有效，<strong>如果有冲突，以自己的web应用为准</strong>。</li>
</ul>
<p>当需要在程序中手动设置Session失效时，可以手工调用<strong>session.invalidate</strong>方法，摧毁session。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="comment">//手工调用session.invalidate方法，摧毁session</span></span><br><span class="line">session.invalidate();</span><br></pre></td></tr></table></figure>

<h2 id="Session应用"><a href="#Session应用" class="headerlink" title="Session应用"></a>Session应用</h2><h3 id="1、表单重复提交"><a href="#1、表单重复提交" class="headerlink" title="1、表单重复提交"></a>1、表单重复提交</h3><ul>
<li>网络延迟</li>
<li>表单提交后，用户多次刷新</li>
<li>表单提交后，点击浏览器“后退”按钮回退到表单页面后再次提交</li>
</ul>
<p>方法一：只能解决在网络延迟的情况下防止用户多次提交</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoFormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//客户端是以UTF-8编码传输数据到服务器端的，所以需要设置服务器端以UTF-8的编码进行接收，否则对于中文数据就会产生乱码</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//让当前的线程睡眠3秒钟，模拟网络延迟而导致表单重复提交的现象</span></span><br><span class="line">            Thread.sleep(<span class="number">3</span>*<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;向数据库中插入数据：&quot;</span>+userName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法二：利用Session</p>
<p>具体的做法：<strong>在服务器端生成一个唯一的随机标识号，专业术语称为Token(令牌)，同时在当前用户的Session域中保存这个Token。然后将Token发送到客户端的Form表单中，在Form表单中使用隐藏域来存储这个Token，表单提交的时候连同这个Token一起提交到服务器端，然后在服务器端判断客户端提交上来的Token与服务器端生成的Token是否一致，如果不一致，那就是重复提交了，此时服务器端就可以不处理重复提交的表单。如果相同则处理表单提交，处理完后清除当前用户的Session域中存储的标识号。</strong></p>
<p>在下列情况下，服务器程序将拒绝处理用户提交的表单请求：</p>
<ol>
<li>存储Session域中的Token(令牌)与表单提交的Token(令牌)不同。</li>
<li>当前用户的Session中不存在Token(令牌)。</li>
<li>用户提交的表单数据中没有Token(令牌)。</li>
</ol>
<p>创建Token：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">884689940866074733L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> TokenProccessor.getInstance().makeToken();<span class="comment">//创建令牌</span></span><br><span class="line">        System.out.println(<span class="string">&quot;在FormServlet中生成的token：&quot;</span>+token);</span><br><span class="line">        request.getSession().setAttribute(<span class="string">&quot;token&quot;</span>, token);  <span class="comment">//在服务器使用session保存token(令牌)</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/form.jsp&quot;</span>).forward(request, response);<span class="comment">//跳转到form.jsp页面</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在jsp文件中使用隐藏域来存储Token：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;form表单&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/servlet/DoFormServlet&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        &lt;%--使用隐藏域存储生成的token--%&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">            &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;token&quot;</span> value=<span class="string">&quot;&lt;%=session.getAttribute(&quot;</span>token<span class="string">&quot;) %&gt;&quot;</span>&gt;</span><br><span class="line">        --%&gt;</span><br><span class="line">        &lt;%--使用EL表达式取出存储在session中的token--%&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;token&quot;</span> value=<span class="string">&quot;$&#123;token&#125;&quot;</span>/&gt;</span><br><span class="line">        用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>处理表单请求:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoFormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">                <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> isRepeatSubmit(request);<span class="comment">//判断用户是否是重复提交</span></span><br><span class="line">            <span class="keyword">if</span>(b==<span class="literal">true</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;请不要重复提交&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            request.getSession().removeAttribute(<span class="string">&quot;token&quot;</span>);<span class="comment">//移除session中的token</span></span><br><span class="line">            System.out.println(<span class="string">&quot;处理用户提交请求！！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 判断客户端提交上来的令牌和服务器端生成的令牌是否一致</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         *         true 用户重复提交了表单</span></span><br><span class="line"><span class="comment">         *         false 用户没有重复提交表单</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isRepeatSubmit</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">client_token</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="comment">//1、如果用户提交的表单数据中没有token，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(client_token==<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//取出存储在Session中的token</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">server_token</span> <span class="operator">=</span> (String) request.getSession().getAttribute(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="comment">//2、如果当前用户的Session中不存在Token(令牌)，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(server_token==<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//3、存储在Session中的Token(令牌)与表单提交的Token(令牌)不同，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(!client_token.equals(server_token))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rhb</p>
  <div class="site-description" itemprop="description">纵浪大化中，不喜亦不惧</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">144</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/RShawshank" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;RShawshank" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rhb</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://lib.baomitu.com/canvas-nest.js/1.0.1/canvas-nest.js"></script>


        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
