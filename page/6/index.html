<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rshawshank.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="纵浪大化中，不喜亦不惧">
<meta property="og:type" content="website">
<meta property="og:title" content="rhb_blog">
<meta property="og:url" content="http://rshawshank.github.io/page/6/index.html">
<meta property="og:site_name" content="rhb_blog">
<meta property="og:description" content="纵浪大化中，不喜亦不惧">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="rhb">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rshawshank.github.io/page/6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>rhb_blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">rhb_blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">rao的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">63</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">27</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">155</span></a>

  </li>
        <li class="menu-item menu-item-photos">

    <a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>相册</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-readnote">

    <a href="/readnote" rel="section"><i class="fa fa-book fa-fw"></i>阅读笔记</a>

  </li>
        <li class="menu-item menu-item-somethink">

    <a href="/somethink/" rel="section"><i class="fa fa-sticky-note fa-fw"></i>随笔闲谈</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/RShawshank" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E2%80%94%E2%80%94%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E2%80%94%E2%80%94%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">JavaWeb学习（（六）——会话技术</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 14:19:13" itemprop="dateCreated datePublished" datetime="2021-09-18T14:19:13Z">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="会话技术"><a href="#会话技术" class="headerlink" title="会话技术"></a>会话技术</h1><blockquote>
<p>基本概念: 指用户开一个浏览器，<strong>访问一个网站,只要不关闭该浏览器，不管该用户点击多少个超链接，访问多少资源，直到用户关闭浏览器，整个这个过程我们称为一次会话</strong>.</p>
</blockquote>
<h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><blockquote>
<p>Cookie是由W3C组织提出，最早由netscape社区发展的一种机制</p>
</blockquote>
<ul>
<li>Cookie的流程：浏览器访问服务器，<strong>如果服务器需要记录该用户的状态，就使用response向浏览器发送一个Cookie，浏览器会把Cookie保存起来。当浏览器再次访问服务器的时候，浏览器会把请求的网址连同Cookie一同交给服务器</strong>。</li>
</ul>
<h3 id="Cookie-API"><a href="#Cookie-API" class="headerlink" title="Cookie API"></a>Cookie API</h3><p>　Java中的javax.servlet.http.Cookie类用于创建一个Cookie</p>
<table>
<thead>
<tr>
<th>Cookie类的主要方法</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>No.</td>
<td>方法</td>
<td>类型</td>
<td>描述</td>
</tr>
<tr>
<td>1</td>
<td>[Cookie](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3803033.html#Cookie">https://www.cnblogs.com/xdp-gacl/p/3803033.html#Cookie</a>(java.lang.String, java.lang.String))(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> name, <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> value)</td>
<td>构造方法</td>
<td>实例化Cookie对象，传入cooke名称和cookie的值</td>
</tr>
<tr>
<td>2</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getName()</td>
<td>普通方法</td>
<td>取得Cookie的名字</td>
</tr>
<tr>
<td>3</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getValue()</td>
<td>普通方法</td>
<td>取得Cookie的值</td>
</tr>
<tr>
<td>4</td>
<td>public void setValue(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> newValue)</td>
<td>普通方法</td>
<td>设置Cookie的值</td>
</tr>
<tr>
<td>5</td>
<td>public void setMaxAge(int expiry)</td>
<td>普通方法</td>
<td>设置Cookie的最大保存时间，即cookie的有效期，当服务器给浏览器回送一个cookie时，如果在服务器端没有调用setMaxAge方法设置cookie的有效期，那么cookie的有效期只在一次会话过程中有效，<strong>用户开一个浏览器，点击多个超链接，访问服务器多个web资源，然后关闭浏览器，整个过程称之为一次会话</strong>，当用户关闭浏览器，会话就结束了，此时cookie就会失效，如果在服务器端使用setMaxAge方法设置了cookie的有效期，比如设置了30分钟，那么当服务器把cookie发送给浏览器时，此时cookie就会在客户端的硬盘上存储30分钟，在30分钟内，即使浏览器关了，cookie依然存在，在30分钟内，打开浏览器访问服务器时，浏览器都会把cookie一起带上，这样就可以在服务器端获取到客户端浏览器传递过来的cookie里面的信息了，这就是cookie设置maxAge和不设置maxAge的区别，不设置maxAge，那么cookie就只在一次会话中有效，一旦用户关闭了浏览器，那么cookie就没有了，那么浏览器是怎么做到这一点的呢，我们启动一个浏览器，就相当于启动一个应用程序，而服务器回送的cookie首先是存在浏览器的缓存中的，当浏览器关闭时，浏览器的缓存自然就没有了，所以存储在缓存中的cookie自然就被清掉了，而如果设置了cookie的有效期，那么浏览器在关闭时，就会把缓存中的cookie写到硬盘上存储起来，这样cookie就能够一直存在了。</td>
</tr>
<tr>
<td>6</td>
<td>public int getMaxAge()</td>
<td>普通方法</td>
<td>获取Cookies的有效期</td>
</tr>
<tr>
<td>7</td>
<td>public void setPath(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> uri)</td>
<td>普通方法</td>
<td>设置cookie的有效路径，比如把cookie的有效路径设置为”&#x2F;xdp”，那么浏览器访问”xdp”目录下的web资源时，都会带上cookie，再比如把cookie的有效路径设置为”&#x2F;xdp&#x2F;gacl”，那么浏览器只有在访问”xdp”目录下的”gacl”这个目录里面的web资源时才会带上cookie一起访问，而当访问”xdp”目录下的web资源时，浏览器是不带cookie的</td>
</tr>
<tr>
<td>8</td>
<td>public <a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> getPath()</td>
<td>普通方法</td>
<td>获取cookie的有效路径</td>
</tr>
<tr>
<td>9</td>
<td>public void setDomain(<a target="_blank" rel="noopener" href="http://java.sun.com/j2se/1.5/docs/api/java/lang/String.html">String</a> pattern)</td>
<td>普通方法</td>
<td>设置cookie的有效域</td>
</tr>
<tr>
<td>10</td>
<td>public String getDomain()</td>
<td>普通方法</td>
<td>获取cookie的有效域</td>
</tr>
</tbody></table>
<p>　　response接口也中定义了一个addCookie方法，它用于在其响应头中增加一个相应的Set-Cookie头字段。 同样，request接口中也定义了一个getCookies方法，它用于获取客户端提交的Cookie。</p>
<ul>
<li>Cookie类用于创建一个Cookie对象</li>
<li>response接口中定义了一个addCookie方法，它用于在其响应头中增加一个相应的Set-Cookie头字段</li>
<li>request接口中定义了一个getCookies方法，它用于获取客户端提交的Cookie</li>
</ul>
<h3 id="简单使用Cookie"><a href="#简单使用Cookie" class="headerlink" title="简单使用Cookie"></a>简单使用Cookie</h3><ul>
<li>创建Cookie对象，发送Cookie给浏览器、</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置response的编码</span></span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建Cookie对象，指定名称和值</span></span><br><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;zhongfucheng&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//向浏览器给一个Cookie</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">response.getWriter().write(<span class="string">&quot;我已经向浏览器发送了一个Cookie&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置Cookie的时间</span></span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>保存中文</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="type">PrintWriter</span> <span class="variable">printWriter</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">  </span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;中国&quot;</span>;</span><br><span class="line">     </span><br><span class="line">  <span class="comment">//对Unicode字符进行编码</span></span><br><span class="line">  <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;country&quot;</span>, URLEncoder.encode(name, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">cookie.setMaxAge(<span class="number">2000</span>);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">  </span><br><span class="line">printWriter.write(<span class="string">&quot;我颁发了一个Cookie，值保存的是中文数据&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>我们发现Cookie保存在硬盘的中文数据是经过编码的，那么我们在<strong>取出Cookie的时候要对中文数据进行解码</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cookies[i].getName();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//经过URLEncoding就要URLDecoding</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> URLDecoder.decode(cookies[i].getValue(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    printWriter.write(name + <span class="string">&quot;------&quot;</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Cookie不可跨域名性"><a href="#Cookie不可跨域名性" class="headerlink" title="Cookie不可跨域名性"></a>Cookie不可跨域名性</h3><p>Cookie具有不可跨域名性。浏览器判断<strong>一个网站是否能操作另一个网站的Cookie的依据是域名</strong>。所以一般来说，<strong>当我访问baidu的时候，浏览器只会把baidu颁发的Cookie带过去，而不会带上google的Cookie。</strong></p>
<h3 id="Cookie的有效期"><a href="#Cookie的有效期" class="headerlink" title="Cookie的有效期"></a>Cookie的有效期</h3><p><strong>Cookie的有效期是通过setMaxAge()来设置的</strong>。</p>
<ul>
<li>如果MaxAge为<strong>正数</strong>，<strong>浏览器会把Cookie写到硬盘中，只要还在MaxAge秒之前，登陆网站时该Cookie就有效</strong>【不论关闭了浏览器还是电脑】</li>
<li>如果MaxAge为<strong>负数</strong>，<strong>Cookie是临时性的，仅在本浏览器内有效</strong>，关闭浏览器Cookie就失效了，Cookie不会写到硬盘中。Cookie默认值就是-1。这也就为什么在我第一个例子中，如果我没设置Cookie的有效期，在硬盘中就找不到对应的文件。</li>
<li>如果MaxAge为<strong>0</strong>，则表示<strong>删除该Cookie</strong>。Cookie机制没有提供删除Cookie对应的方法，把MaxAge设置为0等同于删除Cookie</li>
</ul>
<h3 id="Cookie的修改和删除"><a href="#Cookie的修改和删除" class="headerlink" title="Cookie的修改和删除"></a>Cookie的修改和删除</h3><ul>
<li>上面我们已经知道了Cookie机制没有提供删除Cookie的方法。其实细心点我们可以发现，Cookie机制也没有提供修改Cookie的方法。那么我们<strong>怎么修改Cookie的值呢</strong>？</li>
<li>Cookie存储的方式<strong>类似于Map集合</strong></li>
<li><strong>Cookie的名称相同，通过response添加到浏览器中，会覆盖原来的Cookie</strong>。</li>
<li>注意：删除，修改Cookie时，<strong>新建的Cookie除了value、maxAge之外的所有属性都要与原Cookie相同</strong>。否则浏览器将<strong>视为不同的Cookie，不予覆盖，导致删除修改失败</strong>！</li>
</ul>
<p>删除Cookie示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//创建一个名字为lastAccessTime的cookie</span></span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;lastAccessTime&quot;</span>, System.currentTimeMillis()+<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//将cookie的有效期设置为0，命令浏览器删除该cookie</span></span><br><span class="line">        cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line">        response.addCookie(cookie);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Cookie的域名"><a href="#Cookie的域名" class="headerlink" title="Cookie的域名"></a>Cookie的域名</h3><p>Cookie的<strong>domain属性决定运行访问Cookie的域名。domain的值规定为“.域名”</strong></p>
<ul>
<li>Cookie的隐私安全机制决定Cookie是不可跨域名的。也就是说<a href="http://www.baidu.com和www.google.com之间的Cookie是互不交接的。**即使是同一级域名，不同二级域名也不能交接**，也就是说：www.goole.com和www.image.goole.com的Cookie也不能访问">www.baidu.com和www.google.com之间的Cookie是互不交接的。**即使是同一级域名，不同二级域名也不能交接**，也就是说：www.goole.com和www.image.goole.com的Cookie也不能访问</a></li>
</ul>
<h3 id="Cookie的安全属性"><a href="#Cookie的安全属性" class="headerlink" title="Cookie的安全属性"></a>Cookie的安全属性</h3><ul>
<li>HTTP协议不仅仅是无状态的，而且是不安全的！如果不希望Cookie在非安全协议中传输，可以<strong>设置Cookie的secure属性为true，浏览器只会在HTTPS和SSL等安全协议中传输该Cookie</strong>。</li>
<li>当然了，设置secure属性不会将Cookie的内容加密。如果想要保证安全，最好使用md5算法加密。</li>
</ul>
<h1 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h1><blockquote>
<p>Session 是另一种记录浏览器状态的机制。不同的是Cookie保存在浏览器中，Session保存在服务器中。用户使用浏览器访问服务器的时候，服务器把用户的信息以某种的形式记录在服务器，这就是Session</p>
</blockquote>
<h2 id="Session和Cookie的区别"><a href="#Session和Cookie的区别" class="headerlink" title="Session和Cookie的区别"></a>Session和Cookie的区别</h2><ul>
<li>Cookie是把用户的数据写给用户的浏览器。</li>
<li>Session技术把用户的数据写到用户独占的session中。</li>
<li>Session对象由服务器创建，开发人员可以调用request对象的getSession方法得到session对象。</li>
<li><strong>Session可以存储对象，Cookie只能存储字符串。</strong></li>
</ul>
<h2 id="Session的生命周期和有效期"><a href="#Session的生命周期和有效期" class="headerlink" title="Session的生命周期和有效期"></a>Session的生命周期和有效期</h2><ul>
<li>Session在用户<strong>第一次访问服务器Servlet，jsp等动态资源就会被自动创建，Session对象保存在内存里</strong>。</li>
<li>如果访问HTML,IMAGE等静态资源Session不会被创建。</li>
<li>Session生成后，只要用户继续访问，服务器就会更新Session的最后访问时间，无论<strong>是否对Session进行读写，服务器都会认为Session活跃了一次</strong>。</li>
<li>由于会有越来越多的用户访问服务器，因此Session也会越来越多。<strong>为了防止内存溢出，服务器会把长时间没有活跃的Session从内存中删除，这个时间也就是Session的超时时间</strong>。</li>
</ul>
<h2 id="Session创建和销毁"><a href="#Session创建和销毁" class="headerlink" title="Session创建和销毁"></a>Session创建和销毁</h2><p>服务器创建session出来后，会把session的id号，以cookie的形式回写给客户机，这样，只要客户机的浏览器不关，再去访问服务器时，都会带着session的id号去，服务器发现客户机浏览器带session id过来了，就会使用内存中与之对应的session为之服务。</p>
<p>创建：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用request对象的getSession()获取session，如果session不存在则创建一个</span></span><br><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="comment">//获取session的Id</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sessionId</span> <span class="operator">=</span> session.getId();</span><br><span class="line"><span class="comment">//判断session是不是新创建的</span></span><br><span class="line"><span class="keyword">if</span> (session.isNew()) &#123;</span><br><span class="line">    response.getWriter().print(<span class="string">&quot;session创建成功，session的id是：&quot;</span>+sessionId);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    response.getWriter().print(<span class="string">&quot;服务器已经存在session，session的id是：&quot;</span>+sessionId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>销毁：</p>
<p>　session对象默认30分钟没有使用，则服务器会自动销毁session，在web.xml文件中可以手工配置session的失效时间</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;2.5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 设置Session的有效时间:以分钟为单位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在tomcat&#x2F;conf&#x2F;web.xml文件中设置，时间值为20分钟，<strong>所有的WEB应用都有效</strong></li>
<li>在单个的web.xml文件中设置，对单个web应用有效，<strong>如果有冲突，以自己的web应用为准</strong>。</li>
</ul>
<p>当需要在程序中手动设置Session失效时，可以手工调用<strong>session.invalidate</strong>方法，摧毁session。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="comment">//手工调用session.invalidate方法，摧毁session</span></span><br><span class="line">session.invalidate();</span><br></pre></td></tr></table></figure>

<h2 id="Session应用"><a href="#Session应用" class="headerlink" title="Session应用"></a>Session应用</h2><h3 id="1、表单重复提交"><a href="#1、表单重复提交" class="headerlink" title="1、表单重复提交"></a>1、表单重复提交</h3><ul>
<li>网络延迟</li>
<li>表单提交后，用户多次刷新</li>
<li>表单提交后，点击浏览器“后退”按钮回退到表单页面后再次提交</li>
</ul>
<p>方法一：只能解决在网络延迟的情况下防止用户多次提交</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoFormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//客户端是以UTF-8编码传输数据到服务器端的，所以需要设置服务器端以UTF-8的编码进行接收，否则对于中文数据就会产生乱码</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//让当前的线程睡眠3秒钟，模拟网络延迟而导致表单重复提交的现象</span></span><br><span class="line">            Thread.sleep(<span class="number">3</span>*<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;向数据库中插入数据：&quot;</span>+userName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法二：利用Session</p>
<p>具体的做法：<strong>在服务器端生成一个唯一的随机标识号，专业术语称为Token(令牌)，同时在当前用户的Session域中保存这个Token。然后将Token发送到客户端的Form表单中，在Form表单中使用隐藏域来存储这个Token，表单提交的时候连同这个Token一起提交到服务器端，然后在服务器端判断客户端提交上来的Token与服务器端生成的Token是否一致，如果不一致，那就是重复提交了，此时服务器端就可以不处理重复提交的表单。如果相同则处理表单提交，处理完后清除当前用户的Session域中存储的标识号。</strong></p>
<p>在下列情况下，服务器程序将拒绝处理用户提交的表单请求：</p>
<ol>
<li>存储Session域中的Token(令牌)与表单提交的Token(令牌)不同。</li>
<li>当前用户的Session中不存在Token(令牌)。</li>
<li>用户提交的表单数据中没有Token(令牌)。</li>
</ol>
<p>创建Token：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">884689940866074733L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> TokenProccessor.getInstance().makeToken();<span class="comment">//创建令牌</span></span><br><span class="line">        System.out.println(<span class="string">&quot;在FormServlet中生成的token：&quot;</span>+token);</span><br><span class="line">        request.getSession().setAttribute(<span class="string">&quot;token&quot;</span>, token);  <span class="comment">//在服务器使用session保存token(令牌)</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/form.jsp&quot;</span>).forward(request, response);<span class="comment">//跳转到form.jsp页面</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在jsp文件中使用隐藏域来存储Token：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;form表单&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/servlet/DoFormServlet&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        &lt;%--使用隐藏域存储生成的token--%&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">            &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;token&quot;</span> value=<span class="string">&quot;&lt;%=session.getAttribute(&quot;</span>token<span class="string">&quot;) %&gt;&quot;</span>&gt;</span><br><span class="line">        --%&gt;</span><br><span class="line">        &lt;%--使用EL表达式取出存储在session中的token--%&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;token&quot;</span> value=<span class="string">&quot;$&#123;token&#125;&quot;</span>/&gt;</span><br><span class="line">        用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>处理表单请求:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoFormServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">                <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> isRepeatSubmit(request);<span class="comment">//判断用户是否是重复提交</span></span><br><span class="line">            <span class="keyword">if</span>(b==<span class="literal">true</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;请不要重复提交&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            request.getSession().removeAttribute(<span class="string">&quot;token&quot;</span>);<span class="comment">//移除session中的token</span></span><br><span class="line">            System.out.println(<span class="string">&quot;处理用户提交请求！！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 判断客户端提交上来的令牌和服务器端生成的令牌是否一致</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         *         true 用户重复提交了表单</span></span><br><span class="line"><span class="comment">         *         false 用户没有重复提交表单</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isRepeatSubmit</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">client_token</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="comment">//1、如果用户提交的表单数据中没有token，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(client_token==<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//取出存储在Session中的token</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">server_token</span> <span class="operator">=</span> (String) request.getSession().getAttribute(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="comment">//2、如果当前用户的Session中不存在Token(令牌)，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(server_token==<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//3、存储在Session中的Token(令牌)与表单提交的Token(令牌)不同，则用户是重复提交了表单</span></span><br><span class="line">            <span class="keyword">if</span>(!client_token.equals(server_token))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%9B%9B%EF%BC%89%E2%80%94%E2%80%94Servlet%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/18/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%9B%9B%EF%BC%89%E2%80%94%E2%80%94Servlet%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">JavaWeb学习（四）——Servlet（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-18 10:03:05" itemprop="dateCreated datePublished" datetime="2021-09-18T10:03:05Z">2021-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="HttpServlet抽象类"><a href="#HttpServlet抽象类" class="headerlink" title="HttpServlet抽象类"></a>HttpServlet抽象类</h1><p>HttpServlet抽象类是继承于GenericServlet抽象类而来的。使用HttpServlet抽象类时，还需要借助分别代表Servlet请求和Servlet响应的HttpServletRequest和HttpServletResponse对象。</p>
<ul>
<li><p>HttpServletRequest接口扩展于javax.servlet.ServletRequest接口</p>
</li>
<li><p>HttpServletResponse接口扩展于javax.servlet.servletResponse接口。</p>
</li>
</ul>
<blockquote>
<p>request和response对象</p>
<blockquote>
<p>Tomcat收到客户端的http请求，会针对每一次请求，分别创建一个<strong>代表请求的request对象</strong>、和<strong>代表响应的response对象</strong></p>
</blockquote>
<p>request对象代表http请求：<strong>获取浏览器提交过来的数据，找request对象</strong>。</p>
<p>response对象代表http响应：<strong>向浏览器输出数据，找response对象</strong>。</p>
</blockquote>
<h1 id="HttpServletResponse对象"><a href="#HttpServletResponse对象" class="headerlink" title="HttpServletResponse对象"></a>HttpServletResponse对象</h1><p>HttpServletResponse对象代表服务器的响应。这个对象中封装了向客户端发送数据、发送响应头，发送响应状态码的方法。</p>
<h2 id="常见应用"><a href="#常见应用" class="headerlink" title="常见应用"></a>常见应用</h2><h3 id="1、使用OutputStream流向客户端浏览器输出中文数据"><a href="#1、使用OutputStream流向客户端浏览器输出中文数据" class="headerlink" title="1、使用OutputStream流向客户端浏览器输出中文数据"></a>1、使用OutputStream流向客户端浏览器输出中文数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">4312868947607181532L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        outputChineseByOutputStream(response);<span class="comment">//使用OutputStream流输出中文</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用OutputStream流输出中文</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">outputChineseByOutputStream</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="comment">/**使用OutputStream输出中文注意问题：</span></span><br><span class="line"><span class="comment">         * 在服务器端，数据是以哪个码表输出的，那么就要控制客户端浏览器以相应的码表打开，</span></span><br><span class="line"><span class="comment">         * 比如：outputStream.write(&quot;中国&quot;.getBytes(&quot;UTF-8&quot;));//使用OutputStream流向客户端浏览器输出中文，以UTF-8的编码进行输出</span></span><br><span class="line"><span class="comment">         * 此时就要控制客户端浏览器以UTF-8的编码打开，否则显示的时候就会出现中文乱码，那么在服务器端如何控制客户端浏览器以以UTF-8的编码显示数据呢？</span></span><br><span class="line"><span class="comment">         * 可以通过设置响应头控制浏览器的行为，例如：</span></span><br><span class="line"><span class="comment">         * response.setHeader(&quot;content-type&quot;, &quot;text/html;charset=UTF-8&quot;);//通过设置响应头控制浏览器以UTF-8的编码显示数据</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;中国&quot;</span>;</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();<span class="comment">//获取OutputStream输出流</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/html;charset=UTF-8&quot;</span>);<span class="comment">//通过设置响应头控制浏览器以UTF-8的编码显示数据，如果不加这句话，那么浏览器显示的将是乱码</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * data.getBytes()是一个将字符转换成字节数组的过程，这个过程中一定会去查码表，</span></span><br><span class="line"><span class="comment">         * 如果是中文的操作系统环境，默认就是查找查GB2312的码表，</span></span><br><span class="line"><span class="comment">         * 将字符转换成字节数组的过程就是将中文字符转换成GB2312的码表上对应的数字</span></span><br><span class="line"><span class="comment">         * 比如： &quot;中&quot;在GB2312的码表上对应的数字是98</span></span><br><span class="line"><span class="comment">         *         &quot;国&quot;在GB2312的码表上对应的数字是99</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * getBytes()方法如果不带参数，那么就会根据操作系统的语言环境来选择转换码表，如果是中文操作系统，那么就使用GB2312的码表</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">byte</span>[] dataByteArr = data.getBytes(<span class="string">&quot;UTF-8&quot;</span>);<span class="comment">//将字符转换成字节数组，指定以UTF-8编码进行转换</span></span><br><span class="line">        outputStream.write(dataByteArr);<span class="comment">//使用OutputStream流向客户端输出字节数组</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、使用PrintWriter流向客户端浏览器输出中文数据"><a href="#2、使用PrintWriter流向客户端浏览器输出中文数据" class="headerlink" title="2、使用PrintWriter流向客户端浏览器输出中文数据"></a>2、使用PrintWriter流向客户端浏览器输出中文数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">4312868947607181532L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        outputChineseByPrintWriter(response);<span class="comment">//使用PrintWriter流输出中文</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用PrintWriter流输出中文</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">outputChineseByPrintWriter</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;中国&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//通过设置响应头控制浏览器以UTF-8的编码显示数据，如果不加这句话，那么浏览器显示的将是乱码</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;content-type&quot;, &quot;text/html;charset=UTF-8&quot;);</span></span><br><span class="line"></span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);<span class="comment">//设置将字符以&quot;UTF-8&quot;编码输出到客户端浏览器</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * PrintWriter out = response.getWriter();这句代码必须放在response.setCharacterEncoding(&quot;UTF-8&quot;);之后</span></span><br><span class="line"><span class="comment">         * 否则response.setCharacterEncoding(&quot;UTF-8&quot;)这行代码的设置将无效，浏览器显示的时候还是乱码</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();<span class="comment">//获取PrintWriter输出流</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 多学一招：使用HTML语言里面的&lt;meta&gt;标签来控制浏览器行为，模拟通过设置响应头控制浏览器行为</span></span><br><span class="line"><span class="comment">         * out.write(&quot;&lt;meta http-equiv=&#x27;content-type&#x27; content=&#x27;text/html;charset=UTF-8&#x27;/&gt;&quot;);</span></span><br><span class="line"><span class="comment">         * 等同于response.setHeader(&quot;content-type&quot;, &quot;text/html;charset=UTF-8&quot;);</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        out.write(<span class="string">&quot;&lt;meta http-equiv=&#x27;content-type&#x27; content=&#x27;text/html;charset=UTF-8&#x27;/&gt;&quot;</span>);</span><br><span class="line">        out.write(data);<span class="comment">//使用PrintWriter流向客户端输出字符</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、使用OutputStream或者PrintWriter向客户端浏览器输出数字"><a href="#3、使用OutputStream或者PrintWriter向客户端浏览器输出数字" class="headerlink" title="3、使用OutputStream或者PrintWriter向客户端浏览器输出数字"></a>3、使用OutputStream或者PrintWriter向客户端浏览器输出数字</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">4312868947607181532L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        outputOneByOutputStream(response);<span class="comment">//使用OutputStream输出1到客户端浏览器</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用OutputStream流输出数字1</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">outputOneByOutputStream</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        response.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        outputStream.write(<span class="string">&quot;使用OutputStream流输出数字1：&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="comment">//1+&quot;&quot;：数字1就变成了字符串1</span></span><br><span class="line">       outputStream.write((<span class="number">1</span>+<span class="string">&quot;&quot;</span>).getBytes());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4、文件下载"><a href="#4、文件下载" class="headerlink" title="4、文件下载"></a>4、文件下载</h3><p>文件下载功能的实现思路：</p>
<p>　　1.获取要下载的文件的绝对路径</p>
<p>　　2.获取要下载的文件名</p>
<p>　　3.设置content-disposition响应头控制浏览器以下载的形式打开文件</p>
<p>　　4.获取要下载的文件输入流</p>
<p>　　5.创建数据缓冲区</p>
<p>　　6.通过response对象获取OutputStream流</p>
<p>　　7.将FileInputStream流写入到buffer缓冲区</p>
<p>　　8.使用OutputStream将缓冲区的数据输出到客户端浏览器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> gacl</span></span><br><span class="line"><span class="comment"> * 文件下载</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        downloadFileByOutputStream(response);<span class="comment">//下载文件，通过OutputStream流</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 下载文件，通过OutputStream流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">downloadFileByOutputStream</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> FileNotFoundException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.获取要下载的文件的绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getRealPath(<span class="string">&quot;/download/1.JPG&quot;</span>);</span><br><span class="line">        <span class="comment">//2.获取要下载的文件名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> realPath.substring(realPath.lastIndexOf(<span class="string">&quot;\\&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//3.设置content-disposition响应头控制浏览器以下载的形式打开文件</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;content-disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span>+fileName);</span><br><span class="line">        <span class="comment">//4.获取要下载的文件输入流</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(realPath);</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//5.创建数据缓冲区</span></span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="comment">//6.通过response对象获取OutputStream流</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        <span class="comment">//7.将FileInputStream流写入到buffer缓冲区</span></span><br><span class="line">        <span class="keyword">while</span> ((len = in.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//8.使用OutputStream将缓冲区的数据输出到客户端浏览器</span></span><br><span class="line">            out.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当下载中文文件时，文件名需要经过URL编码，否则会出现文件名乱码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> gacl</span></span><br><span class="line"><span class="comment"> * 文件下载</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        downloadChineseFileByOutputStream(response);<span class="comment">//下载中文文件</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 下载中文文件,中文文件下载时，文件名要经过URL编码，否则会出现文件名乱码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">downloadChineseFileByOutputStream</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> FileNotFoundException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getRealPath(<span class="string">&quot;/download/张家界国家森林公园.JPG&quot;</span>);<span class="comment">//获取要下载的文件的绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> realPath.substring(realPath.lastIndexOf(<span class="string">&quot;\\&quot;</span>)+<span class="number">1</span>);<span class="comment">//获取要下载的文件名</span></span><br><span class="line">        <span class="comment">//设置content-disposition响应头控制浏览器以下载的形式打开文件，中文文件名要使用URLEncoder.encode方法进行编码，否则会出现文件名乱码</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;content-disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span>+URLEncoder.encode(fileName, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(realPath);<span class="comment">//获取文件输入流</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        <span class="keyword">while</span> ((len = in.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            out.write(buffer,<span class="number">0</span>,len);<span class="comment">//将缓冲区的数据输出到客户端浏览器</span></span><br><span class="line">        &#125;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件下载注意事项：<strong>编写文件下载功能时推荐使用OutputStream流，避免使用PrintWriter流，因为OutputStream流是字节流，可以处理任意类型的数据，而PrintWriter流是字符流，只能处理字符数据，如果用字符流处理字节数据，会导致数据丢失。</strong></p>
<h3 id="5、生成验证码"><a href="#5、生成验证码" class="headerlink" title="5、生成验证码"></a>5、生成验证码</h3><p>生成图片需要使用到bufferedImage类</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3798190.html">javaweb学习总结(九)—— 通过Servlet生成验证码图片 - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo03</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        response.setHeader(<span class="string">&quot;refresh&quot;</span>, <span class="string">&quot;5&quot;</span>);<span class="comment">//设置refresh响应头控制浏览器每隔5秒钟刷新一次</span></span><br><span class="line">        <span class="comment">//1.在内存中创建一张图片</span></span><br><span class="line">        <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedImage</span>(<span class="number">80</span>, <span class="number">20</span>, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">        <span class="comment">//2.得到图片</span></span><br><span class="line">        <span class="comment">//Graphics g = image.getGraphics();</span></span><br><span class="line">        <span class="type">Graphics2D</span> <span class="variable">g</span> <span class="operator">=</span> (Graphics2D)image.getGraphics();</span><br><span class="line">        g.setColor(Color.WHITE);<span class="comment">//设置图片的背景色</span></span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">20</span>);<span class="comment">//填充背景色</span></span><br><span class="line">        <span class="comment">//3.向图片上写数据</span></span><br><span class="line">        g.setColor(Color.BLUE);<span class="comment">//设置图片上字体的颜色</span></span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="literal">null</span>, Font.BOLD, <span class="number">20</span>));</span><br><span class="line">        g.drawString(makeNum(), <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line">        <span class="comment">//4.设置响应头控制浏览器浏览器以图片的方式打开</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;image/jpeg&quot;</span>);<span class="comment">//等同于response.setHeader(&quot;Content-Type&quot;, &quot;image/jpeg&quot;);</span></span><br><span class="line">        <span class="comment">//5.设置响应头控制浏览器不缓存图片数据</span></span><br><span class="line">        response.setDateHeader(<span class="string">&quot;expries&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">        <span class="comment">//6.将图片写给浏览器</span></span><br><span class="line">        ImageIO.write(image, <span class="string">&quot;jpg&quot;</span>, response.getOutputStream());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成随机数字</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">makeNum</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">num</span> <span class="operator">=</span> random.nextInt(<span class="number">9999999</span>)+<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">7</span>-num.length(); i++) &#123;</span><br><span class="line">            sb.append(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        num = sb.toString()+num;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6、设置响应头控制浏览器行为"><a href="#6、设置响应头控制浏览器行为" class="headerlink" title="6、设置响应头控制浏览器行为"></a>6、设置响应头控制浏览器行为</h3><ul>
<li>设置http响应头控制浏览器禁止缓存当前文档内容</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setDateHeader(<span class="string">&quot;expries&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">response.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">response.setHeader(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>设置http响应头控制浏览器定时刷新网页(refresh)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;refresh&quot;</span>, <span class="string">&quot;5&quot;</span>);<span class="comment">//设置refresh响应头控制浏览器每隔5秒钟刷新一次</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="7、通过response实现请求重定向"><a href="#7、通过response实现请求重定向" class="headerlink" title="7、通过response实现请求重定向"></a>7、通过response实现请求重定向</h3><p>请求重定向指：<strong>一个web资源收到客户端请求后，通知客户端去访问另外一个web资源，这称之为请求重定向。</strong></p>
<ul>
<li><p>应用场景：用户登陆，用户首先访问登录页面，登录成功后，就会跳转到某个页面，这个过程就是一个请求重定向的过程</p>
</li>
<li><p>实现方式：response.sendRedirect(String location)，即调用response对象的sendRedirect方法实现请求重定向　　</p>
</li>
<li><p>sendRedirect内部的实现原理：使用response设置302状态码和设置location响应头实现重定向</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseDemo04</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1.调用sendRedirect方法实现请求重定向,</span></span><br><span class="line"><span class="comment">         * sendRedirect方法内部调用了</span></span><br><span class="line"><span class="comment">         * response.setHeader(&quot;Location&quot;, &quot;/JavaWeb_HttpServletResponse_Study_20140615/index.jsp&quot;);</span></span><br><span class="line"><span class="comment">         * response.setStatus(HttpServletResponse.SC_FOUND);//设置302状态码，等同于response.setStatus(302);</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;/JavaWeb_HttpServletResponse_Study_20140615/index.jsp&quot;</span>);</span><br><span class="line"><span class="comment">/*其实sendRedirect()方法就是对setStatus()和setHeader()进行封装，原理就是setStatus()和setHeader()*/</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2.使用response设置302状态码和设置location响应头实现重定向实现请求重定向</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;Location&quot;, &quot;/JavaWeb_HttpServletResponse_Study_20140615/index.jsp&quot;);</span></span><br><span class="line">        <span class="comment">//response.setStatus(HttpServletResponse.SC_FOUND);//设置302状态码，等同于response.setStatus(302);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8、数据压缩"><a href="#8、数据压缩" class="headerlink" title="8、数据压缩"></a>8、数据压缩</h3><p>GZIP压缩类可对数据进行压缩：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">		<span class="comment">//GZIP的构造方法需要一个OutputStream子类对象，究竟哪个对象适合，我们看下write()方法</span></span><br><span class="line">        <span class="type">GZIPOutputStream</span> <span class="variable">gzipOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPOutputStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查看了下API，write()接收的是byte[]类型的。</span></span><br><span class="line">        gzipOutputStream.write();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//既然是byte[]类型，那么我就给他一个ByteArrayOutputStream</span></span><br><span class="line">			<span class="comment">//不能以匿名内部类的方式给GZIPOutputStream，必须把ByteArrayOutputStream定义出来</span></span><br><span class="line">				<span class="comment">//因为GZIPOutputStream写数据的时候，是把数据写到ByteArrayOutputStream上的，等会还要把数据取出来，再写给浏览器</span></span><br><span class="line">        <span class="type">GZIPOutputStream</span> <span class="variable">gzipOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPOutputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>());</span><br><span class="line">	</span><br><span class="line">        <span class="comment">//创建GZIPOutputStream对象，给予它ByteArrayOutputStream</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">GZIPOutputStream</span> <span class="variable">gzipOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPOutputStream</span>(byteArrayOutputStream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//GZIP对数据压缩，GZIP写入的数据是保存在byteArrayOutputStream上的</span></span><br><span class="line">        gzipOutputStream.write(ss.getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//gzipOutputStream有缓冲，把缓冲清了，并顺便关闭流</span></span><br><span class="line">        gzipOutputStream.close();</span><br><span class="line"></span><br><span class="line">          <span class="comment">//将压缩的数据取出来</span></span><br><span class="line">        <span class="type">byte</span>[] bytes = byteArrayOutputStream.toByteArray();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//将压缩的数据写给浏览器</span></span><br><span class="line">        response.getOutputStream().write(bytes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//压缩后的数据如果不告诉浏览器是压缩数据会乱码</span></span><br><span class="line">        <span class="comment">//告诉浏览器这是gzip压缩的数据</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Encoding&quot;</span>,<span class="string">&quot;gzip&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//再将压缩的数据写给浏览器</span></span><br><span class="line">        response.getOutputStream().write(bytes);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="输出流——getWriter-和getOutputStream"><a href="#输出流——getWriter-和getOutputStream" class="headerlink" title="输出流——getWriter()和getOutputStream()"></a>输出流——getWriter()和getOutputStream()</h3><ol>
<li><strong>getWriter()和getOutputStream()两个方法不能同时调用</strong>。</li>
<li>Servlet程序向ServletOutputStream或PrintWriter对象中<strong>写入的数据将被Servlet引擎从response里面获取，Servlet引擎将这些数据当作响应消息的正文，然后再与响应状态行和各响应头组合后输出到客户端</strong>。</li>
<li>Servlet的<strong>serice()方法结束后【也就是doPost()或者doGet()结束后】</strong>，Servlet引擎将检查getWriter或getOutputStream方法返回的输出流对象是否已经调用过close方法，<strong>如果没有，Servlet引擎将调用close方法关闭该输出流对象.</strong></li>
</ol>
<h1 id="HttpServletRequest对象"><a href="#HttpServletRequest对象" class="headerlink" title="HttpServletRequest对象"></a>HttpServletRequest对象</h1><blockquote>
<p>HttpServletRequest对象代表客户端的请求，当客户端通过HTTP协议访问服务器时，HTTP请求头中的所有信息都封装在这个对象中，开发人员通过这个对象的方法，可以获得客户这些信息。</p>
</blockquote>
<p>简单来说，<strong>要得到浏览器信息，就找HttpServletRequest对象</strong></p>
<p>request对象作为一个域对象(Map容器)使用时，主要是通过以下的四个方法来操作</p>
<ul>
<li>setAttribute(String name,Object o)方法，将数据作为request对象的一个属性存放到request对象中，例如：request.setAttribute(“data”, data);</li>
<li>getAttribute(String name)方法，获取request对象的name属性的属性值，例如：request.getAttribute(“data”)</li>
<li>removeAttribute(String name)方法，移除request对象的name属性，例如：request.removeAttribute(“data”)</li>
<li>getAttributeNames方法，获取request对象的所有属性名，返回的是一个，例如：Enumeration<String> attrNames &#x3D; request.getAttributeNames();</li>
</ul>
<h2 id="常见api"><a href="#常见api" class="headerlink" title="常见api"></a>常见api</h2><h3 id="获得客户机【浏览器】信息"><a href="#获得客户机【浏览器】信息" class="headerlink" title="获得客户机【浏览器】信息"></a>获得客户机【浏览器】信息</h3><ul>
<li><strong>getRequestURL方法返回客户端发出请求时的完整URL。</strong></li>
<li>getRequestURI方法返回请求行中的资源名部分。</li>
<li><strong>getQueryString 方法返回请求行中的参数部分。</strong></li>
<li>getPathInfo方法返回请求URL中的额外路径信息。额外路径信息是请求URL中的位于Servlet的路径之后和查询参数之前的内容，它以“&#x2F;”开头。</li>
<li><strong>getRemoteAddr方法返回发出请求的客户机的IP地址</strong></li>
<li>getRemoteHost方法返回发出请求的客户机的完整主机名</li>
<li>getRemotePort方法返回客户机所使用的网络端口号</li>
<li><strong>getLocalAddr方法返回WEB服务器的IP地址。</strong></li>
<li>getLocalName方法返回WEB服务器的主机名</li>
</ul>
<h3 id="获得客户机请求头"><a href="#获得客户机请求头" class="headerlink" title="获得客户机请求头"></a>获得客户机请求头</h3><ul>
<li><strong>getHeader(string name)方法:String</strong>　　</li>
<li>getHeaders(String name)方法:Enumeration</li>
<li>getHeaderNames()方法</li>
</ul>
<h3 id="获得客户机请求参数-客户端提交的数据"><a href="#获得客户机请求参数-客户端提交的数据" class="headerlink" title="获得客户机请求参数(客户端提交的数据)"></a>获得客户机请求参数(客户端提交的数据)</h3><ul>
<li>getParameter(String)方法**(常用)**</li>
<li>getParameterValues(String name)方法**(常用)**</li>
<li>getParameterNames()方法(<strong>不常用</strong>)</li>
<li>getParameterMap()方法**(编写框架时常用)**</li>
</ul>
<p>具体用法：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3798347.html">javaweb学习总结(十)——HttpServletRequest对象(一) - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>
<h2 id="常见应用-1"><a href="#常见应用-1" class="headerlink" title="常见应用"></a>常见应用</h2><h3 id="1、中文参数乱码问题"><a href="#1、中文参数乱码问题" class="headerlink" title="1、中文参数乱码问题"></a>1、中文参数乱码问题</h3><p>产生乱码，就是因为服务器和客户端沟通的编码不一致造成的，因此解决的办法是：在客户端和服务器之间设置一个统一的编码，之后就按照此编码进行数据的传输和接收。</p>
<p>由于客户端是以UTF-8字符编码将表单数据传输到服务器端的，因此服务器也需要设置以UTF-8字符编码进行接收，要想完成此操作，服务器可以直接使用从ServletRequest接口继承而来的”setCharacterEncoding(charset)”方法进行统一的编码设置。修改后的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 客户端是以UTF-8编码传输数据到服务器端的，所以需要设置服务器端以UTF-8的编码进行接收，否则对于中文数据就会产生乱码</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;userName&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;userName：&quot;</span>+userName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="以get方式提交表单中文参数乱码问题"><a href="#以get方式提交表单中文参数乱码问题" class="headerlink" title="以get方式提交表单中文参数乱码问题"></a>以get方式提交表单中文参数乱码问题</h4><p>单纯使用 request.setCharacterEncoding(“UTF-8”); 无法解决问题。</p>
<p>解决办法：<strong>在接收到数据后，先获取request对象以ISO8859-1字符编码接收到的原始数据的字节数组，然后通过字节数组以指定的编码构建字符串，解决乱码问题。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 对于以get方式传输的数据，request即使设置了以指定的编码接收数据也是无效的，默认的还是使用ISO8859-1这个字符编码来接收数据</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;name&quot;</span>);<span class="comment">//接收数据</span></span><br><span class="line">        name =<span class="keyword">new</span> <span class="title class_">String</span>(name.getBytes(<span class="string">&quot;ISO8859-1&quot;</span>), <span class="string">&quot;UTF-8&quot;</span>) ;<span class="comment">//获取request对象以ISO8859-1字符编码接收到的原始数据的字节数组，然后通过字节数组以指定的编码构建字符串，解决乱码问题</span></span><br><span class="line">        System.out.println(<span class="string">&quot;name：&quot;</span>+name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、防盗链"><a href="#2、防盗链" class="headerlink" title="2、防盗链"></a>2、防盗链</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到网页是从哪里来的</span></span><br><span class="line"><span class="type">String</span> <span class="variable">referer</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Referer&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果不是从我的首页来或者从地址栏直接访问的，</span></span><br><span class="line"><span class="keyword">if</span> ( referer == <span class="literal">null</span> || !referer.contains(<span class="string">&quot;localhost:8080/zhongfucheng/index.jsp&quot;</span>) ) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//回到首页去</span></span><br><span class="line">    response.sendRedirect(<span class="string">&quot;/zhongfucheng/index.jsp&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//能执行下面的语句，说明是从我的首页点击进来的，那没问题，照常显示</span></span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">response.getWriter().write(<span class="string">&quot;路飞做了XXXXxxxxxxxxxxxxxxxx&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3、实现转发"><a href="#3、实现转发" class="headerlink" title="3、实现转发"></a>3、实现转发</h3><p><strong>请求转发：指一个web资源收到客户端请求后，通知服务器去调用另外一个web资源进行处理。</strong><br>　　请求转发的应用场景：MVC设计模式</p>
<blockquote>
<p>endRedirect()可以<strong>实现重定向，做到的功能是页面跳转</strong>，使用request的getRequestDispatcher.forward(request,response)<strong>实现转发，做到的功能也是页面跳转</strong>。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到requestDispatcher对象，跳转到index.jsp</span></span><br><span class="line"><span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> request.getRequestDispatcher(<span class="string">&quot;/index.jsp&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用requestDispatcher对象的forward()实现转发,传入request和response方法</span></span><br><span class="line">requestDispatcher.forward(request, response);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ServletContext也能称之为域对象</strong>。而<strong>request也可以称之为域对象</strong>，只不过<strong>ServletContext的域是整个web应用，而request的域仅仅代表一次http请求</strong></li>
<li>一般的原则：<strong>可以使用request就尽可能使用request</strong>。因为ServletContext代表着整个web应用，使用ServletContext会消耗大量的资源，而<strong>request对象会随着请求的结束而结束，资源会被回收</strong>。<strong>使用request域进行Servlet之间的通讯在开发中是非常频繁的</strong></li>
</ul>
<p><img src="https://i.loli.net/2021/09/18/aEbon3clWSzh27A.png"></p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo06</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        String data=<span class="string">&quot;大家好&quot;</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 将数据存放到request对象中,此时把request对象当作一个Map容器来使用</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        request.setAttribute(<span class="string">&quot;data&quot;</span>, data);</span><br><span class="line">        <span class="comment">//客户端访问RequestDemo06这个Servlet后，RequestDemo06通知服务器将请求转发(forward)到test.jsp页面进行处理</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/test.jsp&quot;</span>).forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>test.jsp页面：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Request对象实现请求转发&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line">      使用普通方式取出存储在request对象中的数据：</span><br><span class="line">      &lt;h3 style=<span class="string">&quot;color:red;&quot;</span>&gt;&lt;%=(String)request.getAttribute(<span class="string">&quot;data&quot;</span>)%&gt;&lt;/h3&gt;</span><br><span class="line">     使用EL表达式取出存储在request对象中的数据：</span><br><span class="line">     &lt;h3 style=<span class="string">&quot;color:red;&quot;</span>&gt;$&#123;data&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="转发和重定向的区别"><a href="#转发和重定向的区别" class="headerlink" title="转发和重定向的区别"></a>转发和重定向的区别</h3><h4 id="实际发生位置不同，地址栏不同"><a href="#实际发生位置不同，地址栏不同" class="headerlink" title="实际发生位置不同，地址栏不同"></a>实际发生位置不同，地址栏不同</h4><ul>
<li>转发是发生在服务器的<ul>
<li><strong>转发是由服务器进行跳转的</strong>，细心的朋友会发现，在转发的时候，<strong>浏览器的地址栏是没有发生变化的</strong>。也就是说<strong>浏览器是不知道该跳转的动作，转发是对浏览器透明的</strong>。通过上面的转发时序图我们也可以发现，<strong>实现转发只是一次的http请求</strong>，<strong>一次转发中request和response对象都是同一个</strong>。这也解释了，为什么可以使用<strong>request作为域对象进行Servlet之间的通讯。</strong></li>
</ul>
</li>
<li>重定向是发生在浏览器的<ul>
<li><strong>重定向是由浏览器进行跳转的</strong>，进行重定向跳转的时候，<strong>浏览器的地址会发生变化的</strong>。曾经介绍过：实现重定向的原理是由response的状态码和Location头组合而实现的。<strong>这是由浏览器进行的页面跳转</strong>实现重定向<strong>会发出两个http请求</strong>，<strong>request域对象是无效的，因为它不是同一个request对象</strong></li>
</ul>
</li>
</ul>
<h4 id="用法不同"><a href="#用法不同" class="headerlink" title="用法不同"></a>用法不同</h4><p>很多人都搞不清楚转发和重定向的时候，<strong>资源地址究竟怎么写</strong>。有的时候要把应用名写上，有的时候不用把应用名写上。很容易把人搞晕。记住一个原则：<strong>给服务器用的直接从资源名开始写，给浏览器用的要把应用名写上</strong></p>
<ul>
<li>request.getRequestDispatcher(“&#x2F;资源名 URI”).forward(request,response)<ul>
<li><strong>转发时”&#x2F;“代表的是本应用程序的根目录</strong></li>
</ul>
</li>
<li>response.send(“&#x2F;web应用&#x2F;资源名 URI”);<ul>
<li><strong>重定向时”&#x2F;“代表的是webapps目录</strong></li>
</ul>
</li>
</ul>
<h4 id="能够去往的URL的范围不一样"><a href="#能够去往的URL的范围不一样" class="headerlink" title="能够去往的URL的范围不一样"></a>能够去往的URL的范围不一样</h4><ul>
<li><strong>转发是服务器跳转只能去往当前web应用的资源</strong></li>
<li><strong>重定向是浏览器跳转，可以去往任何的资源</strong></li>
</ul>
<h4 id="传递数据的类型不同"><a href="#传递数据的类型不同" class="headerlink" title="传递数据的类型不同"></a>传递数据的类型不同</h4><ul>
<li><strong>转发的request对象可以传递各种类型的数据，包括对象</strong></li>
<li><strong>重定向只能传递字符串</strong></li>
</ul>
<h4 id="跳转的时间不同"><a href="#跳转的时间不同" class="headerlink" title="跳转的时间不同"></a>跳转的时间不同</h4><ul>
<li><strong>转发时：执行到跳转语句时就会立刻跳转</strong></li>
<li><strong>重定向：整个页面执行完之后才执行跳转</strong></li>
</ul>
<h4 id="转发和重定向使用哪一个？"><a href="#转发和重定向使用哪一个？" class="headerlink" title="转发和重定向使用哪一个？"></a>转发和重定向使用哪一个？</h4><p>根据上面说明了转发和重定向的区别也可以很容易概括出来<strong>。转发是带着转发前的请求的参数的。重定向是新的请求</strong>。</p>
<p>典型的应用场景：</p>
<ol>
<li>转发: 访问 Servlet 处理业务逻辑，然后 forward 到 jsp 显示处理结果，浏览器里 URL 不变</li>
<li>重定向: 提交表单，处理成功后 redirect 到另一个 jsp，防止表单重复提交，浏览器里 URL 变了</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94Servlet%EF%BC%88%E4%B8%80%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94Servlet%EF%BC%88%E4%B8%80%EF%BC%89/" class="post-title-link" itemprop="url">JavaWeb学习（三）——Servlet（一）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-17 15:55:44" itemprop="dateCreated datePublished" datetime="2021-09-17T15:55:44Z">2021-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><p>是用Java编写的服务器端程序。其主要功能在于<strong>交互式地浏览和修改数据</strong>，生成动态Web内容。</p>
<p>狭义的Servlet是指Java语言实现的一个接口，广义的Servlet是指任何实现了这个Servlet接口的类。</p>
<p>Servlet运行于支持Java的应用服务器中。从实现上讲，Servlet可以响应任何类型的请求，但绝大多数情况下Servlet只用来扩展基于HTTP协议的Web服务器。</p>
<p>Servlet带给我们最大的作用就是能够<strong>处理浏览器带来HTTP请求，并返回一个响应给浏览器，从而实现浏览器和服务器的交互</strong>。</p>
<h2 id="Servlet的工作模式"><a href="#Servlet的工作模式" class="headerlink" title="Servlet的工作模式"></a>Servlet的工作模式</h2><ul>
<li>客户端发送请求至web服务器</li>
<li>web服务器收到客户端的Servlet访问请求后：<ol>
<li>web服务器检查是否已经装载并创建了该Servlet的实例对象。如果是，则直接执行第④步，否则，执行第②步。</li>
<li>装载并创建该Servlet的一个实例对象。</li>
<li>调用Servlet实例对象的init()方法。</li>
<li>创建一个用于封装HTTP请求消息的HttpServletRequest对象和一个代表HTTP响应消息的HttpServletResponse对象，然后调用Servlet的service()方法并将请求和响应对象作为参数传递进去。</li>
<li>WEB应用程序被停止或重新启动之前，Servlet引擎将卸载Servlet，并在卸载之前调用Servlet的destroy()方法。</li>
</ol>
</li>
<li>服务器将响应返回客户端</li>
</ul>
<h2 id="Servlet的生命周期"><a href="#Servlet的生命周期" class="headerlink" title="Servlet的生命周期"></a>Servlet的生命周期</h2><ol>
<li><strong>加载Servlet</strong>。当Tomcat第一次访问Servlet的时候，<strong>Tomcat会负责创建Servlet的实例</strong></li>
<li><strong>初始化</strong>。当Servlet被实例化后，Tomcat会<strong>调用init()方法初始化这个对象</strong></li>
<li><strong>处理服务</strong>。当浏览器<strong>访问Servlet</strong>的时候，Servlet <strong>会调用service()方法处理请求</strong></li>
<li><strong>销毁</strong>。当Tomcat关闭时或者检测到Servlet要从Tomcat删除的时候会自动调用destroy()方法，<strong>让该实例释放掉所占的资源</strong>。一个Servlet如果长时间不被使用的话，也会被Tomcat自动销毁</li>
<li><strong>卸载</strong>。当Servlet调用完destroy()方法后，等待垃圾回收。如果<strong>有需要再次使用这个Servlet，会重新调用init()方法进行初始化操作</strong>。</li>
</ol>
<ul>
<li>简单总结：<strong>只要访问Servlet，service()就会被调用。init()只有第一次访问Servlet的时候才会被调用。destroy()只有在Tomcat关闭的时候才会被调用。</strong></li>
</ul>
<h2 id="Servlet的特点"><a href="#Servlet的特点" class="headerlink" title="Servlet的特点"></a>Servlet的特点</h2><h3 id="映射关系"><a href="#映射关系" class="headerlink" title="映射关系"></a>映射关系</h3><ul>
<li><p><strong>一个已经注册的Servlet可以被多次映射同一个Servlet可以被映射到多个URL上。</strong></p>
<blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	当浏览器访问http://localhost:8080/Demo1时：</span></span><br><span class="line"><span class="comment">		1、发现Tomcat中的web.xml有配置这个映射路径  &lt;url-pattern&gt;/Demo1&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">		2、查看映射路径的名字 &lt;servlet-name&gt;Demo1&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		3、通过映射路径的名字找到配置servlet的名字 &lt;servlet-name&gt;Demo1&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		4、通过servlet名找到servlet编译后class文件存放的位置</span></span><br><span class="line"><span class="comment">		5、执行MyServlet &lt;servlet-class&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--为Demo1配一个名字，一般都会和类名一致--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--类的存放位置在哪里【有包名的话需要添加上包名】--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>zhongfucheng.web.Demo1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--为Demo1配置映射路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--外界访问Demo1的路径--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Demo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ouzicheng<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">无论我访问的是http://localhost:8080/Demo1还是http://localhost:8080/ouzicheng。我访问的都是Demo1。</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p><strong>Servlet映射的URL可以使用通配符</strong></p>
</li>
<li><p>在servlet3.0以后，web.xml中对Servlet配置，同样可以在@WebServlet注解中配置.<br>下面是@WebServlet的属性列表:</p>
<table>
<thead>
<tr>
<th align="center"><strong>属性名</strong></th>
<th align="center"><strong>类型</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td align="center">String</td>
<td align="center">指定Servlet 的 name 属性，等价于 <code>&lt;servlet-name&gt;</code>。如果没有显式指定，则该 Servlet 的取值即为类的全限定名。</td>
</tr>
<tr>
<td align="center">value</td>
<td align="center">String[]</td>
<td align="center">该属性等价于 urlPatterns 属性。两个属性不能同时使用。</td>
</tr>
<tr>
<td align="center">urlPatterns</td>
<td align="center">String[]</td>
<td align="center">指定一组 Servlet 的 URL 匹配模式。等价于<code>&lt;url-pattern&gt;</code>标签。</td>
</tr>
<tr>
<td align="center">loadOnStartup</td>
<td align="center">int</td>
<td align="center">指定 Servlet 的加载顺序，等价于 <code>&lt;load-on-startup&gt;</code>标签。</td>
</tr>
<tr>
<td align="center">initParams</td>
<td align="center">WebInitParam[]</td>
<td align="center">指定一组 Servlet <strong>初始化参数</strong>，等价于<code>&lt;init-param&gt;</code>标签。</td>
</tr>
<tr>
<td align="center">asyncSupported</td>
<td align="center">boolean</td>
<td align="center">声明 Servlet 是否支持异步操作模式，等价于<code>&lt;async-supported&gt;</code> 标签。</td>
</tr>
<tr>
<td align="center">description</td>
<td align="center">String</td>
<td align="center">该 Servlet 的描述信息，等价于 <code>&lt;description&gt;</code>标签。</td>
</tr>
<tr>
<td align="center">displayName</td>
<td align="center">String</td>
<td align="center">该 Servlet 的显示名，通常配合工具使用，等价于 <code>&lt;display-name&gt;</code>标签。</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="Servlet————单例模式"><a href="#Servlet————单例模式" class="headerlink" title="Servlet————单例模式"></a>Servlet————单例模式</h3><ul>
<li><strong>浏览器多次对Servlet的请求</strong>，一般情况下，<strong>服务器只创建一个Servlet对象</strong>，也就是说，Servlet对象<strong>一旦创建了</strong>，就会<strong>驻留在内存中，为后续的请求做服务，直到服务器关闭</strong>。</li>
<li>在Servlet的整个生命周期内，Servlet的init方法只被调用一次。而对一个Servlet的每次访问请求都导致Servlet引擎调用一次servlet的service方法。</li>
<li>对于<strong>每次访问请求</strong>，Servlet引擎都会<strong>创建一个新的HttpServletRequest请求对象和一个新的HttpServletResponse响应对象</strong>，然后将这两<strong>个对象作为参数传递给它调用的Servlet的service()方法</strong>，<strong>service方法再根据请求方式分别调用doXXX方法</strong>。</li>
</ul>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><ul>
<li><p>通配符有两种格式：</p>
<ol>
<li>*.扩展名</li>
<li>正斜杠（&#x2F;）开头并以“&#x2F;*”结尾。</li>
<li><code>*.</code>扩展名的优先级最低</li>
</ol>
</li>
</ul>
<h3 id="线程安全问题"><a href="#线程安全问题" class="headerlink" title="线程安全问题"></a>线程安全问题</h3><p>当多个用户访问Servlet的时候，<strong>服务器会为每个用户创建一个线程</strong>。<strong>当多个用户并发访问Servlet共享资源的时候就会出现线程安全问题</strong>。</p>
<p>原则：</p>
<ol>
<li>如果一个<strong>变量需要多个用户共享</strong>，则应当在访问该变量的时候，<strong>加同步机制synchronized (对象){}</strong></li>
<li>如果一个变量<strong>不需要共享</strong>，则<strong>直接在 doGet() 或者 doPost()定义</strong>.这样不会存在线程安全问题</li>
</ol>
<h3 id="web资源的访问都需要访问Servlet"><a href="#web资源的访问都需要访问Servlet" class="headerlink" title="web资源的访问都需要访问Servlet"></a>web资源的访问都需要访问Servlet</h3><p>缺省Servlet用于处理所有其他Servlet都不处理的访问请求。</p>
<h3 id="web站点信息配置"><a href="#web站点信息配置" class="headerlink" title="web站点信息配置"></a>web站点信息配置</h3><ul>
<li>web.xml文件支持<strong>对整个站点进行配置参数信息</strong>【<strong>所有Servlet都可以取到该参数信息</strong>】</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>XXX<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="web工程中URL地址的写法"><a href="#web工程中URL地址的写法" class="headerlink" title="web工程中URL地址的写法"></a>web工程中URL地址的写法</h3><p><strong>如果”&#x2F;“是给服务器用的，则代表当前的web工程，如果”&#x2F;“是给浏览器用的，则代表webapps目录。</strong></p>
<h1 id="ServletConfig对象"><a href="#ServletConfig对象" class="headerlink" title="ServletConfig对象"></a>ServletConfig对象</h1><p>此对象可以读取web.xml中配置的初始化参数。</p>
<p>————当servlet配置了初始化参数后，web容器在创建servlet实例对象时，会自动将这些初始化参数封装到ServletConfig对象中，并在调用servlet的init方法时，将ServletConfig对象传递给servlet。</p>
<p>参数信息放置在web.xml中可以方便修改。</p>
<h1 id="ServletContext对象"><a href="#ServletContext对象" class="headerlink" title="ServletContext对象"></a>ServletContext对象</h1><p>当Tomcat启动的时候，就会创建一个ServletContext对象。它<strong>代表着当前web站点</strong></p>
<ul>
<li><strong>所有Servlet都共享着一个ServletContext对象</strong>，所以<strong>Servlet之间可以通过ServletContext实现通讯</strong>。</li>
<li>ServletConfig获取的是配置的是单个Servlet的参数信息，<strong>ServletContext可以获取的是配置整个web站点的参数信息</strong></li>
<li><strong>利用ServletContext读取web站点的资源文件</strong></li>
<li>实现Servlet的转发【用ServletContext转发不多，主要用request转发】</li>
</ul>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="多个Servlet通过ServletContext对象实现数据共享"><a href="#多个Servlet通过ServletContext对象实现数据共享" class="headerlink" title="多个Servlet通过ServletContext对象实现数据共享"></a>多个Servlet通过ServletContext对象实现数据共享</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ServletContextDemo1：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;xdp_gacl&quot;</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ServletConfig对象中维护了ServletContext对象的引用，开发人员在编写servlet时，</span></span><br><span class="line"><span class="comment">         * 可以通过ServletConfig.getServletContext方法获得ServletContext对象。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletConfig().getServletContext();<span class="comment">//获得ServletContext对象</span></span><br><span class="line">        context.setAttribute(<span class="string">&quot;data&quot;</span>, data);  <span class="comment">//将data存储到ServletContext对象中</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ServletContextDemo2：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo2</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> (String) context.getAttribute(<span class="string">&quot;data&quot;</span>);<span class="comment">//从ServletContext对象中取出数据</span></span><br><span class="line">        response.getWriter().print(<span class="string">&quot;data=&quot;</span>+data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实现的功能：先运行ServletContextDemo1，将数据data存储到ServletContext对象中，然后运行ServletContextDemo2就可以从ServletContext对象中取出数据了，这样就实现了数据共享</span></span><br></pre></td></tr></table></figure>

<h3 id="获取WEB应用的初始化参数"><a href="#获取WEB应用的初始化参数" class="headerlink" title="获取WEB应用的初始化参数"></a>获取WEB应用的初始化参数</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置WEB应用的初始化参数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>url<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line">        <span class="comment">//获取整个web站点的初始化参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contextInitParam</span> <span class="operator">=</span> context.getInitParameter(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        response.getWriter().print(contextInitParam);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="用servletContext实现请求转发"><a href="#用servletContext实现请求转发" class="headerlink" title="用servletContext实现请求转发"></a>用servletContext实现请求转发</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ServletContextDemo4：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo4</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;&lt;h1&gt;&lt;font color=&#x27;red&#x27;&gt;abcdefghjkl&lt;/font&gt;&lt;/h1&gt;&quot;</span>;</span><br><span class="line">        response.getOutputStream().write(data.getBytes());</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();<span class="comment">//获取ServletContext对象</span></span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">rd</span> <span class="operator">=</span> context.getRequestDispatcher(<span class="string">&quot;/servlet/ServletContextDemo5&quot;</span>);<span class="comment">//获取请求转发对象(RequestDispatcher)</span></span><br><span class="line">        rd.forward(request, response);<span class="comment">//调用forward方法实现请求转发</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ServletContextDemo5：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo5</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        response.getOutputStream().write(<span class="string">&quot;servletDemo5&quot;</span>.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//浏览器访问ServletContextDemo4，浏览显示的却是ServletContextDemo5的内容</span></span><br></pre></td></tr></table></figure>

<h3 id="利用ServletContext对象读取资源文件"><a href="#利用ServletContext对象读取资源文件" class="headerlink" title="利用ServletContext对象读取资源文件"></a>利用ServletContext对象读取资源文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用servletContext读取资源文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> gacl</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContextDemo6</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * response.setContentType(&quot;text/html;charset=UTF-8&quot;);目的是控制浏览器用UTF-8进行解码；</span></span><br><span class="line"><span class="comment">         * 这样就不会出现中文乱码了</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;content-type&quot;</span>,<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        readSrcDirPropCfgFile(response);<span class="comment">//读取src目录下的properties配置文件</span></span><br><span class="line">        response.getWriter().println(<span class="string">&quot;&lt;hr/&gt;&quot;</span>);</span><br><span class="line">        readWebRootDirPropCfgFile(response);<span class="comment">//读取WebRoot目录下的properties配置文件</span></span><br><span class="line">        response.getWriter().println(<span class="string">&quot;&lt;hr/&gt;&quot;</span>);</span><br><span class="line">        readPropCfgFile(response);<span class="comment">//读取src目录下的db.config包中的db3.properties配置文件</span></span><br><span class="line">        response.getWriter().println(<span class="string">&quot;&lt;hr/&gt;&quot;</span>);</span><br><span class="line">        readPropCfgFile2(response);<span class="comment">//读取src目录下的gacl.servlet.study包中的db4.properties配置文件</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取src目录下的gacl.servlet.study包中的db4.properties配置文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readPropCfgFile2</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getResourceAsStream(<span class="string">&quot;/WEB-INF/classes/gacl/servlet/study/db4.properties&quot;</span>);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        response.getWriter().println(<span class="string">&quot;读取src目录下的gacl.servlet.study包中的db4.properties配置文件：&quot;</span>);</span><br><span class="line">        response.getWriter().println(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        <span class="string">&quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;</span>,</span><br><span class="line">                        driver,url, username, password));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取src目录下的db.config包中的db3.properties配置文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readPropCfgFile</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> FileNotFoundException, IOException &#123;</span><br><span class="line">        <span class="comment">//通过ServletContext获取web资源的绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getRealPath(<span class="string">&quot;/WEB-INF/classes/db/config/db3.properties&quot;</span>);</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        response.getWriter().println(<span class="string">&quot;读取src目录下的db.config包中的db3.properties配置文件：&quot;</span>);</span><br><span class="line">        response.getWriter().println(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        <span class="string">&quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;</span>,</span><br><span class="line">                        driver,url, username, password));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ServletContext对象读取WebRoot目录下的properties配置文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readWebRootDirPropCfgFile</span><span class="params">(HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 通过ServletContext对象读取WebRoot目录下的properties配置文件</span></span><br><span class="line"><span class="comment">         * “/”代表的是项目根目录</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getResourceAsStream(<span class="string">&quot;/db2.properties&quot;</span>);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        response.getWriter().println(<span class="string">&quot;读取WebRoot目录下的db2.properties配置文件：&quot;</span>);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        <span class="string">&quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;</span>,</span><br><span class="line">                        driver,url, username, password));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ServletContext对象读取src目录下的properties配置文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readSrcDirPropCfgFile</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 通过ServletContext对象读取src目录下的db1.properties配置文件</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext().getResourceAsStream(<span class="string">&quot;/WEB-INF/classes/db1.properties&quot;</span>);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> prop.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        response.getWriter().println(<span class="string">&quot;读取src目录下的db1.properties配置文件：&quot;</span>);</span><br><span class="line">        response.getWriter().println(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        <span class="string">&quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;</span>,</span><br><span class="line">                        driver,url, username, password));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在客户端缓存Servlet的输出"><a href="#在客户端缓存Servlet的输出" class="headerlink" title="在客户端缓存Servlet的输出"></a>在客户端缓存Servlet的输出</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo5</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;abcddfwerwesfasfsadf&quot;</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 设置数据合理的缓存时间值，以避免浏览器频繁向服务器发送请求，提升服务器的性能</span></span><br><span class="line"><span class="comment">         * 这里是将数据的缓存时间设置为1天</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        response.setDateHeader(<span class="string">&quot;expires&quot;</span>,System.currentTimeMillis() + <span class="number">24</span> * <span class="number">3600</span> * <span class="number">1000</span>);</span><br><span class="line">        response.getOutputStream().write(data.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94http/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94http/" class="post-title-link" itemprop="url">JavaWeb学习（二）——http</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-17 15:25:45" itemprop="dateCreated datePublished" datetime="2021-09-17T15:25:45Z">2021-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="常用响应头"><a href="#常用响应头" class="headerlink" title="常用响应头"></a>常用响应头</h2><blockquote>
<p>　　HTTP响应中的常用响应头(消息头)<br>　　Location: 服务器通过这个头，来告诉浏览器跳到哪里<br>　　Server：服务器通过这个头，告诉浏览器服务器的型号<br>　　Content-Encoding：服务器通过这个头，告诉浏览器，数据的压缩格式<br>　　Content-Length: 服务器通过这个头，告诉浏览器回送数据的长度<br>　　Content-Language: 服务器通过这个头，告诉浏览器语言环境<br>　　Content-Type：服务器通过这个头，告诉浏览器回送数据的类型<br>　　Refresh：服务器通过这个头，告诉浏览器定时刷新<br>　　Content-Disposition: 服务器通过这个头，告诉浏览器以下载方式打数据<br>　　Transfer-Encoding：服务器通过这个头，告诉浏览器数据是以分块方式回送的<br>　　Expires: -1  控制浏览器不要缓存<br>　　Cache-Control: no-cache<br>　　Pragma: no-cache</p>
</blockquote>
<h2 id="常用的状态码简述"><a href="#常用的状态码简述" class="headerlink" title="常用的状态码简述"></a>常用的状态码简述</h2><ul>
<li>2XX</li>
</ul>
<blockquote>
<p>一般是请求成功</p>
<p>200 正常处理</p>
<p>204 成功处理，但服务器没有新数据返回，显示页面不更新</p>
<p>206 对服务器进行范围请求，只返回一部分数据</p>
</blockquote>
<ul>
<li>3XX</li>
</ul>
<blockquote>
<p>一般表示重定向</p>
<p>301 请求的资源已分配了新的URI中，URL地址改变了。【永久重定向】</p>
<p>302 请求的资源临时分配了新的URI中，URL地址没变【临时重定向】</p>
<p>303 与302相同的功能，但明确客户端应该采用GET方式来获取资源</p>
<p>304 发送了附带请求，但不符合条件【返回未过期的缓存数据】</p>
<p>307 与302相同，但不会把POST请求变成GET</p>
</blockquote>
<ul>
<li>4XX</li>
</ul>
<blockquote>
<p>表示客户端出错了。</p>
<p>400 请求报文语法错误了</p>
<p>401 需要认证身份</p>
<p>403 没有权限访问</p>
<p>404 服务器没有这个资源</p>
</blockquote>
<ul>
<li>5XX</li>
</ul>
<blockquote>
<p>服务器出错了</p>
<p>500 内部资源出错了</p>
<p>503 服务器正忙</p>
</blockquote>
<h2 id="HTTP版本区别"><a href="#HTTP版本区别" class="headerlink" title="HTTP版本区别"></a>HTTP版本区别</h2><p>HTTP1.0和HTTP1.1最主要的区别就是：</p>
<ul>
<li>HTTP1.1默认是<strong>持久化连接</strong>！</li>
</ul>
<p>相对于持久化连接还有另外比较重要的改动：</p>
<ul>
<li>HTTP 1.1增加host字段</li>
<li>HTTP 1.1中引入了<code>Chunked transfer-coding</code>，范围请求，实现断点续传(实际上就是利用HTTP消息头使用分块传输编码，将实体主体分块传输)</li>
<li>HTTP 1.1管线化(pipelining)理论，客户端可以同时发出多个HTTP请求，而不用一个个等待响应之后再请求<ul>
<li>注意：这个pipelining仅仅是<strong>限于理论场景下</strong>，大部分桌面浏览器仍然会<strong>选择默认关闭</strong>HTTP pipelining！</li>
<li>所以现在使用HTTP1.1协议的应用，都是有<strong>可能会开多个TCP连接</strong>的！</li>
</ul>
</li>
</ul>
<p>参考资料：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://www.cnblogs.com/gofighting/p/5421890.html">https://www.cnblogs.com/gofighting/p/5421890.html</a></li>
</ul>
<h2 id="HTTP2基础"><a href="#HTTP2基础" class="headerlink" title="HTTP2基础"></a>HTTP2基础</h2><p>直观比较一下HTTP2和HTTP1.1的区别：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://http2.akamai.com/demo">https://http2.akamai.com/demo</a></li>
</ul>
<p><img src="https://i.loli.net/2021/09/14/UXknmSPOwJeyB2A.gif"></p>
<p>HTTP 1.1提出了管线化(pipelining)理论，但是仅仅是限于理论的阶段上，这个功能默认还是关闭了的。</p>
<p>管线化(pipelining)和非管线化的<strong>区别</strong>：</p>
<p><img src="https://i.loli.net/2021/09/14/ouql5HgXjWaQxtF.jpg"></p>
<blockquote>
<p>HTTP Pipelining其实是把多个HTTP请求放到一个TCP连接中一一发送，而在发送过程中不需要等待服务器对前一个请求的响应；只不过，<strong>客户端还是要按照发送请求的顺序来接收响应！</strong></p>
</blockquote>
<p>HTTP1.1新改动：</p>
<ul>
<li><strong>持久连接</strong></li>
<li>请求管道化</li>
<li>增加缓存处理（新的字段如cache-control）</li>
<li>增加Host字段、支持断点传输等</li>
</ul>
<p>HTTP2新改动：</p>
<ul>
<li>二进制分帧</li>
<li><strong>多路复用</strong></li>
<li>头部压缩</li>
<li>服务器推送</li>
</ul>
<p>参考资料：</p>
<ul>
<li>HTTP2 GitBook电子书(中文版)：<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://legacy.gitbook.com/book/ye11ow/http2-explained/details">https://legacy.gitbook.com/book/ye11ow/http2-explained/details</a></li>
<li>HTTP&#x2F;2.0 相比1.0有哪些重大改进？<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://www.zhihu.com/question/34074946">https://www.zhihu.com/question/34074946</a></li>
<li>HTTP&#x2F;2 新特性浅析：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000002765886">https://segmentfault.com/a/1190000002765886</a></li>
<li>HTTP2学习资料：<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://imququ.com/post/http2-resource.html">https://imququ.com/post/http2-resource.html</a></li>
<li>HTTP2简介和基于HTTP2的Web优化：<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=http://caibaojian.com/toutiao/6641">http://caibaojian.com/toutiao/6641</a></li>
<li>http2原理入门：<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://blog.qingf.me/?p=600">https://blog.qingf.me/?p=600</a></li>
<li>HTTP&#x2F;2 对现在的网页访问，有什么大的优化呢？体现在什么地方？<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=https://www.zhihu.com/question/24774343/answer/96586977">https://www.zhihu.com/question/24774343/answer/96586977</a></li>
<li>HTTP&#x2F;2笔记之流和多路复用：<a target="_blank" rel="noopener" href="https://link.segmentfault.com/?url=http://www.blogjava.net/yongboy/archive/2015/03/19/423611.aspx">http://www.blogjava.net/yongboy/archive/2015/03/19/423611.aspx</a></li>
</ul>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>使用了SSL建立安全的通信线路。</p>
<p>HTTPS使用的是共享密钥和公开私有密钥混合来进行加密的。由于公开私有密钥需要太多的资源，不可能一直以公开私有密钥进行通信。因此，<strong>HTTP在建立通信线路的时候使用公开私有密钥，当建立完连接后，随后就使用共享密钥进行加密和解密了</strong></p>
<blockquote>
<ul>
<li>对称加密：<ul>
<li>加密和解密都是用同一个密钥</li>
</ul>
</li>
<li>非对称加密：<ul>
<li>加密用公开的密钥，解密用私钥</li>
<li>(私钥只有自己知道，公开的密钥大家都知道)</li>
</ul>
</li>
<li>数字签名：<ul>
<li>验证传输的内容<strong>是对方发送的数据</strong></li>
<li>发送的数据<strong>没有被篡改过</strong></li>
</ul>
</li>
<li>数字证书 (Certificate)<ul>
<li>认证机构证明是<strong>真实的服务器发送的数据</strong>。</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013271378">HTTP面试题都在这里 - SegmentFault 思否</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E7%AE%80%E4%BB%8B+Tomcat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/17/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E7%AE%80%E4%BB%8B+Tomcat/" class="post-title-link" itemprop="url">JavaWeb学习（一）——简介—+Tomcat</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-17 15:20:56" itemprop="dateCreated datePublished" datetime="2021-09-17T15:20:56Z">2021-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="javaWeb简介"><a href="#javaWeb简介" class="headerlink" title="javaWeb简介"></a>javaWeb简介</h1><p>Java web，是用java技术来解决相关web互联网领域的技术的总称。web包括：web服务器和web客户端两部分。</p>
<p>web资源分类：</p>
<p>所谓web资源即放在Internet网上供外界访问的文件或程序，又根据它们呈现的效果及原理不同，将它们划分为静态资源和动态资源。</p>
<ul>
<li><p>静态web资源：固定不变数据文件（静态网页 HTML、CSS文件、文本、音频、视频）</p>
</li>
<li><p>静态web技术：HTML+CSS+JavaScript</p>
</li>
<li><p>动态web资源：一段服务程序，运行后，生成的数据文件</p>
</li>
<li><p>动态web技术：servlet，jsp，php， .net ,ruby、python等等</p>
</li>
</ul>
<p>常见的web服务器：</p>
<blockquote>
<p>Tomcat：由Apache组织提供的一种Web服务器，提供对jsp和Servlet的支持。它是一种轻量级的javaWeb容器（服务器），也是当前应用最广的JavaWeb服务器（免费）。<br>Jboss：是一个遵从JavaEE规范的、开放源代码的、纯Java的EJB服务器，它支持所有的JavaEE规范（免费）。<br>GlassFish： 由Oracle公司开发的一款JavaWeb服务器，是一款强健的商业服务器，达到产品级质量（应用很少，收费）。<br>Resin：是CAUCHO公司的产品，是一个非常流行的应用服务器，对servlet和JSP提供了良好的支持，性能也比较优良，resin自身采用JAVA语言开发（收费，应用比较多）。<br>WebLogic：是Oracle公司的产品，是目前应用最广泛的Web服务器，支持JavaEE规范，而且不断的完善以适应新的开发要求，适合大型项目（收费，用的不多，适合大公司）。</p>
</blockquote>
<h2 id="JAVAWEB目录结构"><a href="#JAVAWEB目录结构" class="headerlink" title="JAVAWEB目录结构"></a>JAVAWEB目录结构</h2><p><img src="https://i.loli.net/2021/08/31/n1K9YAmo6TdqF3M.png"></p>
<p>以上图说明：</p>
<ul>
<li>bbs目录代表一个web应用</li>
<li>bbs目录下的html,jsp文件可以直接被浏览器访问</li>
<li><strong>WEB-INF目录下的资源是不能直接被浏览器访问的</strong></li>
<li>web.xml文件是web程序的主要配置文件</li>
<li>所有的classes文件都放在classes目录下</li>
<li>jar文件放在lib目录下</li>
</ul>
<h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><p>是一个运行java的网络<strong>服务器</strong>，在中小型系统和并发量小的场合下被普遍使用，是开发和调试Servlet、JSP 程序的首选。</p>
<p><img src="https://i.loli.net/2021/08/26/yMknVOF26t7J8K4.png" alt="img"></p>
<h2 id="tomcat体系结构"><a href="#tomcat体系结构" class="headerlink" title="tomcat体系结构"></a>tomcat体系结构</h2><p><img src="https://i.loli.net/2021/08/30/YBJksmbM7TN2pCV.png"></p>
<p>Tomcat中最顶层的容器是Server，代表着整个服务器，从上图中可以看出，一个Server可以包含至少一个Service，即可以包含多个Service，用于具体提供服务。</p>
<p>Service主要包含两个部分：Connector和Container。从上图中可以看出 Tomcat 的心脏就是这两个组件，他们的作用如下：</p>
<ul>
<li>Connector用于处理连接相关的事情，并提供Socket与Request请求和Response响应相关的转化;</li>
<li>Container用于封装和管理Servlet，以及具体处理Request请求；</li>
</ul>
<p>一个Tomcat中只有一个Server，一个Server可以包含多个Service，一个Service只有一个Container，但是可以有多个Connectors，这是因为一个服务可以有多个连接，如同时提供Http和Https链接，也可以提供向相同协议不同端口的连接</p>
<p>多个 Connector 和一个 Container 就形成了一个 Service，有了 Service 就可以对外提供服务了，但是 Service 还要一个生存的环境，必须要有人能够给她生命、掌握其生死大权，那就非 Server 莫属了！所以整个 Tomcat 的生命周期由 Server 控制。</p>
<h2 id="Tomcat-有哪几种Connector-运行模式-优化-？"><a href="#Tomcat-有哪几种Connector-运行模式-优化-？" class="headerlink" title="Tomcat 有哪几种Connector 运行模式(优化)？"></a>Tomcat 有哪几种Connector 运行模式(优化)？</h2><h3 id="BIO：同步并阻塞"><a href="#BIO：同步并阻塞" class="headerlink" title="BIO：同步并阻塞"></a>BIO：同步并阻塞</h3><p>一个线程处理一个请求。缺点：并发量高时，线程数较多，浪费资源。Tomcat7或以下，在Linux系统中默认使用这种方式。</p>
<h3 id="NIO：同步非阻塞IO"><a href="#NIO：同步非阻塞IO" class="headerlink" title="NIO：同步非阻塞IO"></a>NIO：同步非阻塞IO</h3><p>利用Java的异步IO处理，可以通过少量的线程处理大量的请求，可以复用同一个线程处理多个connection(多路复用)。Tomcat8在Linux系统中默认使用这种方式。</p>
<h3 id="APR：即Apache-Portable-Runtime"><a href="#APR：即Apache-Portable-Runtime" class="headerlink" title="APR：即Apache Portable Runtime"></a>APR：即Apache Portable Runtime</h3><p>从操作系统层面解决io阻塞问题。</p>
<p>Tomcat有几种部署方式？<br>Tomcat容器是如何创建servlet类实例？用到了什么原理？</p>
<ol>
<li>当容器启动时，会读取在webapps目录下所有的web应用中的web.xml文件，然后对 xml文件进行解析，并读取servlet注册信息。然后，将每个应用中注册的servlet类都进行加载，并通过 反射的方式实例化。（有时候也是在第一次请求时实例化）</li>
<li>在servlet注册时加上1如果为正数，则在一开始就实例化，如果不写或为负数，则第一次请求实例化。</li>
</ol>
<p>浏览器访问web资源的流程图</p>
<p><img src="https://i.loli.net/2021/08/30/mbWCsLRuD1UEPvB.png"></p>
<p>有关配置虚拟目录、临时域名、虚拟主机见：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013122831">参考文献</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3744053.html">JavaWeb学习总结(三)——Tomcat服务器学习和使用(二) - 孤傲苍狼 - 博客园 (cnblogs.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/14/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94XML%E5%92%8CJSON/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/14/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E2%80%94%E2%80%94XML%E5%92%8CJSON/" class="post-title-link" itemprop="url">JavaWeb学习（十三）——XML和JSON</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-13 17:03:17" itemprop="dateCreated datePublished" datetime="2021-09-13T17:03:17Z">2021-09-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><p>xml数据或者xml文档只用于组织、存储数据。</p>
<ul>
<li>为xml定规则：使用DTD或Schema技术</li>
<li>解析xml数据：使用DOM或SAX技术</li>
<li>提供样式：XSLT可扩展样是转换语言</li>
</ul>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="文档声明"><a href="#文档声明" class="headerlink" title="文档声明"></a>文档声明</h3><ul>
<li>XML声明放在XML的第一行</li>
<li>version—-版本</li>
<li>encoding–编码</li>
<li>standalone–独立使用–默认是no。standalone表示该xml是不是独立的，如果是yes，则表示这个XML文档时独立的，不能引用外部的DTD规范文件；如果是no，则该XML文档不是独立的，表示可以引用外部的DTD规范文档。</li>
<li>正确的文档声明格式，属性的位置不能改变！</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h3><p>首先在这里说明一个概念：<strong>在XML中元素和标签指的是同一个东西！不要被不同的名称所迷惑了！</strong></p>
<p>元素中需要值得注意的地方：</p>
<ul>
<li>XML元素中的出现的空格和换行都会被当做元素内容进行处理</li>
<li>每个XML文档必须有且只有一个根元素</li>
<li>元素必须闭合</li>
<li>大小写敏感</li>
<li>不能交叉嵌套</li>
<li>不能以数字开头</li>
</ul>
<p>看起来好像有很多需要值得注意的地方，其实只需要记住：<strong>XML的语法是规范的！不要随意乱写！</strong></p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>属性是作为XML元素中的一部分的，命名规范也是和XML元素一样的！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--属性名是name，属性值是china--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">中国</span> <span class="attr">name</span>=<span class="string">&quot;china&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">中国</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p><strong>注释和HTML的注释是一样的</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!----&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="CDATA"><a href="#CDATA" class="headerlink" title="CDATA"></a>CDATA</h3><p>在编写XML文件时，有些内容可能不想让解析引擎解析执行，而是当作原始内容处理。遇到此种情况，可以把这些内容放在CDATA区里，对于CDATA区域内的内容，XML解析程序不会处理，而是直接原封不动的输出</p>
<p>语法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;![CDATA[</span><br><span class="line">    ...内容</span><br><span class="line">]]&gt;</span><br></pre></td></tr></table></figure>

<h3 id="处理指令"><a href="#处理指令" class="headerlink" title="处理指令"></a>处理指令</h3><p>处理指令，简称PI （processing instruction）。处理指令用来指挥解析引擎如何解析XML文档内容。</p>
<p>例如：</p>
<p>在XML文档中可以使用xml-stylesheet指令，通知XML解析引擎，应用css文件显示xml文档内容。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;1.css&quot;</span>?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>XML代码：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;1.css&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">china</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">guangzhou</span>&gt;</span></span><br><span class="line">        广州</span><br><span class="line">    <span class="tag">&lt;/<span class="name">guangzhou</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">shenzhen</span>&gt;</span></span><br><span class="line">        深圳</span><br><span class="line">    <span class="tag">&lt;/<span class="name">shenzhen</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">china</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>CSS代码：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">guangzhou&#123;</span><br><span class="line">    font-size: 40px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>效果：</li>
</ul>
<p><img src="https://i.loli.net/2021/09/14/9SIbOmX3aJur2vo.png" alt="img"></p>
<h1 id="JDK中的XML-API"><a href="#JDK中的XML-API" class="headerlink" title="JDK中的XML API"></a>JDK中的XML API</h1><p>①：JAXP（The Java API For XML Processing)：主要负责解析XML</p>
<p>②：JAXB（Java Architecture for XML Binding)：主要负责将XML映射为Java对象</p>
<h2 id="XML解析"><a href="#XML解析" class="headerlink" title="XML解析"></a>XML解析</h2><p>XML解析就是读取XML的数据！</p>
<h3 id="解析方式"><a href="#解析方式" class="headerlink" title="解析方式"></a>解析方式</h3><p>XML解析方式分为两种：</p>
<p>①：dom(Document Object Model)文档对象模型，是W3C组织推荐解析XML的一种方式</p>
<p>②：sax(Simple API For XML)，它是XML社区的标准，几乎所有XML解析器都支持它！</p>
<p><img src="https://i.loli.net/2021/09/14/aPnvBl8ZEtDdw6u.png"></p>
<p>常用的解析器和解析开发包的关系如下所示：</p>
<p><img src="https://i.loli.net/2021/09/14/LGhW3AzUJvqfHSy.png"></p>
<ul>
<li>jaxp是jdk自带的，无需导入开发包</li>
<li>jdom需要导入开发包</li>
<li>dom4j是用的最多的，需要导入开发包</li>
</ul>
<h2 id="jaxp"><a href="#jaxp" class="headerlink" title="jaxp"></a>jaxp</h2><h3 id="DOM解析操作"><a href="#DOM解析操作" class="headerlink" title="DOM解析操作"></a>DOM解析操作</h3><blockquote>
<p>DOM解析是一个基于对象的API，它把XML的内容加载到内存中，生成与XML文档内容对应的模型！当解析完成，内存中会生成与XML文档的结构与之对应的DOM对象树，这样就能够根据树的结构，以节点的形式对文档进行操作！</p>
</blockquote>
<p><img src="https://i.loli.net/2021/09/14/K8txMdaeUW59su7.png"></p>
<p><strong>在DOM解析中有几个核心的操作接口：</strong></p>
<ul>
<li><strong>Document【代表整个XML文档，通过Document节点可以访问XML文件中所有的元素内容！】</strong></li>
<li><strong>Node【Node节点几乎在XML操作接口中几乎相当于普通Java类的Object，很多核心接口都实现了它！】</strong></li>
<li><strong>NodeList【代表着一个节点的集合，通常是一个节点中子节点的集合！】</strong></li>
<li>NameNodeMap【表示一组节点和其唯一名称对应的一一对应关系，主要用于属性节点的表示】</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013252686">XML就是这么简单 - SegmentFault 思否</a></p>
<h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>JSON：<strong>JavaScript Object Notation</strong> 【JavaScript 对象表示法】</p>
<p>JSON 是存储和交换文本信息的语法。类似 XML。</p>
<p>JSON采用完全独立于任何程序语言的文本格式，使JSON成为理想的数据交换语言。</p>
<p><strong>JSON 比 XML 更小、更快，更易解析</strong>。</p>
<ul>
<li>javaScript原生支持JSON，解析速度会很快</li>
<li>XML解析成DOM对象的时候，浏览器【IE和fireFox】会有差异</li>
<li>使用JSON会更简单</li>
</ul>
<h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><p>JSON所表示的数据要么就是对象，要么就是数据</p>
<p>JSON语法是javaScript语法的子集，<strong>javaScript用[]中括号来表示数组，用{}大括号来表示对象，JSON亦是如此。</strong></p>
<h3 id="JSON数组"><a href="#JSON数组" class="headerlink" title="JSON数组"></a>JSON数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> employees = [</span><br><span class="line">&#123; <span class="string">&quot;firstName&quot;</span>:<span class="string">&quot;Bill&quot;</span> , <span class="string">&quot;lastName&quot;</span>:<span class="string">&quot;Gates&quot;</span> &#125;,</span><br><span class="line">&#123; <span class="string">&quot;firstName&quot;</span>:<span class="string">&quot;George&quot;</span> , <span class="string">&quot;lastName&quot;</span>:<span class="string">&quot;Bush&quot;</span> &#125;,</span><br><span class="line">&#123; <span class="string">&quot;firstName&quot;</span>:<span class="string">&quot;Thomas&quot;</span> , <span class="string">&quot;lastName&quot;</span>: <span class="string">&quot;Carter&quot;</span> &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h3 id="JSON对象"><a href="#JSON对象" class="headerlink" title="JSON对象"></a>JSON对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">str</span>: <span class="string">&quot;zhongfucheng&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;我爱学习&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>当然啦，数组可以包含对象，在对象中也可以包含数组</strong></p>
<h3 id="解析JSON"><a href="#解析JSON" class="headerlink" title="解析JSON"></a>解析JSON</h3><p><strong>使用eval()函数来解析JSON，把JSON文本数据转换成一个JavaScript对象。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">           <span class="comment">//在写JOSN的时候，记得把带上逗号</span></span><br><span class="line">           <span class="keyword">var</span> txt = <span class="string">&quot;&#123;a:123,&quot;</span> +</span><br><span class="line">                   <span class="string">&quot;b:&#x27;zhongfucheng&#x27;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">           <span class="comment">//使用eval解析JSON字符串，需要增添()</span></span><br><span class="line">           <span class="keyword">var</span> aa = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span> + txt + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">           <span class="title function_">alert</span>(aa);</span><br><span class="line"></span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/09/14/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94AJAX/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/14/JavaWeb%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94AJAX/" class="post-title-link" itemprop="url">JavaWeb学习（十二）——AJAX</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-13 17:03:04" itemprop="dateCreated datePublished" datetime="2021-09-13T17:03:04Z">2021-09-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/javaweb/" itemprop="url" rel="index"><span itemprop="name">javaweb</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h1><p>AJAX即“Asynchronous Javascript And XML”，是指一种创建交互式网页应用的网页开发技术。AJAX 是一种用于创建快速动态网页的技术。它可以令开发者只向服务器获取数据（而不是图片，HTML文档等资源），互联网资源的传输变得前所未有的轻量级和纯粹。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/12/24/167e05bddfd8dce9~tplv-t2oaga2asx-watermark.awebp" alt="img"></p>
<p>Ajax实际上是下面这几种技术的融合：</p>
<ol>
<li>XHTML和CSS的基于标准的表示技术</li>
<li>DOM进行动态显示和交互</li>
<li>XML和XSLT进行数据交换和处理</li>
<li>XMLHttpRequest进行异步数据检索</li>
<li>Javascript将以上技术融合在一起</li>
</ol>
<p><strong>客户端与服务器，可以在【不必刷新整个浏览器】的情况下，与服务器进行异步通讯的技术</strong></p>
<p>————<strong>可以进行局部刷新</strong></p>
<h2 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest"></a>XMLHttpRequest</h2><p>浏览器是先把请求发送到XMLHttpRequest异步对象之中，异步对象对请求进行封装，然后再发送给服务器。<strong>服务器并不是以转发的方式响应，而是以流的方式把数据返回给浏览器</strong></p>
<p>XMLHttpRequest异步对象会不停监听服务器状态的变化，得到服务器返回的数据，就写到浏览器上【因为不是转发的方式，所以是无刷新就能够获取服务器端的数据】</p>
<h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><ul>
<li><strong>open()</strong>(<strong>String method,String url,boolean asynch</strong>,String username,String password)</li>
<li><strong>send(content)</strong></li>
<li><strong>setRequestHeader(String header,String value)</strong></li>
<li>getAllResponseHeaders()</li>
<li>getResponseHeader(String header)</li>
<li>abort()</li>
</ul>
<p><strong>常用的方法就是黑色粗体的前三个</strong></p>
<ul>
<li><strong>open()：该方法创建http请求</strong><ul>
<li><strong>第一个参数是指定提交方式(post、get)</strong></li>
<li><strong>第二个参数是指定要提交的地址是哪</strong></li>
<li><strong>第三个参数是指定是异步还是同步(true表示异步，false表示同步)</strong></li>
<li>第四和第五参数在http认证的时候会用到。是可选的</li>
</ul>
</li>
<li><strong>setRequestHeader(String header,String value)：设置消息头（使用post方式才会使用到，get方法并不需要调用该方法）</strong><ul>
<li><strong>xmlhttp.setRequestHeader(“Content-type”,”application&#x2F;x-www-form-urlencoded”);</strong></li>
</ul>
</li>
<li><strong>send(content)：发送请求给服务器</strong><ul>
<li><strong>如果是get方式，并不需要填写参数，或填写null</strong></li>
<li><strong>如果是post方式，把要提交的参数写上去</strong></li>
</ul>
</li>
</ul>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><ul>
<li><p><strong>onreadystatechange：请求状态改变的事件触发器（readyState变化时会调用此方法），一般用于指定回调函数</strong></p>
</li>
<li><p><strong>readyState：请求状态readyState一改变，回调函数被调用，它有5个状态</strong></p>
<ul>
<li>0：未初始化</li>
<li>1：open方法成功调用以后</li>
<li>2：服务器已经应答客户端的请求</li>
<li>3：交互中。Http头信息已经接收，响应数据尚未接收。</li>
<li><strong>4：完成。数据接收完成</strong></li>
</ul>
</li>
<li><p><strong>responseText：服务器返回的文本内容</strong></p>
</li>
<li><p><strong>responseXML：服务器返回的兼容DOM的XML内容</strong></p>
</li>
<li><p><strong>status：服务器返回的状态码</strong></p>
</li>
<li><p>statusText：服务器返回状态码的文本信息</p>
</li>
</ul>
<h2 id="ajax的使用"><a href="#ajax的使用" class="headerlink" title="ajax的使用"></a>ajax的使用</h2><h3 id="创建XMLHttpRequest对象"><a href="#创建XMLHttpRequest对象" class="headerlink" title="创建XMLHttpRequest对象"></a>创建XMLHttpRequest对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> httpRequest;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在IE6以上的版本以及其他内核的浏览器(Mozilla)等</span></span><br><span class="line">        httpRequest = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在IE6以下的版本</span></span><br><span class="line">        httpRequest = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="向服务器发送请求"><a href="#向服务器发送请求" class="headerlink" title="向服务器发送请求"></a>向服务器发送请求</h3><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">1</span>. xhr.open(<span class="keyword">method</span>,<span class="title function_">url</span>,<span class="title function_">async</span>);  </span><br><span class="line">    <span class="number">2</span>. send(string)<span class="punctuation">;</span><span class="comment">//post请求时才使用字符串参数，否则不用带参数。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">method</span>：请求的类型；<span class="title function_">GET</span> 或 <span class="title function_">POST</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">url</span>：文件在服务器上的位置</span><br><span class="line"></span><br><span class="line"><span class="title function_">async</span>：<span class="title function_">true</span>（异步）或 <span class="title function_">false</span>（同步） 注意：<span class="title function_">post</span>请求一定要设置请求头的格式内容</span><br></pre></td></tr></table></figure>



<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="built_in">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;test.html&quot;</span>,<span class="literal">true</span>);  </span><br><span class="line">xhr.setRequestHeader(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);  </span><br><span class="line">xhr.<span class="built_in">send</span>(<span class="string">&quot;fname=Henry&amp;lname=Ford&quot;</span>); <span class="comment"> //post请求参数放在send里面，即请求体</span></span><br></pre></td></tr></table></figure>

<h3 id="服务器响应处理"><a href="#服务器响应处理" class="headerlink" title="服务器响应处理"></a>服务器响应处理</h3><p>responseText    获得字符串形式的响应数据。</p>
<p>responseXML   获得XML 形式的响应数据。</p>
<h4 id="①同步处理"><a href="#①同步处理" class="headerlink" title="①同步处理"></a>①同步处理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;info.txt&quot;</span>,<span class="literal">false</span>);  </span><br><span class="line">xhr.<span class="title function_">send</span>();  </span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myDiv&quot;</span>).<span class="property">innerHTML</span>=xhr.<span class="property">responseText</span>; <span class="comment">//获取数据直接显示在页面上</span></span><br></pre></td></tr></table></figure>

<h4 id="②异步处理"><a href="#②异步处理" class="headerlink" title="②异步处理"></a>②异步处理</h4><p>相对来说比较复杂，要在请求状态改变事件中处理。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">onreadystatechange</span>=<span class="keyword">function</span>(<span class="params"></span>)  &#123; </span><br><span class="line">	  <span class="keyword">if</span> (xhr.<span class="property">readyState</span>==<span class="number">4</span> &amp;&amp;xhr.<span class="property">status</span>==<span class="number">200</span>)  &#123; </span><br><span class="line">	       <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myDiv&quot;</span>).<span class="property">innerHTML</span>=xhr.<span class="property">responseText</span>;  </span><br><span class="line">	     &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013473001">AJAX跨域完全讲解 - SegmentFault 思否</a></p>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013291898">AJAX面试题都在这里 - SegmentFault 思否</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/08/17/%E5%8A%9B%E9%87%8F%E8%AE%AD%E7%BB%83%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/17/%E5%8A%9B%E9%87%8F%E8%AE%AD%E7%BB%83%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">力量训练基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-16 16:11:37" itemprop="dateCreated datePublished" datetime="2021-08-16T16:11:37Z">2021-08-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">读书笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>深蹲</p>
<p>主要要点：</p>
<ul>
<li>重心：杠铃重心应该始终保持在脚中心的正上方位置</li>
<li>站姿：脚跟距离与肩同宽；脚尖外展约30度</li>
<li>握距：越窄越好，越窄越能将杠铃控制在肌肉上。大拇指应该在杠铃上方以确保握杠时手腕和前臂在一条直线上。</li>
<li>肘向上抬</li>
<li>全程保持头向下看</li>
<li>发力方向：髋部发力应该是往上不是往前，往前的话会导致重心往脚尖压</li>
<li>反弹：反弹必须作为发力过程的启动部分而存在</li>
<li>呼吸：深吸一口气并屏住呼吸</li>
</ul>
<h2 id="5X5训练计划"><a href="#5X5训练计划" class="headerlink" title="5X5训练计划"></a>5X5训练计划</h2><p>一周在非连续的日子里健身3次，并把AB部分轮流使用：</p>
<p>周一：</p>
<p>A：深蹲5X5（起始重量）、推举5X5（起始重量）、硬拉1X5（起始重量）</p>
<p>周三：</p>
<p>B：深蹲5X5（+2.5kg）、卧推5X5（起始重量）、划船5X5（起始重量）</p>
<p>周五：</p>
<p>A：深蹲5X5（+2.5kg）、推举5X5（+2.5kg）、硬拉1X5（+5kg）</p>
<p>周一：</p>
<p>B：深蹲5X5（+2.5kg）、卧推5X5（+2.5kg）、划船5X5（+2.5kg）</p>
<p><strong>热身</strong>：</p>
<p>一般会做三个热身组，先用50%今天要做的重量做一组，65%今天要做的重量做一组，80%今天要做的重量做一组。</p>
<p><strong>注意事项</strong>：</p>
<p>1、如不能完成5组任意一个，争取做完全部5组（能做几个做几个），下次继续，如果三次训练不能做完，减重10%继续5*5，只要你还没达到瓶颈，就加重下去。</p>
<p>2、至于推举和划船的重量，你也应该尝试每次增加5磅重量，但是由于这两个锻炼所要求的肌肉力量会少于深蹲、硬拉、和卧推（推举所用的肩部力量远远少于你大腿的伸膝力量），每次增加5磅重量不一定现实。</p>
<blockquote>
<p>比如：我用160磅卧推5X5时第三组时失败了，只做了4下。那么我第四组时会拿155磅的重量企图完成，如果我还是败了就用150磅完成第五组。<br>如果失败的地方是在第五组，那么不要纠结企图多做一组了。下次再说吧。注意如果你出现失败的情况，那么下次不能增加重量。</p>
</blockquote>
<p>3、如果你加重失败，5组没做完出现完成不了的情况，你可以选择多休息（5+分钟）再挑战这个重量，或者在把重量减少到上次的重量后，再把剩下几组做完。</p>
<p>正常的话，组间休息在90秒左右；训练初期重量较轻，组间休息时间可以适当减少，到后期快到达极限时需要酌情延长。一般休息3分钟可以让ATP恢复到80%左右，5分钟可以恢复到95%。</p>
<p><strong>deload:</strong></p>
<p>全体deload的方法很简单。花一周时间，啥运动都不做，就休息。每健身的第九周，全体deload一周。当然如果你没有健身疲劳也没必要什么运动都不做。你可以照样跟平时一样健身，组数次数啥的都一样，但就把重量减轻40%或更多，然后专门注意纠正改善你的姿势。<br>有的人会问deload完之后怎么办。之后就当啥事没发生，之前该干啥还干啥。该做什么计划就继续做什么计划。</p>
<p>半deload一般只适合在用线性计划、长时间某项锻炼无法提高的朋友。<br>如果你在做5X5，并且已经有两周你的卧推停滞在80KG上涨不了，那么你可以半deload。方法很简单，别的锻炼照样做，卧推重量减少15磅（或者更多），设这个为你的新的RM。然后从这里开始再慢慢把重量加回去。<br>一般来说，在开始一项新的计划之前，你应该把你的所有锻炼都半deload，以较轻的新的RM开始这个计划（像5&#x2F;3&#x2F;1会专门求你设原来的1RM的90%为1RM）。原因很简单：你从来不想让自己用一个新的计划的第一天就拼尽全力。用一个新的计划的前两周你应该处于一种适应的状态，如果你连这个计划的频率、训练量都没适应，就直接push你自己，只会导致自己肌肉恢复跟不上、然后各种失败。</p>
<p><strong>辅助训练（最好不加</strong>）：</p>
<p>引体向上 （最多3组）或 绳索下拉（最多3组）<br>孤立三头锻炼 （最多3组）或 双杠臂屈伸（最多3组）<br>孤立二头肌锻炼（最多3组）<br>后侧肌肉群锻炼 如山羊挺身、罗马尼亚硬拉、直腿硬拉（最多3组）</p>
<h3 id="ICF冰淇淋5X5："><a href="#ICF冰淇淋5X5：" class="headerlink" title="ICF冰淇淋5X5："></a>ICF冰淇淋5X5：</h3><p>A部分<br>深蹲 5X5<br>卧推 5X5<br>划船 5X5<br>杠铃或哑铃耸肩 3X8-12<br>三头肌下压 3X8-12<br>二头肌弯举 3X8-12<br>逆向曲腿3X8-12<br>腹肌锻炼自己加</p>
<p>B部分<br>深蹲5X5<br>推举5X5<br>硬拉1X5<br>划船（用比A部分少10%的重量做） 5X5<br>窄距卧推 或 双杠臂屈伸 3X8-12<br>二头肌弯举 3X8-12<br>腹肌锻炼自己加</p>
<p>这个计划在5X5的基础上添加了很多辅助增肌的锻炼，因此如果你并不是特别对力量有兴趣，更追求增肌的话，这个计划在5X5的计划里算是最适合健美增肌的了（而5X5本身就比99%的其他计划更适合健美增肌。。。）。<br>如果你在减脂，却还想使用这个计划的话，也不是不可以，把所有5组的锻炼做3组，所有3组的锻炼做2组就可以了。你如果减脂期间坚持做完整个计划的话，你会发现你的肌肉恢复会可能跟不上。</p>
<h2 id="拉伸"><a href="#拉伸" class="headerlink" title="拉伸"></a>拉伸</h2><p>每次拉伸至少要拉30秒以上</p>
<p>1、髖屈肌群拉伸</p>
<p>2、</p>
<h2 id="madcow5X5"><a href="#madcow5X5" class="headerlink" title="madcow5X5"></a>madcow5X5</h2><p>当你可以深蹲体重1.5到2倍左右、硬拉体重2到2.5倍左右、卧推体重1.25倍到1.5倍左右的时候</p>
<p>每周第一天<br>深蹲 5X5 (除了最后1组之外，前面4组分别用最后一组的60%，70%，80%，90%完成）<br>卧推 5X5 （除了最后1组之外，前面4组从60%开始增加重量）<br>俯身划船 5X5 （除了最后1组之外，前面4组从60%开始增加重量）<br>可选辅助锻炼： 腹肌锻炼、3组二头肌弯举、三组三头肌下压</p>
<p>第二天 休息</p>
<p>第三天<br>深蹲 4X5 （和第一天一样，只不过你不做最后一组正式组）<br>推举 或 上斜卧推 4X5 （前3组从60%开始增加重量，第四组为正式组）<br>硬拉 4X5 （前3组从60%开始增加重量，第四组为正式组）<br>可选辅助锻炼：3组哑铃飞鸟、2组窄握双杠臂屈伸、3组二头肌弯举、腹肌锻炼</p>
<p>第四天 休息</p>
<p>第五天<br>深蹲 4X5 1X3 1X8 （前4组和第一天第三天一样，第五组1X3用周一的重量提高2.5%完成，第六组1X8用前四组中的第三组完成）<br>卧推 4X5 1X3 1X8（前4组和第一天第三天一样，第五组1X3用周一的重量提高2.5%完成，第六组1X8用前四组中的第三组完成）<br>俯身划船 4X5 1X3 1X8（前4组和第一天第三天一样，第五组1X3用周一的重量提高2.5%完成，第六组1X8用前四组中的第三组完成）<br>可选辅助锻炼：3组窄握双杠臂屈伸、3组脸拉、3组二头肌弯举、腹肌锻炼</p>
<p>第六天第七天休息，然后下周第一天时，正式组都用上一周的1X3来做。<br>也就是说：这周周一我第五组正式组是1X5 200磅卧推，这周周五的我的第五组正式组是1X3 205磅卧推，那么下周周一我的第五组正式组是1X5 205磅卧推。<br>至于第三天的推举和硬拉，你只需要跟着每周正式组增加2.5%的重量走就可以了。</p>
<h3 id="Canditto-LP坎底托直线提高计划介绍"><a href="#Canditto-LP坎底托直线提高计划介绍" class="headerlink" title="Canditto LP坎底托直线提高计划介绍"></a>Canditto LP坎底托直线提高计划介绍</h3><p>本周第一天 上身力量<br>杠铃卧推 3X6<br>背部主要锻炼 3X6<br>肩部主要锻炼 1X6<br>背部次要锻炼 1X6<br>可选上身锻炼1 3X8-15<br>可选上身锻炼2 3X8-15</p>
<p>本周第二天 下身力量<br>后端深蹲（高杠或低杠）3X6<br>硬拉 2X5<br>可选下身锻炼1 3X8-15<br>可选下身锻炼2 3X8-15<br>可选下身锻炼3 3X8-15<br>本周第三天 休息</p>
<p>本周第四天 上身增肌<br>杠铃或哑铃卧推 3X8-12<br>背部主要锻炼 4X8-12<br>肩部主要锻炼 3X8-12<br>背部次要锻炼 4X8-12<br>上斜杠铃或哑铃卧推 3X8-12<br>二头肌弯举 3X8-12<br>可选上身锻炼 3X8-12</p>
<p>本周第五天 下身增肌<br>深蹲（前端或后端） 5X8<br>可选花式硬拉 2X6<br>腘绳肌锻炼 3X8-12<br>小腿提锺 3X8-12<br>可选下身锻炼1 3X8-12<br>可选下身锻炼2 3X8-12</p>
<p>本周第六天 第七天 休息</p>
<p>这个模板可以说是相当地灵活，你可以自己随便加锻炼进去。当然，我个人推荐加如下的锻炼：<br>背部主要锻炼 - 俯身划船 或 负重引体向上 或 背部下拉<br>背部次要锻炼 - 俯身划船 或 负重引体向上 或 背部下拉<br>肩部主要锻炼 - 直立杠铃推举 或 坐姿哑铃推举<br>可选上身锻炼 - 二头肌弯举 三头肌下压 俯身哑铃飞鸟 杠铃或哑铃耸肩<br>可选花式硬拉 - 罗马尼亚硬拉 直腿硬拉<br>可选下身锻炼 - 跳箱 前端深蹲 前屈弓步 （这个选择面比较广）<br>腘绳肌锻炼 - 双腿伸屈（机器）</p>
<p>增重原则<br>所有锻炼，每周尝试增加0-10磅的重量。<br>因为真正的力量日上身下身一周各只有一天，所以增重的尝试只有一次。很多人因此觉得这个计划的增重规律实在太慢，但我个人认为0-10磅的增重设计反而非常不错，因此不会硬逼着你加重，你如何加重完全是看感觉。新手，特别是动作姿势还有问题的新手，被逼着加重时很可能出现姿势不正确、不完全完成动作的行为（比如深蹲时就做个半蹲），因此这种灵活的增重设计我是赞成的。</p>
<h2 id="GZCL训练理念"><a href="#GZCL训练理念" class="headerlink" title="GZCL训练理念"></a>GZCL训练理念</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/25446245">【最良心的干货】手把手教你周期力量计划的设计 - 知乎 (zhihu.com)</a></p>
<p>每次训练你把你的锻炼要分为三个不同的区域之内，分别是：</p>
<p><strong>一级主项，二级副项，三级辅助</strong>。</p>
<p>ZCL理念即是：每天的训练应该安排成一个金字塔。金字塔的厚度为训练量，高为训练强度。最高的位置，训练强度最高、训练量越低，这也是对于你发展力量最重要的训练部分（一级主项）；稍微往下，训练强度、训练量都为中等，这是你<a target="_blank" rel="noopener" href="http://music.163.com/#/program?id=900702866">攻克自己的弱点</a>、直接性辅助你力量提高的训练部分（二级副项）；最下方，训练强度最低，训练量最高，这是你做大量的次数和组数好得到增肌效果、以助于你以后力量的提高（三级辅助）。</p>
<p>一级主项的锻炼安排：一般来说这是你最重要的大三项，深蹲硬拉卧推。根据你目标的不同，也可以包括别的主项锻炼，比如实力推。你每次训练的目的是把最多的精力和力量安排到一级主项上面。一般而言，你每次训练只会安排一个主项，训练强度一般都高于80%1RM。</p>
<p>二级副项的锻炼安排：一般来说这是你的三大项的<strong>专项性辅助。</strong>深蹲的包括：暂停深蹲、其他深蹲方式（主蹲低杠的，可以安排高杠或者前蹲）；硬拉的包括：超程硬拉、架上拉、其他硬拉方式（主拉相扑拉的，可以安排传统拉）；卧推的包括：暂停卧推、窄距卧推。这都只是一些例子。要注意的是你也可以把主项放入副项里练。副项的目标，除了攻克弱点、直接性辅助你的主项之外，也可以发展其他的主项；但是重要性会低于当天的一级主项。具体这是什么意思，我会在底下说明白。一般而言，你每次训练只会安排一个或者两个副项，训练强度一般在65%-85%1RM之间。</p>
<p>三级辅助的锻炼安排：一般来说这是任何其它的辅助锻炼，包括（不限制于）：背部锻炼（划船、引体向上）、哑铃锻炼（哑铃卧推）、增肌性质的三大项辅助（硬拉：罗马尼亚硬拉、直腿硬拉；卧推：哑铃卧推、俯卧撑、甚至胸推机器；深蹲：哑铃弓箭步、箱跳、腿弯举）、肩部锻炼（推举这边也可以练）。你要通过三级辅助，把一级和二级锻炼里还没有压榨完的精力给全部花出去。一般而言，每次训练会安排两个以上的三级辅助，每个的组数锻炼至少3组以上、每组10-20次（Cody喜欢做每组20下的三级辅助，走他的黑又壮计划的朋友们应该都明白，哭死人）。三级辅助的目标是：提高训练容量（高组数高次数）、达到增肌效果、提高综合耐力。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/08/13/oracle%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/13/oracle%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-title-link" itemprop="url">oracle数据库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-13 10:45:54" itemprop="dateCreated datePublished" datetime="2021-08-13T10:45:54Z">2021-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/oracle%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">oracle数据库</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装教程"><a href="#安装教程" class="headerlink" title="安装教程"></a>安装教程</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013537329">参考文章</a></p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013540871">参考文章</a></p>
<h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p>Oracle数据库服务器由两部分组成：</p>
<ul>
<li><strong>实例：理解为对象,看不见的</strong></li>
<li><strong>数据库：理解为类，看得见的</strong></li>
</ul>
<p>Oracle数据库把表、视图等都看成是对象。</p>
<h2 id="null值"><a href="#null值" class="headerlink" title="null值"></a>null值</h2><p>Oracle中如果存在字段是null值的话，那么在sqlplus中它是不会显示出来的….<strong>如果我们使用null值的数据与其他数据进行运算…那么最终得出的结果都是null值</strong></p>
<p>因此，Oracle提供了NVL(表达式1，表达式2)函数供我们使用，如果表达式1的值为null值，那么就取表达式2的值…当然了，如果表达式1不是null，取的就是表达式1的值</p>
<p>还有值得注意的是：<strong>null值不能参数&#x3D;号运算，null能参数number&#x2F;date&#x2F;varchar2类型运算</strong></p>
<p><strong>Oracle提供了 is null关键字来代替&#x3D;号运算的问题</strong></p>
<h2 id="别名"><a href="#别名" class="headerlink" title="别名"></a>别名</h2><p>Mysql中如果要用别名的话，需要使用as关键字 ，后面跟着别名就行了….Oracle可以省略as关键字…</p>
<p>并且，一般地，我们使用别名都是用双引号””把别名括起来，Oracle也支持我们直接写别名，但是呢<strong>，如果我们不写双引号，那么我们的别名是不能有空格的</strong></p>
<p>还有一点的是：<strong>Oracle的别名是不能使用单引号来括起来的，Oracle默认认为单引号是字符串类型和日期类型的。</strong></p>
<h2 id="操作表细节"><a href="#操作表细节" class="headerlink" title="操作表细节"></a>操作表细节</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">进入回收站</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> users;</span><br><span class="line"></span><br><span class="line">查询回收站中的对象</span><br><span class="line"><span class="keyword">show</span> recyclebin;</span><br><span class="line"></span><br><span class="line">闪回，即将回收站还原</span><br><span class="line">flashback <span class="keyword">table</span> 表名 <span class="keyword">to</span> before <span class="keyword">drop</span>;</span><br><span class="line">flashback <span class="keyword">table</span> 表名 <span class="keyword">to</span> before <span class="keyword">drop</span> rename <span class="keyword">to</span>  新表名;</span><br><span class="line"></span><br><span class="line">彻底删除users表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> users purge;</span><br><span class="line"></span><br><span class="line">清空回收站</span><br><span class="line">purge recyclebin;</span><br><span class="line"></span><br><span class="line">为emp表增加image列，<span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 列名 类型(宽度) </span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp</span><br><span class="line"><span class="keyword">add</span> image <span class="type">blob</span>;</span><br><span class="line"></span><br><span class="line">修改ename列的长度为<span class="number">20</span>个字节，<span class="keyword">alter</span> <span class="keyword">table</span> 表名 modify 列名 类型(宽度) </span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp</span><br><span class="line">modify ename varchar2(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">删除image列，<span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> <span class="keyword">column</span> 列名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">column</span> image;</span><br><span class="line"></span><br><span class="line">重名列名ename为username，<span class="keyword">alter</span> <span class="keyword">table</span> 表名 rename <span class="keyword">column</span> 原列名 <span class="keyword">to</span> 新列名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp</span><br><span class="line">rename <span class="keyword">column</span> ename <span class="keyword">to</span> username;</span><br><span class="line"></span><br><span class="line">将emp表重命名emps，rename 原表名 <span class="keyword">to</span> 新表名</span><br><span class="line">rename emp <span class="keyword">to</span> emps;</span><br></pre></td></tr></table></figure>

<p>值得注意的是：<strong>修改表的时候，是不能回滚的！</strong></p>
<p>Oracle中的级联操作：</p>
<ul>
<li><strong>【on delete cascade】级联删除</strong></li>
<li><strong>【on delete set null】将外键一方设置为null</strong></li>
</ul>
<h1 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h1><p>Oracle中的分页是依靠着rownum这个伪列来实现的，由于rownum只能使用的是&lt;&#x3D;或者&lt;来获取数据。。。因为rownum的值可能会经常变【加入一条数据，那么rownum就+1，讲道理rownum可以是无穷大的，因此不能使用&gt;来进行操作】….</p>
<p>那么Oracle分页的思路是这样子的：</p>
<ul>
<li>先在子查询中获取前n条记录</li>
<li><strong>由于返回的是多行多列，因此我们可以看做成一张表</strong></li>
<li>那么将查询出来的数据放在from字句的后边</li>
<li>外套的查询可以<strong>通过where字句来对子查询出来的数据进行过滤</strong></li>
<li>那么我们就可以查询出想要的数据了…</li>
</ul>
<p>公式：</p>
<ul>
<li><strong>Mysql从(currentPage-1)*lineSize开始取数据，取lineSize条数据</strong></li>
<li><strong>Oracle先获取currentPage*lineSize条数据，从(currentPage-1)*lineSize开始取数据</strong></li>
</ul>
<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><h2 id="批量操作"><a href="#批量操作" class="headerlink" title="批量操作"></a>批量操作</h2><p><strong>我们查询出来的数据可看成是一张表，那么我们在插入数据的时候，可以根据查询出来的数据进行插入</strong>…这就可以看成是批量操作…</p>
<p>值得注意的是，<strong>如果没有指定插入哪些字段的话，那么查询出来的全部字段均会插入表中</strong>..</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">将xxx_emp表中所有<span class="number">20</span>号部门的员工，复制到emp表中，批量插入，<span class="keyword">insert</span> <span class="keyword">into</span> 表名 <span class="keyword">select</span> ...语法</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> xxx_emp</span><br><span class="line"><span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<h3 id="删除操作对比"><a href="#删除操作对比" class="headerlink" title="删除操作对比"></a>删除操作对比</h3><p>我们的删除语法有三种：</p>
<ul>
<li><strong>delete from</strong></li>
<li><strong>truncate from</strong></li>
<li><strong>drop from</strong></li>
</ul>
<p>我们来对比一下他们的区别：</p>
<p>drop table</p>
<ul>
<li>1)属于DDL</li>
<li>2)不可回滚</li>
<li>3)不可带where</li>
<li>4)表内容和结构删除</li>
<li>5)删除速度快</li>
</ul>
<p>truncate table</p>
<ul>
<li>1)属于DDL</li>
<li>2)不可回滚</li>
<li>3)不可带where</li>
<li>4)表内容删除</li>
<li>5)删除速度快</li>
</ul>
<p>delete from</p>
<ul>
<li>1)属于DML</li>
<li>2)可回滚</li>
<li>3)可带where</li>
<li>4)表结构在，表内容要看where执行的情况</li>
<li>5)删除速度慢,需要逐行删除</li>
</ul>
<h2 id="访问其他用户的对象"><a href="#访问其他用户的对象" class="headerlink" title="访问其他用户的对象"></a>访问其他用户的对象</h2><p><strong>我们只要在访问表的时候，指定具体的用户.数据库表就行了，但是呢，还要看看该用户有没有权限查询别的用户的数据表，于是就需要赋予权限了</strong>…</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">声明：scott或hr叫用户名<span class="operator">/</span>方案名<span class="operator">/</span>空间名</span><br><span class="line">      scott<span class="comment">--tiger</span></span><br><span class="line">      hr<span class="comment">-----lion</span></span><br><span class="line">      </span><br><span class="line">查询当前用户是谁</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line">查询scott自己表空间下的所有对象时，可加，或不加用户名<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> scott.emp;</span><br><span class="line"></span><br><span class="line">以sysdba身份解锁hr普通帐户</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> hr account unlock;</span><br><span class="line"></span><br><span class="line">以sysdba身份设置hr普通帐户的密码</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> hr identified <span class="keyword">by</span> lion;</span><br><span class="line"></span><br><span class="line">当scott查询hr表空间下的所有表时，必须得加用户名</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> hr.jobs;</span><br><span class="line"></span><br><span class="line">在默认情况下，每个用户只能查询自已空间下的对象的权限，不能查询其它用户空间下的对象</span><br><span class="line"></span><br><span class="line">以sysdba身份角色，授予scott用户查询所有用户空间下的对象权限</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">to</span> scott;</span><br><span class="line"></span><br><span class="line">以sysdba身份，撤销scott用户查询所有用户空间下的对象权限</span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">select</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">from</span> scott;</span><br><span class="line"></span><br><span class="line">scott自已查看自己所拥有的权限</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user_sys_privs;</span><br><span class="line"></span><br><span class="line">从scott用户空间导航到sysdba用户空间</span><br><span class="line">conn <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line"></span><br><span class="line">从sysdba用户空间导航到scott用户空间</span><br><span class="line">conn scott<span class="operator">/</span>tiger;</span><br><span class="line"></span><br><span class="line">从scott用户空间导航到hr用户空间</span><br><span class="line">conn hr<span class="operator">/</span>lion;</span><br><span class="line"></span><br><span class="line">查询hr用户空间中的所有对象</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tab;</span><br><span class="line"></span><br><span class="line">从hr用户空间导航到scott用户空间</span><br><span class="line">conn scott<span class="operator">/</span>tiger;</span><br><span class="line"></span><br><span class="line">在scott用户空间下，查询hr用户空间下的jobs表，必须加上hr用户空间名</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> hr.jobs;</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">基于emp表所有列，创建视图emp_view_1，<span class="keyword">create</span> <span class="keyword">view</span> 视图名 <span class="keyword">as</span> <span class="keyword">select</span>对一张或多张基表的查询</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view_1</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">默认情况下，普通用户无权创建视图，得让sysdba为你分配creare <span class="keyword">view</span>的权限 </span><br><span class="line"></span><br><span class="line">以sysdba身份，授权scott用户<span class="keyword">create</span> <span class="keyword">view</span>权限</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">view</span> <span class="keyword">to</span> scott;</span><br><span class="line"></span><br><span class="line">以sysdba身份，撤销scott用户<span class="keyword">create</span> <span class="keyword">view</span>权限</span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">create</span> <span class="keyword">view</span> <span class="keyword">from</span> scott;</span><br><span class="line"></span><br><span class="line">基于emp表指定列，创建视图emp_view_2，该视图包含编号<span class="operator">/</span>姓名<span class="operator">/</span>工资<span class="operator">/</span>年薪<span class="operator">/</span>年收入（查询中使用列别名）</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view_2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> empno &quot;编号&quot;,ename &quot;姓名&quot;,sal &quot;工资&quot;,sal<span class="operator">*</span><span class="number">12</span> &quot;年薪&quot;,sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>NVL(comm,<span class="number">0</span>) &quot;年收入&quot;</span><br><span class="line"><span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">基于emp表指定列，创建视图emp_view_3(a,b,c,d,e)，包含编号<span class="operator">/</span>姓名<span class="operator">/</span>工资<span class="operator">/</span>年薪<span class="operator">/</span>年收入（视图中使用列名）</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view_3(a,b,c,d,e)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> empno &quot;编号&quot;,ename &quot;姓名&quot;,sal &quot;工资&quot;,sal<span class="operator">*</span><span class="number">12</span> &quot;年薪&quot;,sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>NVL(comm,<span class="number">0</span>) &quot;年收入&quot;</span><br><span class="line"><span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">查询emp_view_3创建视图的结构</span><br><span class="line"><span class="keyword">desc</span> emp_view_3;</span><br><span class="line"></span><br><span class="line">修改emp_view_3(id,name,salary,annual,income)视图，<span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> 视图名 <span class="keyword">as</span> 子查询</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> emp_view_3(id,name,salary,annual,income)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> empno &quot;编号&quot;,ename &quot;姓名&quot;,sal &quot;工资&quot;,sal<span class="operator">*</span><span class="number">12</span> &quot;年薪&quot;,sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>NVL(comm,<span class="number">0</span>) &quot;年收入&quot;</span><br><span class="line"><span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">查询emp表，求出各部门的最低工资，最高工资，平均工资</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(sal),<span class="built_in">max</span>(sal),round(<span class="built_in">avg</span>(sal),<span class="number">0</span>),deptno</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"></span><br><span class="line">创建视图emp_view_4，视图中包含各部门的最低工资，最高工资，平均工资</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> emp_view_4</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> deptno &quot;部门号&quot;,<span class="built_in">min</span>(sal) &quot;最低工资&quot;,<span class="built_in">max</span>(sal) &quot;最高工资&quot;,round(<span class="built_in">avg</span>(sal),<span class="number">0</span>) &quot;平均工资&quot;</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"></span><br><span class="line">创建视图emp_view_5，视图中包含员工编号，姓名，工资，部门名，工资等级</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> emp_view_5</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> e.empno &quot;编号&quot;,e.ename &quot;姓名&quot;,e.sal &quot;工资&quot;,d.dname &quot;部门名&quot;,s.grade &quot;工资等级&quot;</span><br><span class="line"><span class="keyword">from</span> emp e,dept d,salgrade s</span><br><span class="line"><span class="keyword">where</span> (e.deptno<span class="operator">=</span>d.deptno) <span class="keyword">and</span> (e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal);</span><br><span class="line"></span><br><span class="line">删除视图emp_view_1中的<span class="number">7788</span>号员工的记录，使用<span class="keyword">delete</span>操作，会影响基表吗</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp_view_1 <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7788</span>;写法正确，会影响基表</span><br><span class="line"></span><br><span class="line">修改emp_view_1为只读视图【<span class="keyword">with</span> read <span class="keyword">only</span>】，再执行上述<span class="keyword">delete</span>操作，还行吗？</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> emp_view_1</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">with</span> read <span class="keyword">only</span>;</span><br><span class="line">不能进行<span class="keyword">delete</span>操作了</span><br><span class="line"></span><br><span class="line">删除视图中的【某条】记录会影响基表吗？</span><br><span class="line">会影响基表</span><br><span class="line"></span><br><span class="line">将【整个】视图删除，会影响表吗？</span><br><span class="line">不会影响基表</span><br><span class="line"></span><br><span class="line">删除视图，会进入回收站吗？</span><br><span class="line">不会进入回收站</span><br><span class="line"></span><br><span class="line">删除基表会影响视图吗？</span><br><span class="line">会影响视图</span><br><span class="line"></span><br><span class="line">闪回基表后,视图有影响吗？</span><br><span class="line">视图又可以正常工作了</span><br></pre></td></tr></table></figure>

<h2 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">为emp表的empno字段，创建序列emp_empno_seq，<span class="keyword">create</span> sequence 序列名</span><br><span class="line"><span class="keyword">create</span> sequence emp_empno_seq;</span><br><span class="line"></span><br><span class="line">删除序列emp_empno_seq，<span class="keyword">drop</span> sequence 序列名</span><br><span class="line"><span class="keyword">drop</span> sequence emp_empno_seq;</span><br><span class="line"></span><br><span class="line">查询emp_empno_seq序列的当前值currval和下一个值nextval，第一次使用序列时，必须选用：序列名.nextval</span><br><span class="line"><span class="keyword">select</span> emp_empno_seq.nextval <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> emp_empno_seq.currval <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">使用序列，向emp表插入记录，empno字段使用序列值</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno) <span class="keyword">values</span>(emp_empno_seq.nextval);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno) <span class="keyword">values</span>(emp_empno_seq.nextval);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno) <span class="keyword">values</span>(emp_empno_seq.nextval);</span><br><span class="line"></span><br><span class="line">修改emp_empno_seq序列的increment <span class="keyword">by</span>属性为<span class="number">20</span>，默认<span class="keyword">start</span> <span class="keyword">with</span>是<span class="number">1</span>，<span class="keyword">alter</span> sequence 序列名</span><br><span class="line"><span class="keyword">alter</span> sequence emp_empno_seq</span><br><span class="line">increment <span class="keyword">by</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">修改修改emp_empno_seq序列的的increment <span class="keyword">by</span>属性为<span class="number">5</span></span><br><span class="line"><span class="keyword">alter</span> sequence emp_empno_seq</span><br><span class="line">increment <span class="keyword">by</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">修改emp_empno_seq序列的<span class="keyword">start</span> <span class="keyword">with</span>属性，行吗</span><br><span class="line"><span class="keyword">alter</span> sequence emp_empno_seq</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">有了序列后，还能为主健手工设置值吗？</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno) <span class="keyword">values</span>(<span class="number">9999</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno) <span class="keyword">values</span>(<span class="number">7900</span>);</span><br><span class="line"></span><br><span class="line">删除表，会影响序列吗？</span><br><span class="line">你无法做<span class="keyword">insert</span>操作,表真正亡，序列亡</span><br><span class="line"></span><br><span class="line">删除序列，会影响表吗？</span><br><span class="line"></span><br><span class="line">不会</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在hibernate中，如果是访问oracle数据库服务器，那么User.hbm.xml映射文件中关于<span class="operator">&lt;</span>id<span class="operator">&gt;</span>标签如何配置呢？</span><br><span class="line"><span class="operator">&lt;</span>id name<span class="operator">=</span>&quot;id&quot; <span class="keyword">column</span><span class="operator">=</span>&quot;id&quot;<span class="operator">&gt;</span></span><br><span class="line">   <span class="operator">&lt;</span>generator class<span class="operator">=</span>&quot;increment/identity/uuid/【sequence】/【native】&quot;<span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span>id<span class="operator">&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>（1）是一种<strong>快速查询表中内容的机制</strong>，类似于新华字典的目录<br>（2）运用在表中某个&#x2F;些字段上，但<strong>存储时，独立于表之外</strong></p>
<p>为什么要用索引</p>
<ul>
<li>（1）<strong>通过指针加速Oracle服务器的查询速度</strong></li>
<li>（2）<strong>通过rowid快速定位数据的方法，减少磁盘I&#x2F;O</strong><ul>
<li>rowid是oracle中唯一确定每张表不同记录的唯一身份证</li>
</ul>
</li>
</ul>
<h3 id="rowid特点"><a href="#rowid特点" class="headerlink" title="rowid特点"></a>rowid特点</h3><ol>
<li>位于每个表中，但表面上看不见，例如：desc emp是看不见的</li>
<li>只有在select中，显示写出rowid，方可看见</li>
<li>它与每个表绑定在一起，表亡，该表的rowid亡，二张表rownum可以相同，但rowid必须是唯一的</li>
<li>rowid是18位大小写加数字混杂体，唯一表代该条记录在DBF文件中的位置</li>
<li>rowid可以参与&#x3D;&#x2F;like比较时，用’’单引号将rowid的值包起来，且区分大小写</li>
<li>rowid是联系表与DBF文件的桥梁</li>
</ol>
<h3 id="索引特点"><a href="#索引特点" class="headerlink" title="索引特点"></a>索引特点</h3><ol>
<li>索引一旦建立, <strong>Oracle管理系统会对其进行自动维护</strong>, 而且由Oracle管理系统决定何时使用索引</li>
<li>用户不用在查询语句中指定使用哪个索引</li>
<li><strong>在定义primary key或unique约束后系统自动在相应的列上创建索引</strong></li>
<li>用户也能按自己的需求，对指定单个字段或多个字段，添加索引</li>
</ol>
<p>需要注意的是：<strong>Oracle是自动帮我们管理索引的，并且如果我们指定了primary key或者unique约束，系统会自动在对应的列上创建索引</strong>..</p>
<p>什么时候【要】创建索引</p>
<p>（1）表经常进行 SELECT 操作</p>
<p>（2）表很大(记录超多)，记录内容分布范围很广</p>
<p>（3）列名经常在 WHERE 子句或连接条件中出现</p>
<p>什么时候【不要】创建索引</p>
<p>（1）表经常进行 INSERT&#x2F;UPDATE&#x2F;DELETE 操作</p>
<p>（2）表很小(记录超少)</p>
<p>（3）列名不经常作为连接条件或出现在 WHERE 子句中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">为emp表的empno单个字段，创建索引emp_empno_idx，叫单列索引，<span class="keyword">create</span> index 索引名 <span class="keyword">on</span> 表名(字段,...)</span><br><span class="line"><span class="keyword">create</span> index emp_empno_idx</span><br><span class="line"><span class="keyword">on</span> emp(empno);</span><br><span class="line"></span><br><span class="line">为emp表的ename,job多个字段，创建索引emp_ename_job_idx，多列索引<span class="operator">/</span>联合索引</span><br><span class="line"><span class="keyword">create</span> index emp_ename_job_idx </span><br><span class="line"><span class="keyword">on</span> emp(ename,job);</span><br><span class="line">如果在<span class="keyword">where</span>中只出现job不使用索引</span><br><span class="line">如果在<span class="keyword">where</span>中只出现ename使用索引</span><br><span class="line">我们提倡同时出现ename和job</span><br><span class="line"></span><br><span class="line">注意：索引创建后，只有查询表有关，和其它（<span class="keyword">insert</span><span class="operator">/</span><span class="keyword">update</span><span class="operator">/</span><span class="keyword">delete</span>）无关,解决速度问题</span><br><span class="line"></span><br><span class="line">删除emp_empno_idx和emp_ename_job_idx索引，<span class="keyword">drop</span> index 索引名</span><br><span class="line"><span class="keyword">drop</span> index emp_empno_idx;</span><br><span class="line"><span class="keyword">drop</span> index emp_ename_job_idx;</span><br></pre></td></tr></table></figure>

<h1 id="权限和用户"><a href="#权限和用户" class="headerlink" title="权限和用户"></a>权限和用户</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">一）用户</span><br><span class="line">Oracle中的用户分为二大类</span><br><span class="line"><span class="number">1</span>）Oracle数据库服务器创建时，由系统自动创建的用户，叫系统用户，如sys。</span><br><span class="line"><span class="number">2</span>）利用系统用户创建的用户，叫普通用户，如scott,hr，c##tiger,zhaojun,...</span><br><span class="line"></span><br><span class="line">》用sys登录，查询当前Oracle数据库服务器中已有用户的名字和状态</span><br><span class="line">  username表示登录名</span><br><span class="line">  expired<span class="operator">&amp;</span>locked表示帐号过期和锁定</span><br><span class="line">  <span class="keyword">open</span>表示帐号现在可用</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  col username <span class="keyword">for</span> a30;</span><br><span class="line">  col account_status <span class="keyword">for</span> a30;</span><br><span class="line">  <span class="keyword">set</span> pagesize <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">select</span> username,account_status <span class="keyword">from</span> dba_users;</span><br><span class="line">  </span><br><span class="line">  查询Oracle中有哪些用户</span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> all_users;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二）创建与删除普通用户</span><br><span class="line">可以在Oracle中创建新的普通用户，创建普通用户命令是：<span class="keyword">create</span> <span class="keyword">user</span>，在创建普通用户的同时，应该为其分配一个具体的表空间，通常叫users。</span><br><span class="line"></span><br><span class="line">》用sys登录，查询Oracle中有哪些可用存储空间，所有普通用户默认为users存储空间</span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$tablespace;</span><br><span class="line"></span><br><span class="line">》用sys登录，创建普通用户c##tiger，密码为abc，默认使用users存储空间，即对应硬盘上的一个DBF二进制文件</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">create</span> <span class="keyword">user</span> c##tiger identified <span class="keyword">by</span> abc <span class="keyword">default</span> tablespace users;</span><br><span class="line"></span><br><span class="line">》用sys登录，为c##tiger分配users空间无限制使用，即数据库中DBF文件可以无限增加，一个DBF文件不够，会创建第二个DBF文件</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">alter</span> <span class="keyword">user</span> c##tiger quota unlimited <span class="keyword">on</span> users;</span><br><span class="line"></span><br><span class="line">》用c##tiger登录，能进orcl数据库吗？</span><br><span class="line">  sqlplus c##tiger<span class="operator">/</span>abc</span><br><span class="line">  进不去orcl数据库</span><br><span class="line"></span><br><span class="line">》用sys登录，删除普通用户c##tiger</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">drop</span> <span class="keyword">user</span> c##tiger cascade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">三）了解系统用户</span><br><span class="line">sys是Oracle中一个重要的系统用户，sys是Oracle中最高权限用户，其角色为SYSDBA（系统管理员）</span><br><span class="line">sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">四）权限</span><br><span class="line">权限的最终作用于用户。即所有用户在数据库内的操作对象和可执行的动作都是受到限制的。</span><br><span class="line">Oracle中权限分为二大类：</span><br><span class="line"><span class="number">1</span>）系统权限</span><br><span class="line"><span class="number">2</span>）对象权限</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">五）系统权限</span><br><span class="line">针对数据库中特定操作的许可，例如：让c##tiger能登录到orcl数据库，能在orcl数据库中创建表</span><br><span class="line"></span><br><span class="line">》用sys登录，获取系统权限的相关信息，例如：<span class="keyword">select</span> <span class="keyword">any</span> <span class="keyword">table</span>表示针对所有表的<span class="keyword">select</span>权限</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">distinct</span> privilege <span class="keyword">from</span> dba_sys_privs;</span><br><span class="line"></span><br><span class="line">》用sys登录，为c##tiger分配<span class="keyword">create</span> session与数据库建立会话的权限，即允许该用户登录</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">grant</span> <span class="keyword">create</span> session <span class="keyword">to</span> c##tiger;</span><br><span class="line"></span><br><span class="line">》用c##tiger登录，能进orcl数据库吗？</span><br><span class="line">  sqlplus c##tiger<span class="operator">/</span>abc</span><br><span class="line">  能进去orcl数据库</span><br><span class="line"></span><br><span class="line">》用c##tiger登录，创建一张tiger的表，能创建吗？</span><br><span class="line">  sqlplus c##tiger<span class="operator">/</span>abc</span><br><span class="line">  <span class="keyword">create</span> <span class="keyword">table</span> tiger(</span><br><span class="line">    name varchar2(<span class="number">20</span>)</span><br><span class="line">  );</span><br><span class="line">  这时c##tiger没有权限创建表</span><br><span class="line"></span><br><span class="line">》用sys登录，为c##tiger分配<span class="keyword">create</span> <span class="keyword">table</span>权限，即允许创建表</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">to</span> c##tiger;</span><br><span class="line"></span><br><span class="line">》用c##tiger登录，创建一张tiger的表，能创建吗？</span><br><span class="line">  sqlplus c##tiger<span class="operator">/</span>abc</span><br><span class="line">  <span class="keyword">create</span> <span class="keyword">table</span> tiger(</span><br><span class="line">    name varchar2(<span class="number">20</span>)</span><br><span class="line">  );</span><br><span class="line">  可以创建c##tiger表</span><br><span class="line"></span><br><span class="line">》用sys登录，查询c##tiger所拥有的系统权限</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">select</span> grantee,privilege <span class="keyword">from</span> dba_sys_privs <span class="keyword">where</span> <span class="built_in">lower</span>(grantee) <span class="operator">=</span> <span class="string">&#x27;c##tiger&#x27;</span>;</span><br><span class="line">  grantee表示普通用户名</span><br><span class="line">  privilege权限名  </span><br><span class="line"></span><br><span class="line">》用sys登录，撤销c##tiger的<span class="keyword">create</span> <span class="keyword">table</span>权限</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">revoke</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">from</span> c##tiger;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">六）对象权限</span><br><span class="line">用户对已有对象的操作权限，包括：</span><br><span class="line"><span class="number">1</span>）<span class="keyword">select</span>可用于表，视图和序列</span><br><span class="line"><span class="number">2</span>）<span class="keyword">insert</span>向表或视图中插入新的记录</span><br><span class="line"><span class="number">3</span>）<span class="keyword">update</span>更新表中数据</span><br><span class="line"><span class="number">4</span>）<span class="keyword">delete</span>删除表中数据</span><br><span class="line"><span class="number">5</span>）<span class="keyword">execute</span>函数，过程的执行</span><br><span class="line"><span class="number">6</span>）index为表创建索引</span><br><span class="line"><span class="number">7</span>）<span class="keyword">references</span>为表创建外健</span><br><span class="line"><span class="number">8</span>）<span class="keyword">alter</span>修改表或者序列的属性</span><br><span class="line"></span><br><span class="line">》用sys登录，查询c##tiger所拥有的对象权限</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  col grantee <span class="keyword">for</span> a10;</span><br><span class="line">  col table_name <span class="keyword">for</span> a10;</span><br><span class="line">  col privilege <span class="keyword">for</span> a20;</span><br><span class="line">  <span class="keyword">select</span> grantee,table_name,privilege <span class="keyword">from</span> dba_tab_privs <span class="keyword">where</span> <span class="built_in">lower</span>(grantee) <span class="operator">=</span> <span class="string">&#x27;c##tiger&#x27;</span>;</span><br><span class="line"></span><br><span class="line">》用sys登录，为c##tiger分配对tiger表的所有权限，即增删改查操作</span><br><span class="line">  sqlplus <span class="operator">/</span> <span class="keyword">as</span> sysdba;</span><br><span class="line">  <span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> c##tiger.tiger <span class="keyword">to</span> c##tiger;</span><br><span class="line">  注意：c##tiger表示空间名</span><br><span class="line">        tiger表示该空间下的表名</span><br><span class="line">  C##TIGER   TIGER      FLASHBACK</span><br><span class="line">  C##TIGER   TIGER      DEBUG</span><br><span class="line">  C##TIGER   TIGER      QUERY REWRITE</span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">ON</span> <span class="keyword">COMMIT</span> REFRESH</span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">REFERENCES</span></span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">UPDATE</span></span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">SELECT</span></span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">INSERT</span></span><br><span class="line">  C##TIGER   TIGER      INDEX</span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">DELETE</span></span><br><span class="line">  C##TIGER   TIGER      <span class="keyword">ALTER</span></span><br><span class="line"></span><br><span class="line">》用c##tiger登录，对tiger表进行增删改查操作</span><br><span class="line">  sqlplus c##tiger<span class="operator">/</span>abc;</span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> tiger(name) <span class="keyword">values</span>(<span class="string">&#x27;AA&#x27;</span>);</span><br><span class="line">  <span class="keyword">update</span> tiger <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;BB&#x27;</span>;</span><br><span class="line">  <span class="keyword">delete</span> <span class="keyword">from</span> tiger <span class="keyword">where</span> rownum <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tiger;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="PLSQL学习"><a href="#PLSQL学习" class="headerlink" title="PLSQL学习"></a>PLSQL学习</h1><p><strong>PLSQL是Oracle对SQL99的一种扩展</strong></p>
<ul>
<li>是专用于Oracle服务器，在SQL基础之上，<strong>添加了一些过程化控制语句，叫PLSQL</strong></li>
<li>过程化包括有：类型定义，判断，循环，游标，异常或例外处理。。。</li>
<li><strong>PLSQL强调过程</strong></li>
</ul>
<p>为什么要用PLSQL</p>
<ul>
<li>因为SQL是第四代命令式语言，<strong>无法显示处理过程化的业务，所以得用一个过程化程序设计语言来弥补SQL的不足之处</strong>，</li>
<li>SQL和PLSQL不是替代关系，是弥补关系</li>
</ul>
<h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013560860">参考文章</a></p>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013517914">参考文章</a></p>
<h1 id="有关mysql命令"><a href="#有关mysql命令" class="headerlink" title="有关mysql命令"></a>有关mysql命令</h1><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017278335">面试前必须知道的MySQL命令【explain】 - SegmentFault 思否</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rshawshank.github.io/2021/08/12/%E9%BB%91%E4%B9%A6%E7%B3%BB%E5%88%97-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rhb">
      <meta itemprop="description" content="纵浪大化中，不喜亦不惧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rhb_blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/12/%E9%BB%91%E4%B9%A6%E7%B3%BB%E5%88%97-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/" class="post-title-link" itemprop="url">黑书系列-深入理解计算机系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-12 09:32:19" itemprop="dateCreated datePublished" datetime="2021-08-12T09:32:19Z">2021-08-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-13 09:13:26" itemprop="dateModified" datetime="2022-11-13T09:13:26Z">2022-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E9%BB%91%E4%B9%A6/" itemprop="url" rel="index"><span itemprop="name">黑书</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1、文件是对I&#x2F;O设备的抽象表示；虚拟内存是对主存和磁盘I&#x2F;O的抽象表示；进程是对处理器、主存和I&#x2F;O设备的抽象表示。</p>
<p>2、shell进程：shell做为一种和Linux系统的特殊交互式工具，为用户提供了启动程序、管理文件系统中的文件及运行在Linux上的进程的途径。shell通过解析输入的文本命令，在内核中执行来达到与系统交互的功能。shell包含了一组内部命令，通过这些命令可以进行文件管理、程序管理及运行等操作。</p>
<blockquote>
<p>【什么是shell】</p>
<p>简单点理解，就是系统跟<a target="_blank" rel="noopener" href="https://m.baidu.com/s?word=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6&from=1011904q&sa=gh_pl_wisezm">计算机硬件</a>交互时使用的中间介质，它只是系统的一个工具。实际上，在shell和<a target="_blank" rel="noopener" href="https://m.baidu.com/s?word=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6&from=1011904q&sa=gh_pl_wisezm">计算机硬件</a>之间还有一层东西那就是系统内核了。打个比方，如果把<a target="_blank" rel="noopener" href="https://m.baidu.com/s?word=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6&from=1011904q&sa=gh_pl_wisezm">计算机硬件</a>比作一个人的躯体，而系统内核则是人的大脑，至于shell，把它比作人的五官似乎更加贴切些。回到计算机上来，用户直接面对的不是<a target="_blank" rel="noopener" href="https://m.baidu.com/s?word=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6&from=1011904q&sa=gh_pl_wisezm">计算机硬件</a>而是shell，用户把指令告诉shell，然后shell再传输给系统内核，接着内核再去支配计算机硬件去执行各种操作。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rhb</p>
  <div class="site-description" itemprop="description">纵浪大化中，不喜亦不惧</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">155</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">63</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/RShawshank" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;RShawshank" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rhb</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://lib.baomitu.com/canvas-nest.js/1.0.1/canvas-nest.js"></script>


        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
